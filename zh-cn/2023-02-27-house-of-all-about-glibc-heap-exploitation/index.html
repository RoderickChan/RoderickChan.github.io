<!DOCTYPE html>
<html itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">
  <head>
    
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
    <meta name="robots" content="noodp" />
    <title>Glibcå †åˆ©ç”¨ä¹‹house Ofç³»åˆ—æ€»ç»“ | roderick - record and learn!</title><meta name="author" content="roderick">
<meta name="description" content="å°½å¯èƒ½åœ°æ€»ç»“ç›®å‰çš„house ofåˆ©ç”¨æ‰‹æ®µ"><meta name="keywords" content='glibc, heap exploitation, house of'>
  <meta itemprop="name" content="Glibcå †åˆ©ç”¨ä¹‹house ofç³»åˆ—æ€»ç»“">
  <meta itemprop="description" content="å°½å¯èƒ½åœ°æ€»ç»“ç›®å‰çš„house ofåˆ©ç”¨æ‰‹æ®µ">
  <meta itemprop="datePublished" content="2023-02-27T15:10:08+08:00">
  <meta itemprop="dateModified" content="2025-06-08T22:47:19+08:00">
  <meta itemprop="wordCount" content="18865">
  <meta itemprop="image" content="https://roderickchan.github.io/">
  <meta itemprop="keywords" content="glibc,heap exploitation,house of"><meta property="og:url" content="https://roderickchan.github.io/zh-cn/2023-02-27-house-of-all-about-glibc-heap-exploitation/">
  <meta property="og:site_name" content="roderick - record and learn!">
  <meta property="og:title" content="Glibcå †åˆ©ç”¨ä¹‹house ofç³»åˆ—æ€»ç»“">
  <meta property="og:description" content="å°½å¯èƒ½åœ°æ€»ç»“ç›®å‰çš„house ofåˆ©ç”¨æ‰‹æ®µ">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2023-02-27T15:10:08+08:00">
    <meta property="article:modified_time" content="2025-06-08T22:47:19+08:00">
    <meta property="article:tag" content="heap exploitation">
    <meta property="article:tag" content="house of">
    <meta property="article:tag" content="glibc">
    <meta property="og:image" content="https://roderickchan.github.io/">

  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:image" content="https://roderickchan.github.io/">
  <meta name="twitter:title" content="Glibcå †åˆ©ç”¨ä¹‹house ofç³»åˆ—æ€»ç»“">
  <meta name="twitter:description" content="å°½å¯èƒ½åœ°æ€»ç»“ç›®å‰çš„house ofåˆ©ç”¨æ‰‹æ®µ">
<meta name="application-name" content="roderick - record and learn!">
<meta name="apple-mobile-web-app-title" content="roderick - record and learn!"><meta name="theme-color" data-light="#f8f8f8" data-dark="#252627" content="#f8f8f8"><meta name="msapplication-TileColor" content="#2d89ef"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#FF7359"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" type="text/html" href="https://roderickchan.github.io/zh-cn/2023-02-27-house-of-all-about-glibc-heap-exploitation/" title="Glibcå †åˆ©ç”¨ä¹‹house ofç³»åˆ—æ€»ç»“ | roderick - record and learn!" /><link rel="prev" type="text/html" href="https://roderickchan.github.io/zh-cn/2023-02-20-the-art-of-shellcode/" title="Linuxä¸‹çš„shellcodeæŠ€å·§æ€»ç»“" /><link rel="next" type="text/html" href="https://roderickchan.github.io/zh-cn/2023-03-01-analysis-of-glibc-heap-exploitation-in-high-version/" title="Glibcé«˜ç‰ˆæœ¬å †åˆ©ç”¨æ–¹æ³•æ€»ç»“" /><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" href="/lib/fontawesome-free/all.min.css" as="style" onload="this.removeAttribute('onload');this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"></noscript><link rel="preload" href="/lib/animate/animate.min.css" as="style" onload="this.removeAttribute('onload');this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="/lib/animate/animate.min.css"></noscript><script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "BlogPosting",
    "headline": "Glibcå †åˆ©ç”¨ä¹‹house ofç³»åˆ—æ€»ç»“",
    "inLanguage": "zh-CN",
    "mainEntityOfPage": {
      "@type": "WebPage",
      "@id": "https:\/\/roderickchan.github.io\/zh-cn\/2023-02-27-house-of-all-about-glibc-heap-exploitation\/"
    },"image": ["https:\/\/roderickchan.github.io\/images\/apple-devices-preview.webp"],"genre": "posts","keywords": "heap exploitation, house of, glibc","wordcount":  18865 ,
    "url": "https:\/\/roderickchan.github.io\/zh-cn\/2023-02-27-house-of-all-about-glibc-heap-exploitation\/","datePublished": "2023-02-27T15:10:08+08:00","dateModified": "2025-06-08T22:47:19+08:00","license": "æœ¬ç«™å†…å®¹é‡‡ç”¨ CC BY-NC-SA 4.0 å›½é™…è®¸å¯åè®®ã€‚","publisher": {
      "@type": "Organization",
      "name": "roderick","logo": "https:\/\/roderickchan.github.io\/images\/avatar.png"},"author": {
        "@type": "Person",
        "name": "roderick"
      },"description": "å°½å¯èƒ½åœ°æ€»ç»“ç›®å‰çš„house ofåˆ©ç”¨æ‰‹æ®µ"
  }
  </script><script src="/js/head/color-scheme.min.js"></script></head>
  <body data-header-desktop="sticky" data-header-mobile="auto"><div class="wrapper" data-page-style="normal"><header class="desktop animate__faster" id="header-desktop">
  <div class="header-wrapper" data-github-corner="right">
    <div class="header-title">
      <a href="/zh-cn/" title="roderick - record and learn!"><img class="logo" src='/logo.png' alt="roderick - record and learn!" height="32" width="32"><span class="header-title-text">roderick&#39;s blog</span></a><span class="typeit header-subtitle"><template>To record and learn!</template></span></div>
    <nav>
      <ul class="menu"><li class="menu-item">
              <a class="menu-link" href="/zh-cn/posts/"><i class="fa-solid fa-archive fa-fw fa-sm" aria-hidden="true"></i> å…¨éƒ¨æ–‡ç« </a></li><li class="menu-item">
              <a class="menu-link" href="/zh-cn/categories/"><i class="fa-solid fa-folder-tree fa-fw fa-sm" aria-hidden="true"></i> åˆ†ç±»</a></li><li class="menu-item">
              <a class="menu-link" href="/zh-cn/collections/"><i class="fa-solid fa-layer-group fa-fw fa-sm" aria-hidden="true"></i> åˆé›†</a></li><li class="menu-item">
              <a class="menu-link" href="/zh-cn/tags/"><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden="true"></i> æ ‡ç­¾</a></li><li class="menu-item">
              <a class="menu-link" href="/zh-cn/about/"><i class="fa-solid fa-info-circle fa-fw fa-sm" aria-hidden="true"></i> å…³äº</a></li><li class="menu-item">
              <a class="menu-link" href="/zh-cn/comment/"><i class="fa-regular fa-comments fa-fw fa-sm" aria-hidden="true"></i> ç•™è¨€æ¿</a></li><li class="menu-item">
              <a class="menu-link" href="https://roderick:rode%40rick@download.roderickchan.cn/" title="æˆ‘çš„èµ„æºä¸‹è½½ä¸­å¿ƒ" rel="noopener noreferrer" target="_blank"><i class="fa-solid fa-download fa-fw fa-sm" aria-hidden="true"></i> ä¸‹è½½</a></li><li class="menu-item delimiter"></li><li class="menu-item search" id="search-desktop">
            <input type="text" placeholder="æœç´¢æ–‡ç« æ ‡é¢˜æˆ–å†…å®¹â€¦â€¦" id="search-input-desktop">
            <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="æœç´¢">
              <i class="fa-solid fa-search fa-fw" aria-hidden="true"></i>
            </a>
            <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="æ¸…ç©º">
              <i class="fa-solid fa-times-circle fa-fw" aria-hidden="true"></i>
            </a>
            <span class="search-button search-loading" id="search-loading-desktop">
              <i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
            </span>
          </li><li class="menu-item theme-switch" title="åˆ‡æ¢ä¸»é¢˜">
          <i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i>
        </li><li class="menu-item language-switch">
            <span role="button" aria-label="é€‰æ‹©è¯­è¨€" title="é€‰æ‹©è¯­è¨€"><i class="fa-solid fa-language fa-fw" aria-hidden="true"></i></span>
            <ul class="sub-menu"><li class="menu-item">æ²¡æœ‰æ›´å¤šç¿»è¯‘</li></ul>
          </li><li class="menu-item language-switch auto d-none" aria-hidden="true">
    <span role="button" aria-label="é€‰æ‹©è¯­è¨€" title="é€‰æ‹©è¯­è¨€"><i class="fa-solid fa-language fa-fw" aria-hidden="true"></i></span>
    <ul class="sub-menu"><li class="menu-item active" data-type="artificial">
              <a href="/zh-cn/2023-02-27-house-of-all-about-glibc-heap-exploitation/" data-lang="zh-CN" class="menu-link text-secondary" title="ç®€ä½“ä¸­æ–‡">
                <i class="fa-solid fa-person fa-fw fa-sm" aria-hidden="true"></i> ç®€ä½“ä¸­æ–‡</a>
            </li><li class="menu-item-divider" aria-hidden="true"></li><li class="menu-item" data-type="machine">
          <a data-lang="english" class="menu-link" title="English">
            <i class="fa-solid fa-robot fa-fw fa-sm" aria-hidden="true"></i> English</a>
        </li><li class="menu-item" data-type="machine">
          <a data-lang="french" class="menu-link" title="FranÃ§ais">
            <i class="fa-solid fa-robot fa-fw fa-sm" aria-hidden="true"></i> FranÃ§ais</a>
        </li><li class="menu-item" data-type="machine">
          <a data-lang="russian" class="menu-link" title="Ğ ÑƒÑÑĞºĞ¸Ğ¹ ÑĞ·Ñ‹Ğº">
            <i class="fa-solid fa-robot fa-fw fa-sm" aria-hidden="true"></i> Ğ ÑƒÑÑĞºĞ¸Ğ¹ ÑĞ·Ñ‹Ğº</a>
        </li><li class="menu-item" data-type="machine">
          <a data-lang="chinese_simplified" class="menu-link" title="ç®€ä½“ä¸­æ–‡">
            <i class="fa-solid fa-robot fa-fw fa-sm" aria-hidden="true"></i> ç®€ä½“ä¸­æ–‡</a>
        </li><li class="menu-item" data-type="machine">
          <a data-lang="hindi" class="menu-link" title="à¤¹à¤¿à¤¨à¥à¤¦à¥€">
            <i class="fa-solid fa-robot fa-fw fa-sm" aria-hidden="true"></i> à¤¹à¤¿à¤¨à¥à¤¦à¥€</a>
        </li><li class="menu-item" data-type="machine">
          <a data-lang="japanese" class="menu-link" title="æ—¥æœ¬èª">
            <i class="fa-solid fa-robot fa-fw fa-sm" aria-hidden="true"></i> æ—¥æœ¬èª</a>
        </li><li class="menu-item" data-type="machine">
          <a data-lang="chinese_traditional" class="menu-link" title="ç¹é«”ä¸­æ–‡">
            <i class="fa-solid fa-robot fa-fw fa-sm" aria-hidden="true"></i> ç¹é«”ä¸­æ–‡</a>
        </li><li class="menu-item" data-type="machine">
          <a data-lang="spanish" class="menu-link" title="EspaÃ±ol">
            <i class="fa-solid fa-robot fa-fw fa-sm" aria-hidden="true"></i> EspaÃ±ol</a>
        </li><li class="menu-item" data-type="machine">
          <a data-lang="korean" class="menu-link" title="í•œêµ­ì–´">
            <i class="fa-solid fa-robot fa-fw fa-sm" aria-hidden="true"></i> í•œêµ­ì–´</a>
        </li></ul>
  </li></ul>
    </nav>
  </div>
</header><header class="mobile animate__faster" id="header-mobile">
  <div class="header-container">
    <div class="header-wrapper">
      <div class="header-title">
        <a href="/zh-cn/" title="roderick - record and learn!"><img class="logo" src='/logo.png' alt="roderick - record and learn!" height="26" width="26"><span class="header-title-text">roderick&#39;s blog</span></a><span class="typeit header-subtitle"><template>To record and learn!</template></span></div>
      <div class="menu-toggle" id="menu-toggle-mobile">
        <span></span><span></span><span></span>
      </div>
    </div>
    <nav>
      <ul class="menu" id="menu-mobile"><li class="search-wrapper">
            <div class="search mobile" id="search-mobile">
              <input type="text" placeholder="æœç´¢æ–‡ç« æ ‡é¢˜æˆ–å†…å®¹â€¦â€¦" id="search-input-mobile">
              <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="æœç´¢">
                <i class="fa-solid fa-search fa-fw" aria-hidden="true"></i>
              </a>
              <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="æ¸…ç©º">
                <i class="fa-solid fa-times-circle fa-fw" aria-hidden="true"></i>
              </a>
              <span class="search-button search-loading" id="search-loading-mobile">
                <i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
              </span>
            </div>
            <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
              å–æ¶ˆ
            </a>
          </li><li class="menu-item"><a class="menu-link" href="/zh-cn/posts/"><i class="fa-solid fa-archive fa-fw fa-sm" aria-hidden="true"></i> å…¨éƒ¨æ–‡ç« </a></li><li class="menu-item"><a class="menu-link" href="/zh-cn/categories/"><i class="fa-solid fa-folder-tree fa-fw fa-sm" aria-hidden="true"></i> åˆ†ç±»</a></li><li class="menu-item"><a class="menu-link" href="/zh-cn/collections/"><i class="fa-solid fa-layer-group fa-fw fa-sm" aria-hidden="true"></i> åˆé›†</a></li><li class="menu-item"><a class="menu-link" href="/zh-cn/tags/"><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden="true"></i> æ ‡ç­¾</a></li><li class="menu-item"><a class="menu-link" href="/zh-cn/about/"><i class="fa-solid fa-info-circle fa-fw fa-sm" aria-hidden="true"></i> å…³äº</a></li><li class="menu-item"><a class="menu-link" href="/zh-cn/comment/"><i class="fa-regular fa-comments fa-fw fa-sm" aria-hidden="true"></i> ç•™è¨€æ¿</a></li><li class="menu-item"><a class="menu-link" href="https://roderick:rode%40rick@download.roderickchan.cn/" title="æˆ‘çš„èµ„æºä¸‹è½½ä¸­å¿ƒ" rel="noopener noreferrer" target="_blank"><i class="fa-solid fa-download fa-fw fa-sm" aria-hidden="true"></i> ä¸‹è½½</a></li><li class="menu-item text-center"><a class="menu-link" href="https://github.com/RoderickChan" title="GitHub" rel="noopener noreferrer" target="_blank"><i class='fa-brands fa-github fa-fw' aria-hidden='true'></i> </a></li><li class="menu-item menu-system">
          <span class="menu-system-item theme-switch" title="åˆ‡æ¢ä¸»é¢˜"><i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i></span><span class="menu-system-item language-switch">
              <span role="button" aria-label="é€‰æ‹©è¯­è¨€" title="é€‰æ‹©è¯­è¨€">ç®€ä½“ä¸­æ–‡<i class="dropdown-icon fa-solid fa-chevron-down" aria-hidden="true"></i></span>
              <select class="language-select" onchange="location = this.value;"><option disabled>æ²¡æœ‰æ›´å¤šç¿»è¯‘</option></select>
            </span><span id="translate" class="menu-system-item language-switch auto d-none" aria-hidden="true">
    <span role="button" aria-label="é€‰æ‹©è¯­è¨€" title="é€‰æ‹©è¯­è¨€" data-current="ç®€ä½“ä¸­æ–‡">ç®€ä½“ä¸­æ–‡<i class="dropdown-icon fa-solid fa-chevron-down" aria-hidden="true"></i></span>
  </span></li>
      </ul>
    </nav>
  </div>
</header><div class="search-dropdown desktop">
    <div id="search-dropdown-desktop"></div>
  </div>
  <div class="search-dropdown mobile">
    <div id="search-dropdown-mobile"></div>
  </div><nav aria-label="breadcrumb" class="breadcrumb-container sticky">
    <ol class="breadcrumb"><li class="breadcrumb-item" data-separator="/"><a href="/zh-cn/posts/" title="Posts">æ–‡ç« </a></li><li class="breadcrumb-item active" data-separator="/" aria-current="page">Glibcå †åˆ©ç”¨ä¹‹house Ofç³»åˆ—æ€»ç»“</li>
    </ol>
  </nav><main class="container"><aside class="aside-collection animate__animated animate__fadeIn animate__faster" aria-label="åˆé›†"><div class="details related-details open">
      <div class="details-summary related-summary">
        <i class="fa-solid fa-fire fa-fade text-danger fa-fw" aria-hidden="true"></i>
        <span class="related-title">ç›¸å…³å†…å®¹</span><i class="details-icon fa-solid fa-angle-right fa-fw" aria-hidden="true"></i></div>
      <div class="details-content related-content">
        <ul class="related-list"><li class="related-item">
              <a href="/zh-cn/house-of-apple-%E4%B8%80%E7%A7%8D%E6%96%B0%E7%9A%84glibc%E4%B8%ADio%E6%94%BB%E5%87%BB%E6%96%B9%E6%B3%95-3/" title="House of Apple ä¸€ç§æ–°çš„glibcä¸­IOæ”»å‡»æ–¹æ³• (3)">House of Apple ä¸€ç§æ–°çš„glibcä¸­IOæ”»å‡»æ–¹æ³• (3)</a></li><li class="related-item">
              <a href="/zh-cn/house-of-apple-%E4%B8%80%E7%A7%8D%E6%96%B0%E7%9A%84glibc%E4%B8%ADio%E6%94%BB%E5%87%BB%E6%96%B9%E6%B3%95-2/" title="House of Apple ä¸€ç§æ–°çš„glibcä¸­IOæ”»å‡»æ–¹æ³• (2)">House of Apple ä¸€ç§æ–°çš„glibcä¸­IOæ”»å‡»æ–¹æ³• (2)</a></li><li class="related-item">
              <a href="/zh-cn/house-of-apple-%E4%B8%80%E7%A7%8D%E6%96%B0%E7%9A%84glibc%E4%B8%ADio%E6%94%BB%E5%87%BB%E6%96%B9%E6%B3%95-1/" title="House of Apple ä¸€ç§æ–°çš„glibcä¸­IOæ”»å‡»æ–¹æ³• (1)">House of Apple ä¸€ç§æ–°çš„glibcä¸­IOæ”»å‡»æ–¹æ³• (1)</a></li><li class="related-item">
              <a href="/zh-cn/2022-06-18-glibcheap-house-of-muney/" title="GlibcHeap-House of Muney">GlibcHeap-House of Muney</a></li></ul>
      </div>
    </div><div class="aside-custom"><img src="https://image.roderickchan.cn/img/roderick_wechat_official_account_white_in_green.png" height="104" width="372">

</div></aside>

  <article class="page single">
    <div class="header"><h1 class="single-title animate__animated animate__flipInX"><span>Glibcå †åˆ©ç”¨ä¹‹house Ofç³»åˆ—æ€»ç»“</span>
      </h1></div><div class="post-meta">
      <div class="post-meta-line"><span class="post-author"><a href="https://www.roderickchan.cn" title="ä½œè€…"target="_blank" rel="external nofollow noopener noreferrer author" class="author"><img class="avatar" src='https://gravatar.loli.net/avatar/6f579d9b68b13aed76b08fee1c3ede40?s=32&d=mp' alt="roderick" height="16" width="16">&nbsp;roderick</a></span><span class="post-included-in">&nbsp;æ”¶å½•äº <a href="/zh-cn/categories/pwn-trick/" class="post-category" title="åˆ†ç±» - pwn-trick"><i class="fa-regular fa-folder fa-fw" aria-hidden="true"></i> pwn-trick</a></span></div><div class="post-meta-line"><span title="å‘å¸ƒäº 2023-02-27 15:10:08"><i class="fa-solid fa-calendar-days fa-fw me-1" aria-hidden="true"></i><time datetime="2023-02-27">2023-02-27</time></span>&nbsp;<span title="æ›´æ–°äº 2025-06-08 22:47:19"><i class="fa-regular fa-calendar-check fa-fw me-1" aria-hidden="true"></i><time datetime="2025-06-08">2025-06-08</time></span>&nbsp;<span title="18865 å­—"><i class="fa-solid fa-pencil-alt fa-fw me-1" aria-hidden="true"></i>çº¦ 18900 å­—</span>&nbsp;<span><i class="fa-regular fa-clock fa-fw me-1" aria-hidden="true"></i>é¢„è®¡é˜…è¯» 38 åˆ†é’Ÿ</span>&nbsp;<span id="busuanzi_container_page_pv" class="busuanzi_visitors comment-visitors" data-flag-title="Glibcå †åˆ©ç”¨ä¹‹house Ofç³»åˆ—æ€»ç»“"><i class="fa-regular fa-eye fa-fw me-1" aria-hidden="true"></i><span id="busuanzi_value_page_pv">-</span>&nbsp;æ¬¡é˜…è¯»
          </span>&nbsp;</div>
    </div><div class="details toc" id="toc-static" data-kept="false">
        <div class="details-summary toc-title">
          <span>ç›®å½•</span>
          <span><i class="details-icon fa-solid fa-angle-right" aria-hidden="true"></i></span>
        </div>
        <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#1-å‰è¨€">1-å‰è¨€</a></li>
    <li><a href="#2-house-ofç³»åˆ—">2-house ofç³»åˆ—</a>
      <ul>
        <li><a href="#21-house-of-spirit">2.1-house of spirit</a>
          <ul>
            <li><a href="#æ¼æ´æˆå› ">æ¼æ´æˆå› </a></li>
            <li><a href="#é€‚ç”¨èŒƒå›´">é€‚ç”¨èŒƒå›´</a></li>
            <li><a href="#åˆ©ç”¨åŸç†">åˆ©ç”¨åŸç†</a></li>
            <li><a href="#ç›¸å…³æŠ€å·§">ç›¸å…³æŠ€å·§</a></li>
            <li><a href="#åˆ©ç”¨æ•ˆæœ">åˆ©ç”¨æ•ˆæœ</a></li>
          </ul>
        </li>
        <li><a href="#22-house-of-einherjar">2.2-house of einherjar</a>
          <ul>
            <li><a href="#æ¼æ´æˆå› -1">æ¼æ´æˆå› </a></li>
            <li><a href="#é€‚ç”¨èŒƒå›´-1">é€‚ç”¨èŒƒå›´</a></li>
            <li><a href="#åˆ©ç”¨åŸç†-1">åˆ©ç”¨åŸç†</a></li>
            <li><a href="#ç›¸å…³æŠ€å·§-1">ç›¸å…³æŠ€å·§</a></li>
            <li><a href="#åˆ©ç”¨æ•ˆæœ-1">åˆ©ç”¨æ•ˆæœ</a></li>
          </ul>
        </li>
        <li><a href="#23-house-of-force">2.3-house of force</a>
          <ul>
            <li><a href="#æ¼æ´æˆå› -2">æ¼æ´æˆå› </a></li>
            <li><a href="#é€‚ç”¨èŒƒå›´-2">é€‚ç”¨èŒƒå›´</a></li>
            <li><a href="#åˆ©ç”¨åŸç†-2">åˆ©ç”¨åŸç†</a></li>
            <li><a href="#ç›¸å…³æŠ€å·§-2">ç›¸å…³æŠ€å·§</a></li>
            <li><a href="#åˆ©ç”¨æ•ˆæœ-2">åˆ©ç”¨æ•ˆæœ</a></li>
          </ul>
        </li>
        <li><a href="#24-house-of-lore">2.4-house of lore</a>
          <ul>
            <li><a href="#æ¼æ´æˆå› -3">æ¼æ´æˆå› </a></li>
            <li><a href="#é€‚ç”¨èŒƒå›´-3">é€‚ç”¨èŒƒå›´</a></li>
            <li><a href="#åˆ©ç”¨åŸç†-3">åˆ©ç”¨åŸç†</a></li>
            <li><a href="#ç›¸å…³æŠ€å·§-3">ç›¸å…³æŠ€å·§</a></li>
            <li><a href="#åˆ©ç”¨æ•ˆæœ-3">åˆ©ç”¨æ•ˆæœ</a></li>
          </ul>
        </li>
        <li><a href="#25-house-of-orange">2.5-house of orange</a>
          <ul>
            <li><a href="#æ¼æ´æˆå› -4">æ¼æ´æˆå› </a></li>
            <li><a href="#é€‚ç”¨èŒƒå›´-4">é€‚ç”¨èŒƒå›´</a></li>
            <li><a href="#åˆ©ç”¨åŸç†-4">åˆ©ç”¨åŸç†</a></li>
            <li><a href="#ç›¸å…³æŠ€å·§-4">ç›¸å…³æŠ€å·§</a></li>
            <li><a href="#åˆ©ç”¨æ•ˆæœ-4">åˆ©ç”¨æ•ˆæœ</a></li>
          </ul>
        </li>
        <li><a href="#26-house-of-rabbit">2.6-house of rabbit</a>
          <ul>
            <li><a href="#æ¼æ´æˆå› -5">æ¼æ´æˆå› </a></li>
            <li><a href="#é€‚ç”¨èŒƒå›´-5">é€‚ç”¨èŒƒå›´</a></li>
            <li><a href="#åˆ©ç”¨åŸç†-5">åˆ©ç”¨åŸç†</a></li>
            <li><a href="#ç›¸å…³æŠ€å·§-5">ç›¸å…³æŠ€å·§</a></li>
            <li><a href="#åˆ©ç”¨æ•ˆæœ-5">åˆ©ç”¨æ•ˆæœ</a></li>
          </ul>
        </li>
        <li><a href="#27-house-of-roman">2.7-house of roman</a>
          <ul>
            <li><a href="#æ¼æ´æˆå› -6">æ¼æ´æˆå› </a></li>
            <li><a href="#é€‚ç”¨èŒƒå›´-6">é€‚ç”¨èŒƒå›´</a></li>
            <li><a href="#åˆ©ç”¨åŸç†-6">åˆ©ç”¨åŸç†</a></li>
            <li><a href="#ç›¸å…³æŠ€å·§-6">ç›¸å…³æŠ€å·§</a></li>
            <li><a href="#åˆ©ç”¨æ•ˆæœ-6">åˆ©ç”¨æ•ˆæœ</a></li>
          </ul>
        </li>
        <li><a href="#28-house-of-storm">2.8-house of storm</a>
          <ul>
            <li><a href="#æ¼æ´æˆå› -7">æ¼æ´æˆå› </a></li>
            <li><a href="#é€‚ç”¨èŒƒå›´-7">é€‚ç”¨èŒƒå›´</a></li>
            <li><a href="#åˆ©ç”¨åŸç†-7">åˆ©ç”¨åŸç†</a></li>
            <li><a href="#ç›¸å…³æŠ€å·§-7">ç›¸å…³æŠ€å·§</a></li>
            <li><a href="#åˆ©ç”¨æ•ˆæœ-7">åˆ©ç”¨æ•ˆæœ</a></li>
          </ul>
        </li>
        <li><a href="#29-house-of-corrosion">2.9-house of corrosion</a>
          <ul>
            <li><a href="#æ¼æ´æˆå› -8">æ¼æ´æˆå› </a></li>
            <li><a href="#é€‚ç”¨èŒƒå›´-8">é€‚ç”¨èŒƒå›´</a></li>
            <li><a href="#åˆ©ç”¨åŸç†-8">åˆ©ç”¨åŸç†</a></li>
            <li><a href="#ç›¸å…³æŠ€å·§-8">ç›¸å…³æŠ€å·§</a></li>
            <li><a href="#åˆ©ç”¨æ•ˆæœ-8">åˆ©ç”¨æ•ˆæœ</a></li>
          </ul>
        </li>
        <li><a href="#210-house-of-husk">2.10-house of husk</a>
          <ul>
            <li><a href="#æ¼æ´æˆå› -9">æ¼æ´æˆå› </a></li>
            <li><a href="#é€‚ç”¨èŒƒå›´-9">é€‚ç”¨èŒƒå›´</a></li>
            <li><a href="#åˆ©ç”¨åŸç†-9">åˆ©ç”¨åŸç†</a></li>
            <li><a href="#ç›¸å…³æŠ€å·§-9">ç›¸å…³æŠ€å·§</a></li>
            <li><a href="#åˆ©ç”¨æ•ˆæœ-9">åˆ©ç”¨æ•ˆæœ</a></li>
          </ul>
        </li>
        <li><a href="#211-house-of-atum">2.11-house of atum</a>
          <ul>
            <li><a href="#æ¼æ´æˆå› -10">æ¼æ´æˆå› </a></li>
            <li><a href="#é€‚ç”¨èŒƒå›´-10">é€‚ç”¨èŒƒå›´</a></li>
            <li><a href="#åˆ©ç”¨åŸç†-10">åˆ©ç”¨åŸç†</a></li>
            <li><a href="#ç›¸å…³æŠ€å·§-10">ç›¸å…³æŠ€å·§</a></li>
            <li><a href="#åˆ©ç”¨æ•ˆæœ-10">åˆ©ç”¨æ•ˆæœ</a></li>
          </ul>
        </li>
        <li><a href="#212-house-of-kauri">2.12-house of kauri</a>
          <ul>
            <li><a href="#æ¼æ´æˆå› -11">æ¼æ´æˆå› </a></li>
            <li><a href="#é€‚ç”¨èŒƒå›´-11">é€‚ç”¨èŒƒå›´</a></li>
            <li><a href="#åˆ©ç”¨åŸç†-11">åˆ©ç”¨åŸç†</a></li>
            <li><a href="#ç›¸å…³æŠ€å·§-11">ç›¸å…³æŠ€å·§</a></li>
            <li><a href="#åˆ©ç”¨æ•ˆæœ-11">åˆ©ç”¨æ•ˆæœ</a></li>
          </ul>
        </li>
        <li><a href="#213-house-of-fun">2.13-house of fun</a>
          <ul>
            <li><a href="#æ¼æ´æˆå› -12">æ¼æ´æˆå› </a></li>
            <li><a href="#é€‚ç”¨èŒƒå›´-12">é€‚ç”¨èŒƒå›´</a></li>
            <li><a href="#åˆ©ç”¨åŸç†-12">åˆ©ç”¨åŸç†</a></li>
            <li><a href="#ç›¸å…³æŠ€å·§-12">ç›¸å…³æŠ€å·§</a></li>
            <li><a href="#åˆ©ç”¨æ•ˆæœ-12">åˆ©ç”¨æ•ˆæœ</a></li>
          </ul>
        </li>
        <li><a href="#214-house-of-mind">2.14-house of mind</a>
          <ul>
            <li><a href="#æ¼æ´æˆå› -13">æ¼æ´æˆå› </a></li>
            <li><a href="#é€‚ç”¨èŒƒå›´-13">é€‚ç”¨èŒƒå›´</a></li>
            <li><a href="#åˆ©ç”¨åŸç†-13">åˆ©ç”¨åŸç†</a></li>
            <li><a href="#ç›¸å…³æŠ€å·§-13">ç›¸å…³æŠ€å·§</a></li>
            <li><a href="#åˆ©ç”¨æ•ˆæœ-13">åˆ©ç”¨æ•ˆæœ</a></li>
          </ul>
        </li>
        <li><a href="#215-house-of-muney">2.15-house of muney</a>
          <ul>
            <li><a href="#æ¼æ´æˆå› -14">æ¼æ´æˆå› </a></li>
            <li><a href="#é€‚ç”¨èŒƒå›´-14">é€‚ç”¨èŒƒå›´</a></li>
            <li><a href="#åˆ©ç”¨åŸç†-14">åˆ©ç”¨åŸç†</a></li>
            <li><a href="#ç›¸å…³æŠ€å·§-14">ç›¸å…³æŠ€å·§</a></li>
            <li><a href="#åˆ©ç”¨æ•ˆæœ-14">åˆ©ç”¨æ•ˆæœ</a></li>
          </ul>
        </li>
        <li><a href="#216-house-of-botcake">2.16-house of botcake</a>
          <ul>
            <li><a href="#æ¼æ´æˆå› -15">æ¼æ´æˆå› </a></li>
            <li><a href="#é€‚ç”¨èŒƒå›´-15">é€‚ç”¨èŒƒå›´</a></li>
            <li><a href="#åˆ©ç”¨åŸç†-15">åˆ©ç”¨åŸç†</a></li>
            <li><a href="#ç›¸å…³æŠ€å·§-15">ç›¸å…³æŠ€å·§</a></li>
            <li><a href="#åˆ©ç”¨æ•ˆæœ-15">åˆ©ç”¨æ•ˆæœ</a></li>
          </ul>
        </li>
        <li><a href="#217-house-of-rust">2.17-house of rust</a>
          <ul>
            <li><a href="#æ¼æ´æˆå› -16">æ¼æ´æˆå› </a></li>
            <li><a href="#é€‚ç”¨èŒƒå›´-16">é€‚ç”¨èŒƒå›´</a></li>
            <li><a href="#åˆ©ç”¨åŸç†-16">åˆ©ç”¨åŸç†</a></li>
            <li><a href="#ç›¸å…³æŠ€å·§-16">ç›¸å…³æŠ€å·§</a></li>
            <li><a href="#åˆ©ç”¨æ•ˆæœ-16">åˆ©ç”¨æ•ˆæœ</a></li>
          </ul>
        </li>
        <li><a href="#218-house-of-crust">2.18-house of crust</a>
          <ul>
            <li><a href="#æ¼æ´æˆå› -17">æ¼æ´æˆå› </a></li>
            <li><a href="#é€‚ç”¨èŒƒå›´-17">é€‚ç”¨èŒƒå›´</a></li>
            <li><a href="#åˆ©ç”¨åŸç†-17">åˆ©ç”¨åŸç†</a></li>
            <li><a href="#ç›¸å…³æŠ€å·§-17">ç›¸å…³æŠ€å·§</a></li>
          </ul>
        </li>
        <li><a href="#219-house-of-io">2.19-house of io</a>
          <ul>
            <li><a href="#æ¼æ´æˆå› -18">æ¼æ´æˆå› </a></li>
            <li><a href="#é€‚ç”¨èŒƒå›´-18">é€‚ç”¨èŒƒå›´</a></li>
            <li><a href="#åˆ©ç”¨åŸç†-18">åˆ©ç”¨åŸç†</a></li>
            <li><a href="#ç›¸å…³æŠ€å·§-18">ç›¸å…³æŠ€å·§</a></li>
            <li><a href="#åˆ©ç”¨æ•ˆæœ-17">åˆ©ç”¨æ•ˆæœ</a></li>
          </ul>
        </li>
        <li><a href="#220-house-of-banana">2.20-house of banana</a>
          <ul>
            <li><a href="#æ¼æ´æˆå› -19">æ¼æ´æˆå› </a></li>
            <li><a href="#é€‚ç”¨èŒƒå›´-19">é€‚ç”¨èŒƒå›´</a></li>
            <li><a href="#åˆ©ç”¨åŸç†-19">åˆ©ç”¨åŸç†</a></li>
            <li><a href="#ç›¸å…³æŠ€å·§-19">ç›¸å…³æŠ€å·§</a></li>
            <li><a href="#åˆ©ç”¨æ•ˆæœ-18">åˆ©ç”¨æ•ˆæœ</a></li>
          </ul>
        </li>
        <li><a href="#221-house-of-kiwi">2.21-house of kiwi</a>
          <ul>
            <li><a href="#æ¼æ´æˆå› -20">æ¼æ´æˆå› </a></li>
            <li><a href="#é€‚ç”¨èŒƒå›´-20">é€‚ç”¨èŒƒå›´</a></li>
            <li><a href="#åˆ©ç”¨åŸç†-20">åˆ©ç”¨åŸç†</a></li>
            <li><a href="#ç›¸å…³æŠ€å·§-20">ç›¸å…³æŠ€å·§</a></li>
            <li><a href="#åˆ©ç”¨æ•ˆæœ-19">åˆ©ç”¨æ•ˆæœ</a></li>
          </ul>
        </li>
        <li><a href="#222-house-of-emma">2.22-house of emma</a>
          <ul>
            <li><a href="#æ¼æ´æˆå› -21">æ¼æ´æˆå› </a></li>
            <li><a href="#é€‚ç”¨èŒƒå›´-21">é€‚ç”¨èŒƒå›´</a></li>
            <li><a href="#åˆ©ç”¨åŸç†-21">åˆ©ç”¨åŸç†</a></li>
            <li><a href="#ç›¸å…³æŠ€å·§-21">ç›¸å…³æŠ€å·§</a></li>
            <li><a href="#åˆ©ç”¨æ•ˆæœ-20">åˆ©ç”¨æ•ˆæœ</a></li>
          </ul>
        </li>
        <li><a href="#223-house-of-pig">2.23-house of pig</a>
          <ul>
            <li><a href="#æ¼æ´æˆå› -22">æ¼æ´æˆå› </a></li>
            <li><a href="#é€‚ç”¨èŒƒå›´-22">é€‚ç”¨èŒƒå›´</a></li>
            <li><a href="#åˆ©ç”¨åŸç†-22">åˆ©ç”¨åŸç†</a></li>
            <li><a href="#ç›¸å…³æŠ€å·§-22">ç›¸å…³æŠ€å·§</a></li>
            <li><a href="#åˆ©ç”¨æ•ˆæœ-21">åˆ©ç”¨æ•ˆæœ</a></li>
          </ul>
        </li>
        <li><a href="#224-house-of-obstack">2.24-house of obstack</a>
          <ul>
            <li><a href="#æ¼æ´æˆå› -23">æ¼æ´æˆå› </a></li>
            <li><a href="#é€‚ç”¨èŒƒå›´-23">é€‚ç”¨èŒƒå›´</a></li>
            <li><a href="#åˆ©ç”¨åŸç†-23">åˆ©ç”¨åŸç†</a></li>
            <li><a href="#ç›¸å…³æŠ€å·§-23">ç›¸å…³æŠ€å·§</a></li>
            <li><a href="#åˆ©ç”¨æ•ˆæœ-22">åˆ©ç”¨æ•ˆæœ</a></li>
          </ul>
        </li>
        <li><a href="#225-house-of-apple1">2.25-house of apple1</a>
          <ul>
            <li><a href="#æ¼æ´æˆå› -24">æ¼æ´æˆå› </a></li>
            <li><a href="#é€‚ç”¨èŒƒå›´-24">é€‚ç”¨èŒƒå›´</a></li>
            <li><a href="#åˆ©ç”¨åŸç†-24">åˆ©ç”¨åŸç†</a></li>
            <li><a href="#ç›¸å…³æŠ€å·§-24">ç›¸å…³æŠ€å·§</a></li>
            <li><a href="#åˆ©ç”¨æ•ˆæœ-23">åˆ©ç”¨æ•ˆæœ</a></li>
          </ul>
        </li>
        <li><a href="#226-house-of-apple2">2.26-house of apple2</a>
          <ul>
            <li><a href="#æ¼æ´æˆå› -25">æ¼æ´æˆå› </a></li>
            <li><a href="#é€‚ç”¨èŒƒå›´-25">é€‚ç”¨èŒƒå›´</a></li>
            <li><a href="#åˆ©ç”¨åŸç†-25">åˆ©ç”¨åŸç†</a></li>
            <li><a href="#ç›¸å…³æŠ€å·§-25">ç›¸å…³æŠ€å·§</a></li>
            <li><a href="#åˆ©ç”¨æ•ˆæœ-24">åˆ©ç”¨æ•ˆæœ</a></li>
          </ul>
        </li>
        <li><a href="#227-house-of-apple3">2.27-house of apple3</a>
          <ul>
            <li><a href="#æ¼æ´æˆå› -26">æ¼æ´æˆå› </a></li>
            <li><a href="#é€‚ç”¨èŒƒå›´-26">é€‚ç”¨èŒƒå›´</a></li>
            <li><a href="#åˆ©ç”¨åŸç†-26">åˆ©ç”¨åŸç†</a></li>
            <li><a href="#ç›¸å…³æŠ€å·§-26">ç›¸å…³æŠ€å·§</a></li>
            <li><a href="#åˆ©ç”¨æ•ˆæœ-25">åˆ©ç”¨æ•ˆæœ</a></li>
          </ul>
        </li>
        <li><a href="#228-house-of-gods">2.28-house of gods</a>
          <ul>
            <li><a href="#æ¼æ´æˆå› -27">æ¼æ´æˆå› </a></li>
            <li><a href="#é€‚ç”¨èŒƒå›´-27">é€‚ç”¨èŒƒå›´</a></li>
            <li><a href="#åˆ©ç”¨åŸç†-27">åˆ©ç”¨åŸç†</a></li>
            <li><a href="#ç›¸å…³æŠ€å·§-27">ç›¸å…³æŠ€å·§</a></li>
            <li><a href="#åˆ©ç”¨æ•ˆæœ-26">åˆ©ç”¨æ•ˆæœ</a></li>
          </ul>
        </li>
        <li><a href="#229-house-of-lys">2.29-house of lys</a>
          <ul>
            <li><a href="#æ¼æ´æˆå› -28">æ¼æ´æˆå› </a></li>
            <li><a href="#é€‚ç”¨èŒƒå›´-28">é€‚ç”¨èŒƒå›´</a></li>
            <li><a href="#åˆ©ç”¨åŸç†-28">åˆ©ç”¨åŸç†</a></li>
            <li><a href="#ç›¸å…³æŠ€å·§-28">ç›¸å…³æŠ€å·§</a></li>
            <li><a href="#åˆ©ç”¨æ•ˆæœ-27">åˆ©ç”¨æ•ˆæœ</a></li>
          </ul>
        </li>
        <li><a href="#230-house-of-snake">2.30-house of snake</a></li>
      </ul>
    </li>
    <li><a href="#3-æ€»ç»“">3-æ€»ç»“</a></li>
    <li><a href="#4-å‚è€ƒ">4-å‚è€ƒ</a></li>
  </ul>
</nav></div>
      </div><div class="ai-summary-container" style="margin: 20px 0; padding: 20px; border: 2px solid #e1e5e9; border-radius: 12px; background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%); box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);">
  <div class="ai-summary-header" style="display: flex; align-items: center; margin-bottom: 15px;">
    <h3 class="ai-summary-title" style="margin: 0; color: #495057; font-size: 18px; font-weight: 600;">
      ğŸ¤– æœ¬æ–‡çš„AIæ‘˜è¦
    </h3>
  </div>
  
<div class="typeit" data-speed="50" data-cursor-speed="1000" data-cursor-char="|" style="margin: 0; line-height: 1.6; color: #6c757d; font-size: 14px;">
  <template>æœ¬æ–‡æ€»ç»“äº†glibcå †åˆ©ç”¨çš„30ç§house ofç³»åˆ—æ‰‹æ³•ï¼Œæ¶µç›–ä»2.23åˆ°æœ€æ–°ç‰ˆæœ¬çš„æŠ€æœ¯è¦ç‚¹ã€‚ä¸»è¦å†…å®¹åŒ…æ‹¬ï¼šæ¯ç§æ‰‹æ³•çš„æ¼æ´æˆå› ã€é€‚ç”¨èŒƒå›´ã€åˆ©ç”¨åŸç†åŠæ•ˆæœï¼Œå¦‚house of spirité€šè¿‡ä¼ªé€ fake chunkå®ç°ä»»æ„åœ°å€åˆ†é…ï¼Œhouse of orangeç»“åˆå †ä¸IOæµæ”»å‡»å®ç°ä»»æ„ä»£ç æ‰§è¡Œç­‰ã€‚æ–‡ç« å¼ºè°ƒç†è§£åº•å±‚åŸç†çš„é‡è¦æ€§ï¼Œå»ºè®®ç»“åˆæºç åˆ†æï¼Œå¹¶æä¾›äº†è¯¦ç»†çš„æŠ€æœ¯å‚è€ƒé“¾æ¥ã€‚è¿™äº›æŠ€æœ¯å¤šåŸºäºå †æº¢å‡ºã€UAFç­‰æ¼æ´ï¼Œé€šè¿‡ç²¾å¿ƒæ„é€ çš„å †å¸ƒå±€å’Œåˆ©ç”¨é“¾ï¼Œå¯å®ç°ä»»æ„åœ°å€è¯»å†™ã€å‡½æ•°æ‰§è¡Œç­‰æ•ˆæœï¼Œä¸ºCTFæ¯”èµ›å’Œæ¼æ´åˆ†ææä¾›äº†ç³»ç»Ÿçš„æ–¹æ³•è®ºã€‚</template>
</div>
</div>


<style>
  @media (max-width: 768px) {
    .ai-summary-container {
      margin: 15px 0 !important;
      padding: 15px !important;
    }
    
    .ai-summary-title {
      font-size: 16px !important;
    }
    
    .ai-summary-content {
      padding: 12px !important;
    }
    
    .ai-summary-content p {
      font-size: 13px !important;
    }
  }
  
   
  @media (prefers-color-scheme: dark) {
    .ai-summary-container {
      background: linear-gradient(135deg, #2d3748 0%, #4a5568 100%) !important;
      border-color: #4a5568 !important;
    }
    
    .ai-summary-title {
      color: #e2e8f0 !important;
    }
    
    .ai-summary-content {
      background: #1a202c !important;
      border-left-color: #3182ce !important;
    }
    
    .ai-summary-content p {
      color: #a0aec0 !important;
    }
  }
  
   
  .ai-summary-container:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
    transition: all 0.3s ease;
  }
  
   
  .ai-summary-title {
    transition: color 0.3s ease;
  }
  
  .ai-summary-container:hover .ai-summary-title {
    color: #007bff !important;
  }
</style><div class="content" id="content"><blockquote>
<p>æ€»ç»“ä¸€ä¸‹<code>glibc</code>å †åˆ©ç”¨çš„<code>house of</code>ç³»åˆ—åˆ©ç”¨æ‰‹æ³•ï¼Œä¸»è¦å‚è€ƒäº†<a href="https://github.com/shellphish/how2heap"target="_blank" rel="external nofollow noopener noreferrer">how2heap<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a>ï¼ŒåŒæ—¶å‚è€ƒäº†å…¶ä»–ä¼˜ç§€çš„æ–‡ç« ã€‚</p></blockquote>
<meting-js server="netease" type="song" id="1881521546" theme="#448aff"></meting-js>
<p>æ–‡ç« å¾ˆé•¿ï¼Œå¬é¦–éŸ³ä¹æ”¾æ¾ä¸€ä¸‹å§~</p>
<hr>
<ul>
<li><a href="#1-%e5%89%8d%e8%a8%80">1-å‰è¨€</a></li>
<li><a href="#2-house-of%e7%b3%bb%e5%88%97">2-house ofç³»åˆ—</a>
<ul>
<li><a href="#21-house-of-spirit">2.1-house of spirit</a>
<ul>
<li><a href="#%e6%bc%8f%e6%b4%9e%e6%88%90%e5%9b%a0">æ¼æ´æˆå› </a></li>
<li><a href="#%e9%80%82%e7%94%a8%e8%8c%83%e5%9b%b4">é€‚ç”¨èŒƒå›´</a></li>
<li><a href="#%e5%88%a9%e7%94%a8%e5%8e%9f%e7%90%86">åˆ©ç”¨åŸç†</a></li>
<li><a href="#%e7%9b%b8%e5%85%b3%e6%8a%80%e5%b7%a7">ç›¸å…³æŠ€å·§</a></li>
<li><a href="#%e5%88%a9%e7%94%a8%e6%95%88%e6%9e%9c">åˆ©ç”¨æ•ˆæœ</a></li>
</ul>
</li>
<li><a href="#22-house-of-einherjar">2.2-house of einherjar</a>
<ul>
<li><a href="#%e6%bc%8f%e6%b4%9e%e6%88%90%e5%9b%a0-1">æ¼æ´æˆå› </a></li>
<li><a href="#%e9%80%82%e7%94%a8%e8%8c%83%e5%9b%b4-1">é€‚ç”¨èŒƒå›´</a></li>
<li><a href="#%e5%88%a9%e7%94%a8%e5%8e%9f%e7%90%86-1">åˆ©ç”¨åŸç†</a></li>
<li><a href="#%e7%9b%b8%e5%85%b3%e6%8a%80%e5%b7%a7-1">ç›¸å…³æŠ€å·§</a></li>
<li><a href="#%e5%88%a9%e7%94%a8%e6%95%88%e6%9e%9c-1">åˆ©ç”¨æ•ˆæœ</a></li>
</ul>
</li>
<li><a href="#23-house-of-force">2.3-house of force</a>
<ul>
<li><a href="#%e6%bc%8f%e6%b4%9e%e6%88%90%e5%9b%a0-2">æ¼æ´æˆå› </a></li>
<li><a href="#%e9%80%82%e7%94%a8%e8%8c%83%e5%9b%b4-2">é€‚ç”¨èŒƒå›´</a></li>
<li><a href="#%e5%88%a9%e7%94%a8%e5%8e%9f%e7%90%86-2">åˆ©ç”¨åŸç†</a></li>
<li><a href="#%e7%9b%b8%e5%85%b3%e6%8a%80%e5%b7%a7-2">ç›¸å…³æŠ€å·§</a></li>
<li><a href="#%e5%88%a9%e7%94%a8%e6%95%88%e6%9e%9c-2">åˆ©ç”¨æ•ˆæœ</a></li>
</ul>
</li>
<li><a href="#24-house-of-lore">2.4-house of lore</a>
<ul>
<li><a href="#%e6%bc%8f%e6%b4%9e%e6%88%90%e5%9b%a0-3">æ¼æ´æˆå› </a></li>
<li><a href="#%e9%80%82%e7%94%a8%e8%8c%83%e5%9b%b4-3">é€‚ç”¨èŒƒå›´</a></li>
<li><a href="#%e5%88%a9%e7%94%a8%e5%8e%9f%e7%90%86-3">åˆ©ç”¨åŸç†</a></li>
<li><a href="#%e7%9b%b8%e5%85%b3%e6%8a%80%e5%b7%a7-3">ç›¸å…³æŠ€å·§</a></li>
<li><a href="#%e5%88%a9%e7%94%a8%e6%95%88%e6%9e%9c-3">åˆ©ç”¨æ•ˆæœ</a></li>
</ul>
</li>
<li><a href="#25-house-of-orange">2.5-house of orange</a>
<ul>
<li><a href="#%e6%bc%8f%e6%b4%9e%e6%88%90%e5%9b%a0-4">æ¼æ´æˆå› </a></li>
<li><a href="#%e9%80%82%e7%94%a8%e8%8c%83%e5%9b%b4-4">é€‚ç”¨èŒƒå›´</a></li>
<li><a href="#%e5%88%a9%e7%94%a8%e5%8e%9f%e7%90%86-4">åˆ©ç”¨åŸç†</a></li>
<li><a href="#%e7%9b%b8%e5%85%b3%e6%8a%80%e5%b7%a7-4">ç›¸å…³æŠ€å·§</a></li>
<li><a href="#%e5%88%a9%e7%94%a8%e6%95%88%e6%9e%9c-4">åˆ©ç”¨æ•ˆæœ</a></li>
</ul>
</li>
<li><a href="#26-house-of-rabbit">2.6-house of rabbit</a>
<ul>
<li><a href="#%e6%bc%8f%e6%b4%9e%e6%88%90%e5%9b%a0-5">æ¼æ´æˆå› </a></li>
<li><a href="#%e9%80%82%e7%94%a8%e8%8c%83%e5%9b%b4-5">é€‚ç”¨èŒƒå›´</a></li>
<li><a href="#%e5%88%a9%e7%94%a8%e5%8e%9f%e7%90%86-5">åˆ©ç”¨åŸç†</a></li>
<li><a href="#%e7%9b%b8%e5%85%b3%e6%8a%80%e5%b7%a7-5">ç›¸å…³æŠ€å·§</a></li>
<li><a href="#%e5%88%a9%e7%94%a8%e6%95%88%e6%9e%9c-5">åˆ©ç”¨æ•ˆæœ</a></li>
</ul>
</li>
<li><a href="#27-house-of-roman">2.7-house of roman</a>
<ul>
<li><a href="#%e6%bc%8f%e6%b4%9e%e6%88%90%e5%9b%a0-6">æ¼æ´æˆå› </a></li>
<li><a href="#%e9%80%82%e7%94%a8%e8%8c%83%e5%9b%b4-6">é€‚ç”¨èŒƒå›´</a></li>
<li><a href="#%e5%88%a9%e7%94%a8%e5%8e%9f%e7%90%86-6">åˆ©ç”¨åŸç†</a></li>
<li><a href="#%e7%9b%b8%e5%85%b3%e6%8a%80%e5%b7%a7-6">ç›¸å…³æŠ€å·§</a></li>
<li><a href="#%e5%88%a9%e7%94%a8%e6%95%88%e6%9e%9c-6">åˆ©ç”¨æ•ˆæœ</a></li>
</ul>
</li>
<li><a href="#28-house-of-storm">2.8-house of storm</a>
<ul>
<li><a href="#%e6%bc%8f%e6%b4%9e%e6%88%90%e5%9b%a0-7">æ¼æ´æˆå› </a></li>
<li><a href="#%e9%80%82%e7%94%a8%e8%8c%83%e5%9b%b4-7">é€‚ç”¨èŒƒå›´</a></li>
<li><a href="#%e5%88%a9%e7%94%a8%e5%8e%9f%e7%90%86-7">åˆ©ç”¨åŸç†</a></li>
<li><a href="#%e7%9b%b8%e5%85%b3%e6%8a%80%e5%b7%a7-7">ç›¸å…³æŠ€å·§</a></li>
<li><a href="#%e5%88%a9%e7%94%a8%e6%95%88%e6%9e%9c-7">åˆ©ç”¨æ•ˆæœ</a></li>
</ul>
</li>
<li><a href="#29-house-of-corrosion">2.9-house of corrosion</a>
<ul>
<li><a href="#%e6%bc%8f%e6%b4%9e%e6%88%90%e5%9b%a0-8">æ¼æ´æˆå› </a></li>
<li><a href="#%e9%80%82%e7%94%a8%e8%8c%83%e5%9b%b4-8">é€‚ç”¨èŒƒå›´</a></li>
<li><a href="#%e5%88%a9%e7%94%a8%e5%8e%9f%e7%90%86-8">åˆ©ç”¨åŸç†</a></li>
<li><a href="#%e7%9b%b8%e5%85%b3%e6%8a%80%e5%b7%a7-8">ç›¸å…³æŠ€å·§</a></li>
<li><a href="#%e5%88%a9%e7%94%a8%e6%95%88%e6%9e%9c-8">åˆ©ç”¨æ•ˆæœ</a></li>
</ul>
</li>
<li><a href="#210-house-of-husk">2.10-house of husk</a>
<ul>
<li><a href="#%e6%bc%8f%e6%b4%9e%e6%88%90%e5%9b%a0-9">æ¼æ´æˆå› </a></li>
<li><a href="#%e9%80%82%e7%94%a8%e8%8c%83%e5%9b%b4-9">é€‚ç”¨èŒƒå›´</a></li>
<li><a href="#%e5%88%a9%e7%94%a8%e5%8e%9f%e7%90%86-9">åˆ©ç”¨åŸç†</a></li>
<li><a href="#%e7%9b%b8%e5%85%b3%e6%8a%80%e5%b7%a7-9">ç›¸å…³æŠ€å·§</a></li>
<li><a href="#%e5%88%a9%e7%94%a8%e6%95%88%e6%9e%9c-9">åˆ©ç”¨æ•ˆæœ</a></li>
</ul>
</li>
<li><a href="#211-house-of-atum">2.11-house of atum</a>
<ul>
<li><a href="#%e6%bc%8f%e6%b4%9e%e6%88%90%e5%9b%a0-10">æ¼æ´æˆå› </a></li>
<li><a href="#%e9%80%82%e7%94%a8%e8%8c%83%e5%9b%b4-10">é€‚ç”¨èŒƒå›´</a></li>
<li><a href="#%e5%88%a9%e7%94%a8%e5%8e%9f%e7%90%86-10">åˆ©ç”¨åŸç†</a></li>
<li><a href="#%e7%9b%b8%e5%85%b3%e6%8a%80%e5%b7%a7-10">ç›¸å…³æŠ€å·§</a></li>
<li><a href="#%e5%88%a9%e7%94%a8%e6%95%88%e6%9e%9c-10">åˆ©ç”¨æ•ˆæœ</a></li>
</ul>
</li>
<li><a href="#212-house-of-kauri">2.12-house of kauri</a>
<ul>
<li><a href="#%e6%bc%8f%e6%b4%9e%e6%88%90%e5%9b%a0-11">æ¼æ´æˆå› </a></li>
<li><a href="#%e9%80%82%e7%94%a8%e8%8c%83%e5%9b%b4-11">é€‚ç”¨èŒƒå›´</a></li>
<li><a href="#%e5%88%a9%e7%94%a8%e5%8e%9f%e7%90%86-11">åˆ©ç”¨åŸç†</a></li>
<li><a href="#%e7%9b%b8%e5%85%b3%e6%8a%80%e5%b7%a7-11">ç›¸å…³æŠ€å·§</a></li>
<li><a href="#%e5%88%a9%e7%94%a8%e6%95%88%e6%9e%9c-11">åˆ©ç”¨æ•ˆæœ</a></li>
</ul>
</li>
<li><a href="#213-house-of-fun">2.13-house of fun</a>
<ul>
<li><a href="#%e6%bc%8f%e6%b4%9e%e6%88%90%e5%9b%a0-12">æ¼æ´æˆå› </a></li>
<li><a href="#%e9%80%82%e7%94%a8%e8%8c%83%e5%9b%b4-12">é€‚ç”¨èŒƒå›´</a></li>
<li><a href="#%e5%88%a9%e7%94%a8%e5%8e%9f%e7%90%86-12">åˆ©ç”¨åŸç†</a></li>
<li><a href="#%e7%9b%b8%e5%85%b3%e6%8a%80%e5%b7%a7-12">ç›¸å…³æŠ€å·§</a></li>
<li><a href="#%e5%88%a9%e7%94%a8%e6%95%88%e6%9e%9c-12">åˆ©ç”¨æ•ˆæœ</a></li>
</ul>
</li>
<li><a href="#214-house-of-mind">2.14-house of mind</a>
<ul>
<li><a href="#%e6%bc%8f%e6%b4%9e%e6%88%90%e5%9b%a0-13">æ¼æ´æˆå› </a></li>
<li><a href="#%e9%80%82%e7%94%a8%e8%8c%83%e5%9b%b4-13">é€‚ç”¨èŒƒå›´</a></li>
<li><a href="#%e5%88%a9%e7%94%a8%e5%8e%9f%e7%90%86-13">åˆ©ç”¨åŸç†</a></li>
<li><a href="#%e7%9b%b8%e5%85%b3%e6%8a%80%e5%b7%a7-13">ç›¸å…³æŠ€å·§</a></li>
<li><a href="#%e5%88%a9%e7%94%a8%e6%95%88%e6%9e%9c-13">åˆ©ç”¨æ•ˆæœ</a></li>
</ul>
</li>
<li><a href="#215-house-of-muney">2.15-house of muney</a>
<ul>
<li><a href="#%e6%bc%8f%e6%b4%9e%e6%88%90%e5%9b%a0-14">æ¼æ´æˆå› </a></li>
<li><a href="#%e9%80%82%e7%94%a8%e8%8c%83%e5%9b%b4-14">é€‚ç”¨èŒƒå›´</a></li>
<li><a href="#%e5%88%a9%e7%94%a8%e5%8e%9f%e7%90%86-14">åˆ©ç”¨åŸç†</a></li>
<li><a href="#%e7%9b%b8%e5%85%b3%e6%8a%80%e5%b7%a7-14">ç›¸å…³æŠ€å·§</a></li>
<li><a href="#%e5%88%a9%e7%94%a8%e6%95%88%e6%9e%9c-14">åˆ©ç”¨æ•ˆæœ</a></li>
</ul>
</li>
<li><a href="#216-house-of-botcake">2.16-house of botcake</a>
<ul>
<li><a href="#%e6%bc%8f%e6%b4%9e%e6%88%90%e5%9b%a0-15">æ¼æ´æˆå› </a></li>
<li><a href="#%e9%80%82%e7%94%a8%e8%8c%83%e5%9b%b4-15">é€‚ç”¨èŒƒå›´</a></li>
<li><a href="#%e5%88%a9%e7%94%a8%e5%8e%9f%e7%90%86-15">åˆ©ç”¨åŸç†</a></li>
<li><a href="#%e7%9b%b8%e5%85%b3%e6%8a%80%e5%b7%a7-15">ç›¸å…³æŠ€å·§</a></li>
<li><a href="#%e5%88%a9%e7%94%a8%e6%95%88%e6%9e%9c-15">åˆ©ç”¨æ•ˆæœ</a></li>
</ul>
</li>
<li><a href="#217-house-of-rust">2.17-house of rust</a>
<ul>
<li><a href="#%e6%bc%8f%e6%b4%9e%e6%88%90%e5%9b%a0-16">æ¼æ´æˆå› </a></li>
<li><a href="#%e9%80%82%e7%94%a8%e8%8c%83%e5%9b%b4-16">é€‚ç”¨èŒƒå›´</a></li>
<li><a href="#%e5%88%a9%e7%94%a8%e5%8e%9f%e7%90%86-16">åˆ©ç”¨åŸç†</a></li>
<li><a href="#%e7%9b%b8%e5%85%b3%e6%8a%80%e5%b7%a7-16">ç›¸å…³æŠ€å·§</a></li>
<li><a href="#%e5%88%a9%e7%94%a8%e6%95%88%e6%9e%9c-16">åˆ©ç”¨æ•ˆæœ</a></li>
</ul>
</li>
<li><a href="#218-house-of-crust">2.18-house of crust</a>
<ul>
<li><a href="#%e6%bc%8f%e6%b4%9e%e6%88%90%e5%9b%a0-17">æ¼æ´æˆå› </a></li>
<li><a href="#%e9%80%82%e7%94%a8%e8%8c%83%e5%9b%b4-17">é€‚ç”¨èŒƒå›´</a></li>
<li><a href="#%e5%88%a9%e7%94%a8%e5%8e%9f%e7%90%86-17">åˆ©ç”¨åŸç†</a></li>
<li><a href="#%e7%9b%b8%e5%85%b3%e6%8a%80%e5%b7%a7-17">ç›¸å…³æŠ€å·§</a></li>
</ul>
</li>
<li><a href="#219-house-of-io">2.19-house of io</a>
<ul>
<li><a href="#%e6%bc%8f%e6%b4%9e%e6%88%90%e5%9b%a0-18">æ¼æ´æˆå› </a></li>
<li><a href="#%e9%80%82%e7%94%a8%e8%8c%83%e5%9b%b4-18">é€‚ç”¨èŒƒå›´</a></li>
<li><a href="#%e5%88%a9%e7%94%a8%e5%8e%9f%e7%90%86-18">åˆ©ç”¨åŸç†</a></li>
<li><a href="#%e7%9b%b8%e5%85%b3%e6%8a%80%e5%b7%a7-18">ç›¸å…³æŠ€å·§</a></li>
<li><a href="#%e5%88%a9%e7%94%a8%e6%95%88%e6%9e%9c-17">åˆ©ç”¨æ•ˆæœ</a></li>
</ul>
</li>
<li><a href="#220-house-of-banana">2.20-house of banana</a>
<ul>
<li><a href="#%e6%bc%8f%e6%b4%9e%e6%88%90%e5%9b%a0-19">æ¼æ´æˆå› </a></li>
<li><a href="#%e9%80%82%e7%94%a8%e8%8c%83%e5%9b%b4-19">é€‚ç”¨èŒƒå›´</a></li>
<li><a href="#%e5%88%a9%e7%94%a8%e5%8e%9f%e7%90%86-19">åˆ©ç”¨åŸç†</a></li>
<li><a href="#%e7%9b%b8%e5%85%b3%e6%8a%80%e5%b7%a7-19">ç›¸å…³æŠ€å·§</a></li>
<li><a href="#%e5%88%a9%e7%94%a8%e6%95%88%e6%9e%9c-18">åˆ©ç”¨æ•ˆæœ</a></li>
</ul>
</li>
<li><a href="#221-house-of-kiwi">2.21-house of kiwi</a>
<ul>
<li><a href="#%e6%bc%8f%e6%b4%9e%e6%88%90%e5%9b%a0-20">æ¼æ´æˆå› </a></li>
<li><a href="#%e9%80%82%e7%94%a8%e8%8c%83%e5%9b%b4-20">é€‚ç”¨èŒƒå›´</a></li>
<li><a href="#%e5%88%a9%e7%94%a8%e5%8e%9f%e7%90%86-20">åˆ©ç”¨åŸç†</a></li>
<li><a href="#%e7%9b%b8%e5%85%b3%e6%8a%80%e5%b7%a7-20">ç›¸å…³æŠ€å·§</a></li>
<li><a href="#%e5%88%a9%e7%94%a8%e6%95%88%e6%9e%9c-19">åˆ©ç”¨æ•ˆæœ</a></li>
</ul>
</li>
<li><a href="#222-house-of-emma">2.22-house of emma</a>
<ul>
<li><a href="#%e6%bc%8f%e6%b4%9e%e6%88%90%e5%9b%a0-21">æ¼æ´æˆå› </a></li>
<li><a href="#%e9%80%82%e7%94%a8%e8%8c%83%e5%9b%b4-21">é€‚ç”¨èŒƒå›´</a></li>
<li><a href="#%e5%88%a9%e7%94%a8%e5%8e%9f%e7%90%86-21">åˆ©ç”¨åŸç†</a></li>
<li><a href="#%e7%9b%b8%e5%85%b3%e6%8a%80%e5%b7%a7-21">ç›¸å…³æŠ€å·§</a></li>
<li><a href="#%e5%88%a9%e7%94%a8%e6%95%88%e6%9e%9c-20">åˆ©ç”¨æ•ˆæœ</a></li>
</ul>
</li>
<li><a href="#223-house-of-pig">2.23-house of pig</a>
<ul>
<li><a href="#%e6%bc%8f%e6%b4%9e%e6%88%90%e5%9b%a0-22">æ¼æ´æˆå› </a></li>
<li><a href="#%e9%80%82%e7%94%a8%e8%8c%83%e5%9b%b4-22">é€‚ç”¨èŒƒå›´</a></li>
<li><a href="#%e5%88%a9%e7%94%a8%e5%8e%9f%e7%90%86-22">åˆ©ç”¨åŸç†</a></li>
<li><a href="#%e7%9b%b8%e5%85%b3%e6%8a%80%e5%b7%a7-22">ç›¸å…³æŠ€å·§</a></li>
<li><a href="#%e5%88%a9%e7%94%a8%e6%95%88%e6%9e%9c-21">åˆ©ç”¨æ•ˆæœ</a></li>
</ul>
</li>
<li><a href="#224-house-of-obstack">2.24-house of obstack</a>
<ul>
<li><a href="#%e6%bc%8f%e6%b4%9e%e6%88%90%e5%9b%a0-23">æ¼æ´æˆå› </a></li>
<li><a href="#%e9%80%82%e7%94%a8%e8%8c%83%e5%9b%b4-23">é€‚ç”¨èŒƒå›´</a></li>
<li><a href="#%e5%88%a9%e7%94%a8%e5%8e%9f%e7%90%86-23">åˆ©ç”¨åŸç†</a></li>
<li><a href="#%e7%9b%b8%e5%85%b3%e6%8a%80%e5%b7%a7-23">ç›¸å…³æŠ€å·§</a></li>
<li><a href="#%e5%88%a9%e7%94%a8%e6%95%88%e6%9e%9c-22">åˆ©ç”¨æ•ˆæœ</a></li>
</ul>
</li>
<li><a href="#225-house-of-apple1">2.25-house of apple1</a>
<ul>
<li><a href="#%e6%bc%8f%e6%b4%9e%e6%88%90%e5%9b%a0-24">æ¼æ´æˆå› </a></li>
<li><a href="#%e9%80%82%e7%94%a8%e8%8c%83%e5%9b%b4-24">é€‚ç”¨èŒƒå›´</a></li>
<li><a href="#%e5%88%a9%e7%94%a8%e5%8e%9f%e7%90%86-24">åˆ©ç”¨åŸç†</a></li>
<li><a href="#%e7%9b%b8%e5%85%b3%e6%8a%80%e5%b7%a7-24">ç›¸å…³æŠ€å·§</a></li>
<li><a href="#%e5%88%a9%e7%94%a8%e6%95%88%e6%9e%9c-23">åˆ©ç”¨æ•ˆæœ</a></li>
</ul>
</li>
<li><a href="#226-house-of-apple2">2.26-house of apple2</a>
<ul>
<li><a href="#%e6%bc%8f%e6%b4%9e%e6%88%90%e5%9b%a0-25">æ¼æ´æˆå› </a></li>
<li><a href="#%e9%80%82%e7%94%a8%e8%8c%83%e5%9b%b4-25">é€‚ç”¨èŒƒå›´</a></li>
<li><a href="#%e5%88%a9%e7%94%a8%e5%8e%9f%e7%90%86-25">åˆ©ç”¨åŸç†</a></li>
<li><a href="#%e7%9b%b8%e5%85%b3%e6%8a%80%e5%b7%a7-25">ç›¸å…³æŠ€å·§</a></li>
<li><a href="#%e5%88%a9%e7%94%a8%e6%95%88%e6%9e%9c-24">åˆ©ç”¨æ•ˆæœ</a></li>
</ul>
</li>
<li><a href="#227-house-of-apple3">2.27-house of apple3</a>
<ul>
<li><a href="#%e6%bc%8f%e6%b4%9e%e6%88%90%e5%9b%a0-26">æ¼æ´æˆå› </a></li>
<li><a href="#%e9%80%82%e7%94%a8%e8%8c%83%e5%9b%b4-26">é€‚ç”¨èŒƒå›´</a></li>
<li><a href="#%e5%88%a9%e7%94%a8%e5%8e%9f%e7%90%86-26">åˆ©ç”¨åŸç†</a></li>
<li><a href="#%e7%9b%b8%e5%85%b3%e6%8a%80%e5%b7%a7-26">ç›¸å…³æŠ€å·§</a></li>
<li><a href="#%e5%88%a9%e7%94%a8%e6%95%88%e6%9e%9c-25">åˆ©ç”¨æ•ˆæœ</a></li>
</ul>
</li>
<li><a href="#228-house-of-gods">2.28-house of gods</a>
<ul>
<li><a href="#%e6%bc%8f%e6%b4%9e%e6%88%90%e5%9b%a0-27">æ¼æ´æˆå› </a></li>
<li><a href="#%e9%80%82%e7%94%a8%e8%8c%83%e5%9b%b4-27">é€‚ç”¨èŒƒå›´</a></li>
<li><a href="#%e5%88%a9%e7%94%a8%e5%8e%9f%e7%90%86-27">åˆ©ç”¨åŸç†</a></li>
<li><a href="#%e7%9b%b8%e5%85%b3%e6%8a%80%e5%b7%a7-27">ç›¸å…³æŠ€å·§</a></li>
<li><a href="#%e5%88%a9%e7%94%a8%e6%95%88%e6%9e%9c-26">åˆ©ç”¨æ•ˆæœ</a></li>
</ul>
</li>
<li><a href="#229-house-of-lys">2.29-house of lys</a>
<ul>
<li><a href="#%e6%bc%8f%e6%b4%9e%e6%88%90%e5%9b%a0-28">æ¼æ´æˆå› </a></li>
<li><a href="#%e9%80%82%e7%94%a8%e8%8c%83%e5%9b%b4-28">é€‚ç”¨èŒƒå›´</a></li>
<li><a href="#%e5%88%a9%e7%94%a8%e5%8e%9f%e7%90%86-28">åˆ©ç”¨åŸç†</a></li>
<li><a href="#%e7%9b%b8%e5%85%b3%e6%8a%80%e5%b7%a7-28">ç›¸å…³æŠ€å·§</a></li>
<li><a href="#%e5%88%a9%e7%94%a8%e6%95%88%e6%9e%9c-27">åˆ©ç”¨æ•ˆæœ</a></li>
</ul>
</li>
<li><a href="#230-house-of-snake">2.30-house of snake</a></li>
</ul>
</li>
<li><a href="#3-%e6%80%bb%e7%bb%93">3-æ€»ç»“</a></li>
<li><a href="#4-%e5%8f%82%e8%80%83">4-å‚è€ƒ</a></li>
</ul>
<hr>
<p>å¯ä»¥åœ¨<a href="https://www.bilibili.com/video/BV1Js4y1N7kr"target="_blank" rel="external nofollow noopener noreferrer">Bilibili<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a>ä¸Šè§‚çœ‹è§†é¢‘è¿›è¡Œå­¦ä¹ ï¼š</p>
<div class="bilibili">
  <iframe src="//player.bilibili.com/player.html?bvid=BV1Js4y1N7kr&page=1&autoplay=false&poster=true&muted=false&danmaku=true&t=0" border="0" framespacing="0" allowfullscreen="true"></iframe>
</div>
<p>æˆ–è€…åœ¨<a href="https://www.youtube.com/watch?v=LpTo64Uy5vI"target="_blank" rel="external nofollow noopener noreferrer">Youtube<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a>ä¸Šè§‚çœ‹è§†é¢‘è¿›è¡Œå­¦ä¹ ï¼š</p>
<div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
      <iframe allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share; fullscreen" loading="eager" referrerpolicy="strict-origin-when-cross-origin" src="https://www.youtube-nocookie.com/embed/LpTo64Uy5vI?autoplay=0&amp;controls=1&amp;end=0&amp;loop=0&amp;mute=0&amp;start=0" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" title="YouTube video"></iframe>
    </div>

<hr>
<h2 class="heading-element" id="1-å‰è¨€"><span>1-å‰è¨€</span>
  <a href="#1-%e5%89%8d%e8%a8%80" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><p><code>Glibc</code>çš„<code>house of</code>ç³»åˆ—æ”»å‡»æ‰‹æ³•åŸºäºéƒ½æ˜¯å›´ç»•ç€å †åˆ©ç”¨å’Œ<code>IO FILE</code>åˆ©ç”¨ã€‚è¿˜æœ‰å¾ˆå¤šå †åˆ©ç”¨æ‰‹æ³•ä¹Ÿéå¸¸ç»å…¸ï¼Œä½†æ˜¯ç”±äºå…¶æ²¡æœ‰è¢«å† ä»¥<code>house of xxxx</code>ï¼Œæ•…æ²¡æœ‰æ”¶å½•åˆ°æœ¬æ–‡ä¸­ã€‚å¦‚æœæƒ³å­¦ä¹ æ‰€æœ‰çš„è¯¦ç»†çš„å †æ”»å‡»æ‰‹æ³•ï¼Œå¼ºçƒˆå»ºè®®<code>follow</code>ä»“åº“<a href="https://github.com/shellphish/how2heap"target="_blank" rel="external nofollow noopener noreferrer">how2heap<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a>è¿›è¡Œå­¦ä¹ ã€‚æˆ‘ç›¸ä¿¡ï¼Œåªè¦æŠŠ<code>how2heap</code>é‡Œé¢çš„æ¯ä¸€ä¸ªå †åˆ©ç”¨æ‰‹æ³•éƒ½å­¦æ‡‚å­¦é€äº†ï¼Œ<code>glibc</code>å †åˆ©ç”¨ä½ å°†å°½åœ¨æŒæ¡ã€‚</p>
<p>åœ¨å¼€å§‹ç³»åˆ—æ€»ç»“ä¹‹å‰ï¼Œæˆ‘ä¼šç»™å‡ºä¸€ä¸ªè¡¨æ ¼ï¼Œè¡¨æ ¼é‡Œé¢åˆ†åˆ«æ˜¯<code>house of xxxx</code>å’Œå¯¹åº”çš„ä¼˜ç§€çš„è§£ææ–‡ç« ï¼Œåœ¨æ­¤éå¸¸æ„Ÿè°¢å„ä½å¸ˆå‚…ä»¬çš„æ€»ç»“ã€‚å¦‚æœä½ åœ¨é˜…è¯»æœ¬æ–‡çš„è¿‡ç¨‹ä¸­æƒ³å®Œæ•´åœ°æŸ¥çœ‹æŸä¸€ä¸ªæ‰‹æ³•åœ°è¯¦ç»†åˆ©ç”¨è¿‡ç¨‹ï¼Œé‚£ä¹ˆå¯ä»¥ç›´æ¥å›åˆ°è¡¨æ ¼ï¼Œç‚¹å‡»å¯¹åº”çš„é“¾æ¥è¿›è¡Œå­¦ä¹ ã€‚ç›®å‰çš„æœ€æ–°ç‰ˆæœ¬ä¸º<code>2.37</code>ï¼Œä½†æ˜¯ï¼Œç›®å‰çš„<code>ubuntu:23.04</code>è¿˜æ²¡å¼€å§‹ç”¨<code>glibc-2.37</code>ï¼Œä½¿ç”¨çš„ä»ç„¶æ˜¯<code>glibc-2.36</code>ã€‚</p>
<p>å¦‚æœè¿˜æœ‰å“ªäº›<code>house of xxxx</code>çš„åˆ©ç”¨æ‰‹æ³•æ²¡æœ‰æ”¶å½•è¿›æ¥ï¼Œæˆ–ä½ å¯¹æœ¬æ–‡å­˜æœ‰ä¸€äº›ç–‘é—®ï¼Œæˆ–è€…ä½ å‘ç°æœ¬æ–‡æŸäº›å†…å®¹ç¼–å†™é”™è¯¯ï¼Œè¿˜è¯·ç•™è¨€æŒ‡æ­£ã€‚</p>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œé™¤äº†å…³æ³¨å„ç§<code>house of</code>åˆ©ç”¨æŠ€å·§æœ¬èº«ï¼Œæ›´é‡è¦çš„æ˜¯ï¼Œéœ€è¦å…³æ³¨è¯¥åˆ©ç”¨æŠ€å·§èƒŒåçš„æ€æƒ³å’ŒåŸç†ã€‚å¦‚æœä½ èƒ½ä»è¿™ä¸€ç³»åˆ—çš„åˆ©ç”¨æ‰‹æ³•ä¸­æç‚¼å‡ºä¸€äº›é€šç”¨çš„æ”»å‡»å‘é‡æˆ–è€…æ”»å‡»æ€æƒ³ï¼Œæ—¥ååœ¨é¢å¯¹å…¶ä»–çš„åœºæ™¯ï¼Œä½ ä¹Ÿèƒ½æ›´å¿«çš„æ‰¾åˆ°ç³»ç»Ÿçš„æ¼æ´ç‚¹å¹¶åŠ ä»¥åˆ©ç”¨ã€‚å­¦ä¹ <code>glibc</code>å †åˆ©ç”¨æ›´å¤šçš„æ˜¯ä¸ºäº†ä¸¾ä¸€åä¸‰ï¼Œä¸ºäº†æ›´å¥½åœ°æŒæ¡æ¼æ´æŒ–æ˜æ¨¡å¼ã€æ¼æ´åˆ†ææ–¹æ³•ï¼Œè€Œä¸ä»…ä»…æ˜¯ä¸ºäº†æ¯”èµ›ã€‚</p>
<p><code>house of</code>ç³»åˆ—çš„è¡¨æ ¼å¦‚ä¸‹ï¼Œé€‚ç”¨ç‰ˆæœ¬ä¸è€ƒè™‘ä½äº<code>glibc-2.23</code>çš„ç‰ˆæœ¬ã€‚æˆ‘å°†åœ¨ä¸‹æ–‡ä¸­è¿›ä¸€æ­¥é˜è¿°æ¯ä¸€ä¸ªåˆ©ç”¨æ‰‹æ³•çš„åŸç†ã€ä½¿ç”¨åœºæ™¯ä¸é€‚ç”¨èŒƒå›´ã€‚</p>
<table>
  <thead>
      <tr>
          <th>æ”»å‡»æ–¹æ³•</th>
          <th>å½±å“èŒƒå›´</th>
          <th>å­¦ä¹ é“¾æ¥</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>house of spirit</td>
          <td>2.23â€”â€”è‡³ä»Š</td>
          <td><a href="https://www.anquanke.com/post/id/244158"target="_blank" rel="external nofollow noopener noreferrer">å †åˆ©ç”¨ç³»åˆ—ä¹‹house of spirit-å®‰å…¨å®¢ - å®‰å…¨èµ„è®¯å¹³å° (anquanke.com)<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a></td>
      </tr>
      <tr>
          <td>house of einherjar</td>
          <td>2.23â€”â€”è‡³ä»Š</td>
          <td><a href="https://www.anquanke.com/post/id/251596"target="_blank" rel="external nofollow noopener noreferrer">PWNâ€”â€”House Of Einherjar CTF Wikiä¾‹é¢˜è¯¦è§£-å®‰å…¨å®¢ - å®‰å…¨èµ„è®¯å¹³å° (anquanke.com)<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a></td>
      </tr>
      <tr>
          <td>house of force</td>
          <td>2.23â€”â€”2.29</td>
          <td><a href="https://www.anquanke.com/post/id/175630"target="_blank" rel="external nofollow noopener noreferrer">Top chunkåŠ«æŒï¼šHouse of forceæ”»å‡»-å®‰å…¨å®¢ - å®‰å…¨èµ„è®¯å¹³å° (anquanke.com)<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a></td>
      </tr>
      <tr>
          <td>house of lore</td>
          <td>2.23â€”â€”è‡³ä»Š</td>
          <td><a href="https://ctf-wiki.org/pwn/linux/user-mode/heap/ptmalloc2/house-of-lore/"target="_blank" rel="external nofollow noopener noreferrer">House of Lore - CTF Wiki (ctf-wiki.org)<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a></td>
      </tr>
      <tr>
          <td>house of orange</td>
          <td>2.23â€”â€”2.26</td>
          <td><a href="https://www.anquanke.com/post/id/218887"target="_blank" rel="external nofollow noopener noreferrer">House of orange-å®‰å…¨å®¢ - å®‰å…¨èµ„è®¯å¹³å° (anquanke.com)<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a></td>
      </tr>
      <tr>
          <td>house of rabbit</td>
          <td>2.23â€”â€”2.28</td>
          <td><a href="http://p4nda.top/2018/04/18/house-of-rabbit/"target="_blank" rel="external nofollow noopener noreferrer">http://p4nda.top/2018/04/18/house-of-rabbit/<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a></td>
      </tr>
      <tr>
          <td>house of roman</td>
          <td>2.23â€”â€”2.29</td>
          <td><a href="https://ctf-wiki.org/pwn/linux/user-mode/heap/ptmalloc2/house-of-roman/"target="_blank" rel="external nofollow noopener noreferrer">House of Roman - CTF Wiki (ctf-wiki.org)<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a></td>
      </tr>
      <tr>
          <td>house of storm</td>
          <td>2.23â€”â€”2.29</td>
          <td><a href="https://www.anquanke.com/post/id/203096"target="_blank" rel="external nofollow noopener noreferrer">House of storm åŸç†åŠåˆ©ç”¨-å®‰å…¨å®¢ - å®‰å…¨èµ„è®¯å¹³å° (anquanke.com)<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a></td>
      </tr>
      <tr>
          <td>house of corrosion</td>
          <td>2.23â€”â€”è‡³ä»Š</td>
          <td><a href="https://xz.aliyun.com/t/6862#toc-5"target="_blank" rel="external nofollow noopener noreferrer">House-of-Corrosion ä¸€ç§æ–°çš„å †åˆ©ç”¨æŠ€å·§ - å…ˆçŸ¥ç¤¾åŒº (aliyun.com)<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a></td>
      </tr>
      <tr>
          <td>house of husk</td>
          <td>2.23â€”â€”è‡³ä»Š</td>
          <td><a href="https://www.anquanke.com/post/id/202387"target="_blank" rel="external nofollow noopener noreferrer">house-of-huskå­¦ä¹ ç¬”è®°-å®‰å…¨å®¢ - å®‰å…¨èµ„è®¯å¹³å° (anquanke.com)<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a></td>
      </tr>
      <tr>
          <td>house of atum</td>
          <td>2.26â€”â€”2.30</td>
          <td><a href="https://abf1ag.github.io/2021/06/11/house-of-atum/"target="_blank" rel="external nofollow noopener noreferrer">https://abf1ag.github.io/2021/06/11/house-of-atum/<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a></td>
      </tr>
      <tr>
          <td>house of kauri</td>
          <td>2.26â€”â€”2.32</td>
          <td><a href="https://0x434b.dev/overview-of-glibc-heap-exploitation-techniques/#house-of-kauri"target="_blank" rel="external nofollow noopener noreferrer">Overview of GLIBC heap exploitation techniques (0x434b.dev)<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a></td>
      </tr>
      <tr>
          <td>house of fun</td>
          <td>2.23â€”â€”2.30</td>
          <td><a href="https://0x434b.dev/overview-of-glibc-heap-exploitation-techniques/#house-of-fun"target="_blank" rel="external nofollow noopener noreferrer">Overview of GLIBC heap exploitation techniques (0x434b.dev)<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a></td>
      </tr>
      <tr>
          <td>house of mind</td>
          <td>2.23â€”â€”è‡³ä»Š</td>
          <td><a href="https://github.com/shellphish/how2heap/blob/master/glibc_2.35/house_of_mind_fastbin.c"target="_blank" rel="external nofollow noopener noreferrer">how2heap/house_of_mind_fastbin.c at master Â· shellphish/how2heap (github.com)<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a></td>
      </tr>
      <tr>
          <td>house of muney</td>
          <td>2.23â€”â€”è‡³ä»Š</td>
          <td><a href="https://www.anquanke.com/post/id/254797"target="_blank" rel="external nofollow noopener noreferrer">House of Muney åˆ†æ-å®‰å…¨å®¢ - å®‰å…¨èµ„è®¯å¹³å° (anquanke.com)<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a></td>
      </tr>
      <tr>
          <td>house of botcake</td>
          <td>2.23â€”â€”è‡³ä»Š</td>
          <td><a href="https://forum.butian.net/share/1709"target="_blank" rel="external nofollow noopener noreferrer">å¥‡å®‰ä¿¡æ”»é˜²ç¤¾åŒº-æ·±å…¥ç†è§£ House of Botcake å †åˆ©ç”¨æ‰‹æ³• (butian.net)<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a></td>
      </tr>
      <tr>
          <td>house of rust</td>
          <td>2.26â€”â€”è‡³ä»Š</td>
          <td><a href="https://github.com/c4ebt/House-of-Rust"target="_blank" rel="external nofollow noopener noreferrer">c4ebt/House-of-Rust<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a></td>
      </tr>
      <tr>
          <td>house of crust</td>
          <td>2.26â€”â€”2.37</td>
          <td><a href="https://github.com/c4ebt/House-of-Rust"target="_blank" rel="external nofollow noopener noreferrer">c4ebt/House-of-Rust<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a></td>
      </tr>
      <tr>
          <td>house of io</td>
          <td>2.26â€”â€”è‡³ä»Š</td>
          <td><a href="https://0x434b.dev/overview-of-glibc-heap-exploitation-techniques/#house-of-io"target="_blank" rel="external nofollow noopener noreferrer">Overview of GLIBC heap exploitation techniques (0x434b.dev)<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a></td>
      </tr>
      <tr>
          <td>house of banana</td>
          <td>2.23â€”â€”è‡³ä»Š</td>
          <td><a href="https://www.anquanke.com/post/id/222948"target="_blank" rel="external nofollow noopener noreferrer">house of banana-å®‰å…¨å®¢ - å®‰å…¨èµ„è®¯å¹³å° (anquanke.com)<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a></td>
      </tr>
      <tr>
          <td>house of kiwi</td>
          <td>2.23â€”â€”2.36</td>
          <td><a href="https://www.anquanke.com/post/id/235598"target="_blank" rel="external nofollow noopener noreferrer">House OF Kiwi-å®‰å…¨å®¢ - å®‰å…¨èµ„è®¯å¹³å° (anquanke.com)<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a></td>
      </tr>
      <tr>
          <td>house of emma</td>
          <td>2.23â€”â€”è‡³ä»Š</td>
          <td><a href="https://www.anquanke.com/post/id/260614"target="_blank" rel="external nofollow noopener noreferrer">house of emma<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a></td>
      </tr>
      <tr>
          <td>house of pig</td>
          <td>2.23â€”â€”è‡³ä»Š</td>
          <td><a href="https://www.anquanke.com/post/id/242640"target="_blank" rel="external nofollow noopener noreferrer">house of pigä¸€ä¸ªæ–°çš„å †åˆ©ç”¨è¯¦è§£-å®‰å…¨å®¢ - å®‰å…¨èµ„è®¯å¹³å° (anquanke.com)<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a></td>
      </tr>
      <tr>
          <td>house of obstack</td>
          <td>2.23â€”â€”è‡³ä»Š</td>
          <td><a href="https://tttang.com/archive/1845/"target="_blank" rel="external nofollow noopener noreferrer">ä¸€æ¡æ–°çš„glibc IO_FILEåˆ©ç”¨é“¾ï¼š_IO_obstack_jumpsåˆ©ç”¨åˆ†æ - è·³è·³ç³– (tttang.com)<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a></td>
      </tr>
      <tr>
          <td>house of apple1</td>
          <td>2.23â€”â€”è‡³ä»Š</td>
          <td><a href="https://roderickchan.github.io/zh-cn/house-of-apple-%e4%b8%80%e7%a7%8d%e6%96%b0%e7%9a%84glibc%e4%b8%adio%e6%94%bb%e5%87%bb%e6%96%b9%e6%b3%95-1/"target="_blank" rel="external nofollow noopener noreferrer">House of Apple ä¸€ç§æ–°çš„glibcä¸­IOæ”»å‡»æ–¹æ³• (1) - roderick - record and learn! (roderickchan.cn)<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a></td>
      </tr>
      <tr>
          <td>house of apple2</td>
          <td>2.23â€”â€”è‡³ä»Š</td>
          <td><a href="https://roderickchan.github.io/zh-cn/house-of-apple-%e4%b8%80%e7%a7%8d%e6%96%b0%e7%9a%84glibc%e4%b8%adio%e6%94%bb%e5%87%bb%e6%96%b9%e6%b3%95-2/"target="_blank" rel="external nofollow noopener noreferrer">House of Apple ä¸€ç§æ–°çš„glibcä¸­IOæ”»å‡»æ–¹æ³• (2) - roderick - record and learn! (roderickchan.cn)<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a></td>
      </tr>
      <tr>
          <td>house of apple3</td>
          <td>2.23â€”â€”è‡³ä»Š</td>
          <td><a href="https://roderickchan.github.io/zh-cn/house-of-apple-%e4%b8%80%e7%a7%8d%e6%96%b0%e7%9a%84glibc%e4%b8%adio%e6%94%bb%e5%87%bb%e6%96%b9%e6%b3%95-3/"target="_blank" rel="external nofollow noopener noreferrer">House of Apple ä¸€ç§æ–°çš„glibcä¸­IOæ”»å‡»æ–¹æ³• (3) - roderick - record and learn! (roderickchan.cn)<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a></td>
      </tr>
      <tr>
          <td>house of gods</td>
          <td>2.23â€”â€”2.27</td>
          <td><a href="https://github.com/Milo-D/house-of-gods/blob/master/rev2/HOUSE_OF_GODS.TXT"target="_blank" rel="external nofollow noopener noreferrer">house-of-gods/HOUSE_OF_GODS.TXT at master Â· Milo-D/house-of-gods (github.com)<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a></td>
      </tr>
      <tr>
          <td>house of lys</td>
          <td>2.23â€”â€”è‡³ä»Š</td>
          <td><a href="https://nasm.re/posts/babyfile/"target="_blank" rel="external nofollow noopener noreferrer">[SECCON CTF 2022 Quals] babyfile | repr<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a>æˆ–è€…<a href="https://www.cnblogs.com/7resp4ss/p/17486261.html"target="_blank" rel="external nofollow noopener noreferrer">ä¸€æ¡æ–°çš„glibc IO_FILEåˆ©ç”¨é“¾ï¼š_IO_obstack_jumpsåˆ©ç”¨åˆ†æ - 7resp4ss - åšå®¢å›­<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a></td>
      </tr>
      <tr>
          <td>house of snake</td>
          <td>2.23â€”â€”è‡³ä»Š</td>
          <td><a href="https://www.cnblogs.com/7resp4ss/p/17300224.html"target="_blank" rel="external nofollow noopener noreferrer">house of snakeï¼šä¸€æ¡é«˜ç‰ˆæœ¬Glibc IOè°ƒç”¨é“¾ - 7resp4ss - åšå®¢å›­<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a></td>
      </tr>
  </tbody>
</table>
<p>æ­¤å¤–ï¼Œé˜…è¯»ä¸‹æ–‡ä¹‹å‰éœ€è¦äº†è§£ï¼š</p>
<ul>
<li>ä¸‹é¢æ‰€è¿°çš„<code>chunk A</code>ï¼Œåœ°å€<code>A</code>æŒ‡çš„æ˜¯<code>chunk header</code>åœ°å€ï¼Œè€Œä¸æ˜¯<code>user data</code>åœ°å€ã€‚</li>
<li>æ¼æ´æˆå› åŸºæœ¬ä¸Šéƒ½æ˜¯å †æº¢å‡ºã€<code>UAF</code>ç­‰</li>
</ul>
<h2 class="heading-element" id="2-house-ofç³»åˆ—"><span>2-House Ofç³»åˆ—</span>
  <a href="#2-house-of%e7%b3%bb%e5%88%97" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><h2 class="heading-element" id="21-house-of-spirit"><span>2.1-House of Spirit</span>
  <a href="#21-house-of-spirit" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><h3 class="heading-element" id="æ¼æ´æˆå› "><span>æ¼æ´æˆå› </span>
  <a href="#%e6%bc%8f%e6%b4%9e%e6%88%90%e5%9b%a0" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p>å †æº¢å‡ºå†™</p>
<h3 class="heading-element" id="é€‚ç”¨èŒƒå›´"><span>é€‚ç”¨èŒƒå›´</span>
  <a href="#%e9%80%82%e7%94%a8%e8%8c%83%e5%9b%b4" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><ul>
<li><code>2.23</code>â€”â€”è‡³ä»Š</li>
</ul>
<h3 class="heading-element" id="åˆ©ç”¨åŸç†"><span>åˆ©ç”¨åŸç†</span>
  <a href="#%e5%88%a9%e7%94%a8%e5%8e%9f%e7%90%86" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p>åˆ©ç”¨å †æº¢å‡ºï¼Œä¿®æ”¹<code>chunk size</code>ï¼Œä¼ªé€ å‡º<code>fake chunk</code>ï¼Œç„¶åé€šè¿‡å †çš„é‡Šæ”¾å’Œæ’å¸ƒï¼Œæ§åˆ¶<code>fake chunk</code>ã€‚<code>house of spirit</code>çš„æ“ä½œæ€è·¯æœ‰å¾ˆå¤šï¼Œæ¯”å¦‚å¯ä»¥æŒ‰å¦‚ä¸‹æ“ä½œè¿›è¡Œåˆ©ç”¨ï¼š</p>
<ul>
<li>ç”³è¯·<code>chunk Aã€chunk Bã€chunk Cã€chunk D</code></li>
<li>å¯¹<code>A</code>å†™æ“ä½œçš„æ—¶å€™æº¢å‡ºï¼Œä¿®æ”¹<code>B</code>çš„<code>size</code>åŸŸï¼Œä½¿å…¶èƒ½åŒ…æ‹¬<code>chunk C</code></li>
<li>é‡Šæ”¾<code>B</code>ï¼Œç„¶åæŠŠ<code>B</code>ç”³è¯·å›æ¥ï¼Œå†é‡Šæ”¾<code>C</code>ï¼Œåˆ™å¯ä»¥é€šè¿‡è¯»å†™<code>B</code>æ¥æ§åˆ¶<code>C</code>çš„å†…å®¹</li>
</ul>
<h3 class="heading-element" id="ç›¸å…³æŠ€å·§"><span>ç›¸å…³æŠ€å·§</span>
  <a href="#%e7%9b%b8%e5%85%b3%e6%8a%80%e5%b7%a7" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p>èµ·åˆ<code>house of spirit</code>ä¸»è¦æ˜¯é’ˆå¯¹<code>fastbin</code>ï¼Œåæ¥å¼•å…¥äº†<code>tcachebin</code>åï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨<code>tcachebin</code>ç‰ˆæœ¬çš„<code>house of spirit</code>ã€‚åˆ©ç”¨æ–¹æ³•ä¸<code>fastbin</code>åœºæ™¯ä¸‹ç±»ä¼¼ï¼Œæ³¨æ„å¥½ä¸åŒç‰ˆæœ¬ä¸‹çš„æ£€æŸ¥æ¡ä»¶å³å¯ã€‚</p>
<h3 class="heading-element" id="åˆ©ç”¨æ•ˆæœ"><span>åˆ©ç”¨æ•ˆæœ</span>
  <a href="#%e5%88%a9%e7%94%a8%e6%95%88%e6%9e%9c" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><ul>
<li>åŠ«æŒ<code>fastbin/tcachebin</code>çš„<code>fd</code>ä¹‹åï¼Œå¯ä»¥ä»»æ„åœ°å€åˆ†é…ã€ä»»æ„åœ°å€è¯»å†™</li>
</ul>
<h2 class="heading-element" id="22-house-of-einherjar"><span>2.2-House of Einherjar</span>
  <a href="#22-house-of-einherjar" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><h3 class="heading-element" id="æ¼æ´æˆå› -1"><span>æ¼æ´æˆå› </span>
  <a href="#%e6%bc%8f%e6%b4%9e%e6%88%90%e5%9b%a0-1" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p>æº¢å‡ºå†™ã€<code>off by one</code>ã€<code>off by null</code></p>
<h3 class="heading-element" id="é€‚ç”¨èŒƒå›´-1"><span>é€‚ç”¨èŒƒå›´</span>
  <a href="#%e9%80%82%e7%94%a8%e8%8c%83%e5%9b%b4-1" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><ul>
<li><code>2.23</code>â€”â€”è‡³ä»Š</li>
<li>å¯åˆ†é…å¤§äºå¤„äº<code>unsortedbin</code>çš„<code>chunk</code></li>
</ul>
<h3 class="heading-element" id="åˆ©ç”¨åŸç†-1"><span>åˆ©ç”¨åŸç†</span>
  <a href="#%e5%88%a9%e7%94%a8%e5%8e%9f%e7%90%86-1" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p>åˆ©ç”¨<code>off by null</code>ä¿®æ”¹æ‰<code>chunk</code>çš„<code>size</code>åŸŸçš„<code>P</code>ä½ï¼Œç»•è¿‡<code>unlink</code>æ£€æŸ¥ï¼Œåœ¨å †çš„åå‘åˆå¹¶è¿‡ç¨‹ä¸­æ„é€ å‡º<code>chunk overlapping</code>ã€‚</p>
<ul>
<li>ç”³è¯·<code>chunk Aã€chunk Bã€chunk Cã€chunk D</code>ï¼Œ<code>chunk D</code>ç”¨æ¥åš<code>gap</code>ï¼Œ<code>chunk Aã€chunk C</code>éƒ½è¦å¤„äº<code>unsortedbin</code>èŒƒå›´</li>
<li>é‡Šæ”¾<code>A</code>ï¼Œè¿›å…¥<code>unsortedbin</code></li>
<li>å¯¹<code>B</code>å†™æ“ä½œçš„æ—¶å€™å­˜åœ¨<code>off by null</code>ï¼Œä¿®æ”¹äº†<code>C</code>çš„<code>P</code>ä½</li>
<li>é‡Šæ”¾<code>C</code>çš„æ—¶å€™ï¼Œå †åå‘åˆå¹¶ï¼Œç›´æ¥æŠŠ<code>Aã€Bã€C</code>ä¸‰å—å†…å­˜åˆå¹¶ä¸ºäº†ä¸€ä¸ª<code>chunk</code>ï¼Œå¹¶æ”¾åˆ°äº†<code>unsortedbin</code>é‡Œé¢</li>
<li>è¯»å†™åˆå¹¶åçš„å¤§<code>chunk</code>å¯ä»¥æ“ä½œ<code>chunk B</code>çš„å†…å®¹ï¼Œ<code>chunk B</code>çš„å¤´</li>
</ul>
<h3 class="heading-element" id="ç›¸å…³æŠ€å·§-1"><span>ç›¸å…³æŠ€å·§</span>
  <a href="#%e7%9b%b8%e5%85%b3%e6%8a%80%e5%b7%a7-1" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p>è™½ç„¶è¯¥åˆ©ç”¨æŠ€å·§è‡³ä»Šä»å¯ä»¥åˆ©ç”¨ï¼Œä½†æ˜¯éœ€è¦å¯¹<code>unlink</code>ç»•è¿‡çš„æ¡ä»¶éšç€ç‰ˆæœ¬çš„å¢åŠ æœ‰æ‰€å˜åŒ–ã€‚</p>
<p>æœ€å¼€å§‹çš„<code>unlink</code>çš„ä»£ç æ˜¯ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="cm">/* Take a chunk off a bin list */</span>
</span></span><span class="line"><span class="cl"><span class="cp">#define unlink(AV, P, BK, FD) {                                            \
</span></span></span><span class="line"><span class="cl"><span class="cp">    FD = P-&gt;fd;								      \
</span></span></span><span class="line"><span class="cl"><span class="cp">    BK = P-&gt;bk;								      \
</span></span></span><span class="line"><span class="cl"><span class="cp">    if (__builtin_expect (FD-&gt;bk != P || BK-&gt;fd != P, 0))		      \
</span></span></span><span class="line"><span class="cl"><span class="cp">      malloc_printerr (check_action, &#34;corrupted double-linked list&#34;, P, AV);  \
</span></span></span><span class="line"><span class="cl"><span class="cp">    else {								      \
</span></span></span><span class="line"><span class="cl"><span class="cp">		</span><span class="c1">// .....							      \
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="p">}</span>									      \
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><p>åªéœ€è¦ç»•è¿‡<code>__builtin_expect (FD-&gt;bk != P || BK-&gt;fd != P, 0)</code>å³å¯ï¼Œå› æ­¤ï¼Œä¸éœ€è¦ä¼ªé€ åœ°å€å¤„äºé«˜ä½çš„<code>chunk</code>çš„<code>presize</code>åŸŸã€‚</p>
<p>é«˜ç‰ˆæœ¬çš„<code>unlink</code>çš„æ¡ä»¶æ˜¯ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="cm">/* Take a chunk off a bin list.  */</span>
</span></span><span class="line"><span class="cl"><span class="k">static</span> <span class="kt">void</span>
</span></span><span class="line"><span class="cl"><span class="nf">unlink_chunk</span> <span class="p">(</span><span class="n">mstate</span> <span class="n">av</span><span class="p">,</span> <span class="n">mchunkptr</span> <span class="n">p</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="nf">chunksize</span> <span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="o">!=</span> <span class="nf">prev_size</span> <span class="p">(</span><span class="nf">next_chunk</span> <span class="p">(</span><span class="n">p</span><span class="p">)))</span>
</span></span><span class="line"><span class="cl">    <span class="nf">malloc_printerr</span> <span class="p">(</span><span class="s">&#34;corrupted size vs. prev_size&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">mchunkptr</span> <span class="n">fd</span> <span class="o">=</span> <span class="n">p</span><span class="o">-&gt;</span><span class="n">fd</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">mchunkptr</span> <span class="n">bk</span> <span class="o">=</span> <span class="n">p</span><span class="o">-&gt;</span><span class="n">bk</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="nf">__builtin_expect</span> <span class="p">(</span><span class="n">fd</span><span class="o">-&gt;</span><span class="n">bk</span> <span class="o">!=</span> <span class="n">p</span> <span class="o">||</span> <span class="n">bk</span><span class="o">-&gt;</span><span class="n">fd</span> <span class="o">!=</span> <span class="n">p</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="nf">malloc_printerr</span> <span class="p">(</span><span class="s">&#34;corrupted double-linked list&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="c1">// ......
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><p>æ–°å¢äº†<code>chunksize (p) != prev_size (next_chunk (p))</code>ï¼Œå¯¹<code>chunksize</code>æœ‰äº†æ£€æŸ¥ï¼Œä¼ªé€ çš„æ—¶å€™éœ€è¦ç»•è¿‡ã€‚</p>
<h3 class="heading-element" id="åˆ©ç”¨æ•ˆæœ-1"><span>åˆ©ç”¨æ•ˆæœ</span>
  <a href="#%e5%88%a9%e7%94%a8%e6%95%88%e6%9e%9c-1" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><ul>
<li>æ„é€ <code>chunk overlap</code>åï¼Œå¯ä»¥ä»»æ„åœ°å€åˆ†é…</li>
<li>ç»“åˆå…¶ä»–æ–¹æ³•è¿›è¡Œä»»æ„åœ°å€è¯»å†™</li>
</ul>
<h2 class="heading-element" id="23-house-of-force"><span>2.3-House of Force</span>
  <a href="#23-house-of-force" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><h3 class="heading-element" id="æ¼æ´æˆå› -2"><span>æ¼æ´æˆå› </span>
  <a href="#%e6%bc%8f%e6%b4%9e%e6%88%90%e5%9b%a0-2" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p>å †æº¢å‡ºå†™<code>top_chunk</code></p>
<h3 class="heading-element" id="é€‚ç”¨èŒƒå›´-2"><span>é€‚ç”¨èŒƒå›´</span>
  <a href="#%e9%80%82%e7%94%a8%e8%8c%83%e5%9b%b4-2" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><ul>
<li><code>2.23</code>â€”â€”<code>2.29</code></li>
<li>å¯åˆ†é…ä»»æ„å¤§å°çš„<code>chunk</code></li>
<li>éœ€è¦æ³„éœ²æˆ–å·²çŸ¥åœ°å€</li>
</ul>
<h3 class="heading-element" id="åˆ©ç”¨åŸç†-2"><span>åˆ©ç”¨åŸç†</span>
  <a href="#%e5%88%a9%e7%94%a8%e5%8e%9f%e7%90%86-2" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p>å¯¹<code>top_chunk</code>çš„åˆ©ç”¨ï¼Œè¿‡ç¨‹å¦‚ä¸‹ï¼š</p>
<ul>
<li>ç”³è¯·<code>chunk A</code></li>
<li>å†™<code>A</code>çš„æ—¶å€™æº¢å‡ºï¼Œä¿®æ”¹<code>top_chunk</code>çš„<code>size</code>ä¸ºå¾ˆå¤§çš„æ•°</li>
<li>åˆ†é…å¾ˆå¤§çš„<code>chunk</code>åˆ°ä»»æ„å·²çŸ¥åœ°å€</li>
</ul>
<h3 class="heading-element" id="ç›¸å…³æŠ€å·§-2"><span>ç›¸å…³æŠ€å·§</span>
  <a href="#%e7%9b%b8%e5%85%b3%e6%8a%80%e5%b7%a7-2" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p>æ³¨æ„ï¼Œåœ¨<code>glibc-2.29</code>ååŠ å…¥äº†æ£€æµ‹ï¼Œ<code>house of force</code>åŸºæœ¬å¤±æ•ˆï¼š</p>
<p><img loading="lazy" src='https://image.roderickchan.cn/img/image-20230303194137930.png' alt="image-20230303194137930"></p>
<h3 class="heading-element" id="åˆ©ç”¨æ•ˆæœ-2"><span>åˆ©ç”¨æ•ˆæœ</span>
  <a href="#%e5%88%a9%e7%94%a8%e6%95%88%e6%9e%9c-2" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><ul>
<li>ä»»æ„åœ°å€åˆ†é…</li>
<li>ä»»æ„åœ°å€è¯»å†™</li>
</ul>
<h2 class="heading-element" id="24-house-of-lore"><span>2.4-House of Lore</span>
  <a href="#24-house-of-lore" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><h3 class="heading-element" id="æ¼æ´æˆå› -3"><span>æ¼æ´æˆå› </span>
  <a href="#%e6%bc%8f%e6%b4%9e%e6%88%90%e5%9b%a0-3" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p>å †æº¢å‡ºã€<code>use after free</code>ã€<code>edit after free</code></p>
<h3 class="heading-element" id="é€‚ç”¨èŒƒå›´-3"><span>é€‚ç”¨èŒƒå›´</span>
  <a href="#%e9%80%82%e7%94%a8%e8%8c%83%e5%9b%b4-3" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><ul>
<li><code>2.23</code>â€”â€”è‡³ä»Š</li>
<li>éœ€è¦æ³„éœ²æˆ–å·²çŸ¥åœ°å€</li>
</ul>
<h3 class="heading-element" id="åˆ©ç”¨åŸç†-3"><span>åˆ©ç”¨åŸç†</span>
  <a href="#%e5%88%a9%e7%94%a8%e5%8e%9f%e7%90%86-3" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p>æ§åˆ¶<code>smallbin</code>çš„<code>bk</code>æŒ‡é’ˆï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š</p>
<ul>
<li>ç”³è¯·<code>chunk Aã€chunk Bã€chunk C</code>ï¼Œå…¶ä¸­<code>chunk B</code>å¤§å°ä½äº<code>smallbin</code></li>
<li>é‡Šæ”¾<code>B</code>ï¼Œç”³è¯·æ›´å¤§çš„<code>chunk D</code>ï¼Œä½¿å¾—<code>B</code>è¿›å…¥<code>smallbin</code></li>
<li>å†™<code>A</code>ï¼Œæº¢å‡ºä¿®æ”¹<code>B</code>çš„<code>bk</code>ï¼ŒæŒ‡å‘åœ°å€<code>X</code>ï¼Œè¿™é‡Œæœ‰<code>fake chunk</code></li>
<li>å¸ƒç½®<code>X-&gt;fd == &amp;B</code></li>
<li>åˆ†é…ä¸¤æ¬¡åå³å¯å–å‡ºä½äº<code>X</code>åœ°å€å¤„çš„<code>fake chunk</code></li>
</ul>
<h3 class="heading-element" id="ç›¸å…³æŠ€å·§-3"><span>ç›¸å…³æŠ€å·§</span>
  <a href="#%e7%9b%b8%e5%85%b3%e6%8a%80%e5%b7%a7-3" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p>åœ¨å¼•å…¥äº†<code>tcache stash unlink</code>çš„æ—¶å€™ï¼Œéœ€è¦æ³¨æ„ç»•è¿‡ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="cp">#if USE_TCACHE
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>	  <span class="cm">/* While we&#39;re here, if we see other chunks of the same size,
</span></span></span><span class="line"><span class="cl"><span class="cm">	     stash them in the tcache.  */</span>
</span></span><span class="line"><span class="cl">	  <span class="kt">size_t</span> <span class="n">tc_idx</span> <span class="o">=</span> <span class="nf">csize2tidx</span> <span class="p">(</span><span class="n">nb</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	  <span class="k">if</span> <span class="p">(</span><span class="n">tcache</span> <span class="o">&amp;&amp;</span> <span class="n">tc_idx</span> <span class="o">&lt;</span> <span class="n">mp_</span><span class="p">.</span><span class="n">tcache_bins</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	    <span class="p">{</span>
</span></span><span class="line"><span class="cl">	      <span class="n">mchunkptr</span> <span class="n">tc_victim</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	      <span class="cm">/* While bin not empty and tcache not full, copy chunks over.  */</span>
</span></span><span class="line"><span class="cl">	      <span class="k">while</span> <span class="p">(</span><span class="n">tcache</span><span class="o">-&gt;</span><span class="n">counts</span><span class="p">[</span><span class="n">tc_idx</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">mp_</span><span class="p">.</span><span class="n">tcache_count</span>
</span></span><span class="line"><span class="cl">		     <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">tc_victim</span> <span class="o">=</span> <span class="nf">last</span> <span class="p">(</span><span class="n">bin</span><span class="p">))</span> <span class="o">!=</span> <span class="n">bin</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="p">{</span>
</span></span><span class="line"><span class="cl">		  <span class="k">if</span> <span class="p">(</span><span class="n">tc_victim</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		    <span class="p">{</span>
</span></span><span class="line"><span class="cl">		      <span class="n">bck</span> <span class="o">=</span> <span class="n">tc_victim</span><span class="o">-&gt;</span><span class="n">bk</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		      <span class="nf">set_inuse_bit_at_offset</span> <span class="p">(</span><span class="n">tc_victim</span><span class="p">,</span> <span class="n">nb</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">		      <span class="k">if</span> <span class="p">(</span><span class="n">av</span> <span class="o">!=</span> <span class="o">&amp;</span><span class="n">main_arena</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">			<span class="nf">set_non_main_arena</span> <span class="p">(</span><span class="n">tc_victim</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">		      <span class="n">bin</span><span class="o">-&gt;</span><span class="n">bk</span> <span class="o">=</span> <span class="n">bck</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		      <span class="n">bck</span><span class="o">-&gt;</span><span class="n">fd</span> <span class="o">=</span> <span class="n">bin</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		      <span class="nf">tcache_put</span> <span class="p">(</span><span class="n">tc_victim</span><span class="p">,</span> <span class="n">tc_idx</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	            <span class="p">}</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">	    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="cp">#endif</span></span></span></code></pre></td></tr></table>
</div>
</div><p>è¦ä¹ˆä½¿å…¶æ»¡è¶³<code>tc_victim = last (bin)) == bin</code>ã€è¦ä¹ˆä½¿å…¶æ»¡è¶³ï¼š<code>tcache-&gt;counts[tc_idx] â‰¥ mp_.tcache_count</code>ã€‚å¦åˆ™å¯èƒ½ä¼šå› ä¸ºéæ³•å†…å­˜è®¿é—®ä½¿å¾—ç¨‹åº<code>down</code>æ‰ã€‚</p>
<p>å®é™…ä¸Šï¼Œè¿™ä¸ªæŠ€å·§ç”¨å¾—ä¸æ˜¯å¾ˆå¤šï¼Œå› ä¸ºåœ¨åŒç­‰æ¡ä»¶ä¸‹ï¼Œæ›´åå‘äºåˆ©ç”¨<code>fastbin/tcachebin</code>ã€‚</p>
<h3 class="heading-element" id="åˆ©ç”¨æ•ˆæœ-3"><span>åˆ©ç”¨æ•ˆæœ</span>
  <a href="#%e5%88%a9%e7%94%a8%e6%95%88%e6%9e%9c-3" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><ul>
<li>ä»»æ„åœ°å€åˆ†é…</li>
<li>ä»»æ„åœ°å€è¯»å†™</li>
</ul>
<h2 class="heading-element" id="25-house-of-orange"><span>2.5-House of Orange</span>
  <a href="#25-house-of-orange" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><h3 class="heading-element" id="æ¼æ´æˆå› -4"><span>æ¼æ´æˆå› </span>
  <a href="#%e6%bc%8f%e6%b4%9e%e6%88%90%e5%9b%a0-4" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p>å †æº¢å‡ºå†™</p>
<h3 class="heading-element" id="é€‚ç”¨èŒƒå›´-4"><span>é€‚ç”¨èŒƒå›´</span>
  <a href="#%e9%80%82%e7%94%a8%e8%8c%83%e5%9b%b4-4" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><ul>
<li><code>2.23</code>â€”â€”<code>2.26</code></li>
<li>æ²¡æœ‰<code>free</code></li>
<li>å¯ä»¥<code>unsortedbin attack</code></li>
</ul>
<h3 class="heading-element" id="åˆ©ç”¨åŸç†-4"><span>åˆ©ç”¨åŸç†</span>
  <a href="#%e5%88%a9%e7%94%a8%e5%8e%9f%e7%90%86-4" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p><code>house of orange</code>å¯ä»¥è¯´æ˜¯å¼€å¯äº†å †ä¸<code>IO</code>ç»„åˆåˆ©ç”¨çš„å…ˆæ²³ï¼Œæ˜¯éå¸¸ç»å…¸ã€æ¼‚äº®ã€ç²¾å½©çš„åˆ©ç”¨ç»„åˆæŠ€ã€‚åˆ©ç”¨è¿‡ç¨‹è¿˜è¦ç»“åˆ<code>top_chunk</code>çš„æ€§è´¨ï¼Œåˆ©ç”¨è¿‡ç¨‹å¦‚ä¸‹ï¼š</p>
<p><strong>stage1</strong></p>
<ul>
<li>ç”³è¯·<code>chunk A</code>ï¼Œå‡è®¾æ­¤æ—¶çš„<code>top_chunk</code>çš„<code>size</code>ä¸º<code>0xWXYZ</code></li>
<li>å†™<code>A</code>ï¼Œæº¢å‡ºä¿®æ”¹<code>top_chunk</code>çš„<code>size</code>ä¸º<code>0xXYZ</code>ï¼ˆéœ€è¦æ»¡è¶³é¡µå¯¹é½çš„æ£€æµ‹æ¡ä»¶ï¼‰</li>
<li>ç”³è¯·ä¸€ä¸ªå¤§äº<code>0xXYZ</code>å¤§å°çš„<code>chunk</code>ï¼Œæ­¤æ—¶<code>top_chunk</code>ä¼šè¿›è¡Œ<code>grow</code>ï¼Œå¹¶å°†åŸæ¥çš„<code>old top_chunk</code>é‡Šæ”¾è¿›å…¥<code>unsortedbin</code></li>
</ul>
<p><strong>stage2</strong></p>
<ul>
<li>æº¢å‡ºå†™<code>A</code>ï¼Œä¿®æ”¹å¤„äº<code>unsortedbin</code>ä¸­çš„<code>old top_chunk</code>ï¼Œä¿®æ”¹å…¶<code>size</code>ä¸º<code>0x61</code>ï¼Œå…¶<code>bk</code>ä¸º<code>&amp;_IO_list_all-0x10</code>ï¼ŒåŒæ—¶ä¼ªé€ å¥½<code>IO_FILE</code>ç»“æ„</li>
<li>ç”³è¯·é<code>0x60</code>å¤§å°çš„<code>chunk</code>çš„æ—¶å€™ï¼Œé¦–å…ˆè§¦å‘<code>unsortedbin attack</code>ï¼Œå°†<code>_IO_list_all</code>ä¿®æ”¹ä¸º<code>main_arena+88</code>ï¼Œç„¶å<code>unsortedbin chunk</code>ä¼šè¿›å…¥åˆ°<code>smallbin</code>ï¼Œå¤§å°ä¸º<code>0x60</code>ï¼›æ¥ç€éå†<code>unsortedbin</code>çš„æ—¶å€™è§¦å‘äº†<code>malloc_printerr</code>ï¼Œç„¶åè°ƒç”¨é“¾ä¸ºï¼š<code> malloc_printerr -&gt; libc_message -&gt; abort -&gt; _IO_flush_all_lockp</code>ï¼Œè°ƒç”¨åˆ°ä¼ªé€ çš„<code>vtable</code>é‡Œé¢çš„å‡½æ•°æŒ‡é’ˆ</li>
</ul>
<h3 class="heading-element" id="ç›¸å…³æŠ€å·§-4"><span>ç›¸å…³æŠ€å·§</span>
  <a href="#%e7%9b%b8%e5%85%b3%e6%8a%80%e5%b7%a7-4" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><ul>
<li>åœ¨<code>glibc-2.24</code>ååŠ å…¥äº†<code>vtable</code>çš„<code>check</code>ï¼Œä¸èƒ½ä»»æ„åœ°å€ä¼ªé€ <code>vatble</code>äº†ï¼Œä½†æ˜¯å¯ä»¥åˆ©ç”¨<code>IO_str_jumps</code>ç»“æ„è¿›è¡Œåˆ©ç”¨ã€‚</li>
<li>åœ¨<code>glibc-2.26</code>åï¼Œ<code>malloc_printerr</code>ä¸å†åˆ·æ–°<code>IO</code>æµäº†ï¼Œæ‰€ä»¥è¯¥æ–¹æ³•å¤±æ•ˆ</li>
<li>ç”±äº<code>_mode</code>çš„æ­£è´Ÿæ€§æ˜¯éšæœºçš„ï¼Œå½±å“åˆ¤æ–­æ¡ä»¶ï¼Œå¤§æ¦‚æœ‰<code>1/2</code>çš„æ¦‚ç‡ä¼šåˆ©ç”¨å¤±è´¥ï¼Œå¤šè¯•å‡ æ¬¡å°±å¥½</li>
</ul>
<h3 class="heading-element" id="åˆ©ç”¨æ•ˆæœ-4"><span>åˆ©ç”¨æ•ˆæœ</span>
  <a href="#%e5%88%a9%e7%94%a8%e6%95%88%e6%9e%9c-4" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><ul>
<li>ä»»æ„å‡½æ•°æ‰§è¡Œ</li>
<li>ä»»æ„å‘½ä»¤æ‰§è¡Œ</li>
</ul>
<h2 class="heading-element" id="26-house-of-rabbit"><span>2.6-House of Rabbit</span>
  <a href="#26-house-of-rabbit" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><h3 class="heading-element" id="æ¼æ´æˆå› -5"><span>æ¼æ´æˆå› </span>
  <a href="#%e6%bc%8f%e6%b4%9e%e6%88%90%e5%9b%a0-5" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p>å †æº¢å‡ºå†™ã€<code>use after free</code>ã€<code>edit after free</code></p>
<h3 class="heading-element" id="é€‚ç”¨èŒƒå›´-5"><span>é€‚ç”¨èŒƒå›´</span>
  <a href="#%e9%80%82%e7%94%a8%e8%8c%83%e5%9b%b4-5" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><ul>
<li><code>2.23</code>â€”â€”<code>2.26</code></li>
<li>è¶…è¿‡<code>0x400</code>å¤§å°çš„å †åˆ†é…</li>
<li>å¯ä»¥å†™<code>fastbin</code>çš„<code>fd</code>æˆ–è€…<code>size</code>åŸŸ</li>
</ul>
<h3 class="heading-element" id="åˆ©ç”¨åŸç†-5"><span>åˆ©ç”¨åŸç†</span>
  <a href="#%e5%88%a9%e7%94%a8%e5%8e%9f%e7%90%86-5" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p>è¯¥åˆ©ç”¨æŠ€å·§çš„æ ¸å¿ƒæ˜¯<code>malloc_consolidate</code>å‡½æ•°ï¼Œå½“æ£€æµ‹åˆ°æœ‰<code>fastbin</code>çš„æ—¶å€™ï¼Œä¼šå–å‡ºæ¯ä¸€ä¸ª<code>fastbin chunk</code>ï¼Œå°†å…¶æ”¾ç½®åˆ°<code>unsortedbin</code>ä¸­ï¼Œå¹¶è¿›è¡Œåˆå¹¶ã€‚ä»¥ä¿®æ”¹<code>fd</code>ä¸ºä¾‹ï¼Œåˆ©ç”¨è¿‡ç¨‹å¦‚ä¸‹ï¼š</p>
<ul>
<li>ç”³è¯·<code>chunk A</code>ã€<code>chunk B</code>ï¼Œå…¶ä¸­<code>chunk A</code>çš„å¤§å°ä½äº<code>fastbin</code>èŒƒå›´</li>
<li>é‡Šæ”¾<code>chunk A</code>ï¼Œä½¿å…¶è¿›å…¥åˆ°<code>fastbin</code></li>
<li>åˆ©ç”¨<code>use after free</code>ï¼Œä¿®æ”¹<code>A-&gt;fd</code>æŒ‡å‘åœ°å€<code>X</code>ï¼Œéœ€è¦ä¼ªé€ å¥½<code>fake chunk</code>ï¼Œä½¿å…¶ä¸æ‰§è¡Œ<code>unlink</code>æˆ–è€…ç»•è¿‡<code>unlink</code></li>
<li>åˆ†é…è¶³å¤Ÿå¤§çš„<code>chunk</code>ï¼Œæˆ–è€…é‡Šæ”¾<code>0x10000</code>ä»¥ä¸Šçš„<code>chunk</code>ï¼Œåªè¦èƒ½è§¦å‘<code>malloc_consolidate</code>å³å¯</li>
<li>æ­¤æ—¶<code>fake chunk</code>è¢«æ”¾åˆ°äº†<code>unsortedbin</code>ï¼Œæˆ–è€…è¿›å…¥åˆ°å¯¹åº”çš„<code>smallbin/largebin</code></li>
<li>å–å‡º<code>fake chunk</code>è¿›è¡Œè¯»å†™å³å¯</li>
</ul>
<h3 class="heading-element" id="ç›¸å…³æŠ€å·§-5"><span>ç›¸å…³æŠ€å·§</span>
  <a href="#%e7%9b%b8%e5%85%b3%e6%8a%80%e5%b7%a7-5" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><ul>
<li><code>2.26</code>åŠ å…¥äº†<code>unlink</code>å¯¹<code>presize</code>çš„æ£€æŸ¥</li>
<li><code>2.27</code>åŠ å…¥äº†<code>fastbin</code>çš„æ£€æŸ¥</li>
</ul>
<p>æŠ“ä½é‡ç‚¹ï¼š<code>house of rabbit</code>æ˜¯å¯¹<code>malloc_consolidate</code>çš„åˆ©ç”¨ã€‚å› æ­¤ï¼Œä¸ä¸€å®šè¦æŒ‰ç…§åŸä½œè€…çš„æ€è·¯æ¥ï¼Œä»–çš„æ€è·¯éœ€è¦æ»¡è¶³çš„æ¡ä»¶å¤ªå¤šäº†ã€‚</p>
<h3 class="heading-element" id="åˆ©ç”¨æ•ˆæœ-5"><span>åˆ©ç”¨æ•ˆæœ</span>
  <a href="#%e5%88%a9%e7%94%a8%e6%95%88%e6%9e%9c-5" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><ul>
<li>ä»»æ„åœ°å€åˆ†é…</li>
<li>ä»»æ„åœ°å€è¯»å†™</li>
</ul>
<h2 class="heading-element" id="27-house-of-roman"><span>2.7-House of Roman</span>
  <a href="#27-house-of-roman" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><h3 class="heading-element" id="æ¼æ´æˆå› -6"><span>æ¼æ´æˆå› </span>
  <a href="#%e6%bc%8f%e6%b4%9e%e6%88%90%e5%9b%a0-6" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p><code>use after free</code>ã€å †æº¢å‡º</p>
<h3 class="heading-element" id="é€‚ç”¨èŒƒå›´-6"><span>é€‚ç”¨èŒƒå›´</span>
  <a href="#%e9%80%82%e7%94%a8%e8%8c%83%e5%9b%b4-6" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><ul>
<li><code>2.23</code>â€”â€”<code>2.29</code></li>
<li>å¯ä»¥<code>use after edit</code></li>
<li>ä¸éœ€è¦æ³„éœ²åœ°å€</li>
<li>éœ€è¦çˆ†ç ´<code>12 bit</code>ï¼ŒæˆåŠŸçš„æ¦‚ç‡<code>1/4096</code></li>
</ul>
<h3 class="heading-element" id="åˆ©ç”¨åŸç†-6"><span>åˆ©ç”¨åŸç†</span>
  <a href="#%e5%88%a9%e7%94%a8%e5%8e%9f%e7%90%86-6" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p>å¯ä»¥è¯´è¿™ä¸ªæŠ€å·§æ˜¯<code>fastbin attack + unsortedbin attack</code>çš„ç»„åˆæŠ€ï¼Œåˆ©ç”¨æ€è·¯å¦‚ä¸‹ï¼š</p>
<ul>
<li>ç”³è¯·<code>chunk A</code>ã€<code>chunk B</code>ã€<code>chunk C</code>å’Œ<code>chunk D</code>ï¼Œ<code>chunk B</code>çš„å¤§å°ä¸º<code>0x70</code></li>
<li>é‡Šæ”¾<code>chunk B</code>ï¼Œä½¿å…¶è¿›å…¥åˆ°<code>fastbin[0x70]</code></li>
<li>æº¢å‡ºå†™<code>A</code>ï¼Œä¿®æ”¹<code>chunk B</code>çš„<code>size</code>ï¼Œä½¿å…¶å¤§å°åœ¨<code>unsortedbin</code>èŒƒå›´</li>
<li>å†æ¬¡é‡Šæ”¾<code>B</code>ï¼Œ<code>B</code>è¿›å…¥<code>unsortedbin</code>ä¸­</li>
<li>éƒ¨åˆ†å†™<code>B</code>çš„<code>fd</code>ï¼Œä½¿å¾— <code>fd</code>æŒ‡å‘<code>malloc_hook-0x23</code></li>
<li>åˆ©ç”¨<code>A</code>çš„æº¢å‡ºå†™ä¿®æ­£<code>B</code>çš„<code>size</code>ï¼Œè¿ç»­åˆ†é…ä¸¤æ¬¡<code>0x70</code>ï¼Œå³å¯åˆ†é…åˆ°<code>malloc_hook</code>ä¸Šæ–¹</li>
<li>è§¦å‘<code>unsortedbin attack</code>ï¼Œå°†<code>__malloc_hook</code>å†™ä¸º<code>main_arena+88</code></li>
<li>éƒ¨åˆ†å†™<code>__malloc_hook</code>çš„ä½ä¸‰ä¸ªå­—èŠ‚ï¼Œä¿®æ”¹ä¸º<code>one_gadget</code></li>
<li>å†æ¬¡<code>malloc</code>å³å¯æ‹¿åˆ°<code>shell</code></li>
</ul>
<h3 class="heading-element" id="ç›¸å…³æŠ€å·§-6"><span>ç›¸å…³æŠ€å·§</span>
  <a href="#%e7%9b%b8%e5%85%b3%e6%8a%80%e5%b7%a7-6" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><ul>
<li>ä½¿ç”¨<code>house of roman</code>çš„æ—¶å€™ï¼Œéœ€è¦é‡‡ç”¨å¤šçº¿ç¨‹çˆ†ç ´</li>
<li>å¯ä»¥ä½¿ç”¨å…¶ä»–æ–¹æ³•ä»£æ›¿ï¼Œæ¯”å¦‚å…ˆæ”»å‡»<code>stdout</code>æ³„éœ²åœ°å€ï¼Œä½¿å¾—çˆ†ç ´çš„æˆæœ¬é™ä½</li>
</ul>
<h3 class="heading-element" id="åˆ©ç”¨æ•ˆæœ-6"><span>åˆ©ç”¨æ•ˆæœ</span>
  <a href="#%e5%88%a9%e7%94%a8%e6%95%88%e6%9e%9c-6" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><ul>
<li>æ‰§è¡Œ<code>one_gadget</code></li>
<li>ç»•è¿‡<code>ASLR</code></li>
</ul>
<h2 class="heading-element" id="28-house-of-storm"><span>2.8-House of Storm</span>
  <a href="#28-house-of-storm" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><h3 class="heading-element" id="æ¼æ´æˆå› -7"><span>æ¼æ´æˆå› </span>
  <a href="#%e6%bc%8f%e6%b4%9e%e6%88%90%e5%9b%a0-7" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p>å †æº¢å‡ºã€<code>use after free</code>ã€<code>edit after free</code></p>
<h3 class="heading-element" id="é€‚ç”¨èŒƒå›´-7"><span>é€‚ç”¨èŒƒå›´</span>
  <a href="#%e9%80%82%e7%94%a8%e8%8c%83%e5%9b%b4-7" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><ul>
<li><code>2.23</code>â€”â€”<code>2.29</code></li>
<li>å¯ä»¥è¿›è¡Œ<code>unsortedbin attack</code></li>
<li>å¯ä»¥è¿›è¡Œ<code>largebin attack</code>ï¼Œä¿®æ”¹<code>bk</code>å’Œ<code>bk_nextsize</code></li>
<li>å¯ä»¥åˆ†é…<code>0x50</code>å¤§å°çš„<code>chunk</code></li>
</ul>
<h3 class="heading-element" id="åˆ©ç”¨åŸç†-7"><span>åˆ©ç”¨åŸç†</span>
  <a href="#%e5%88%a9%e7%94%a8%e5%8e%9f%e7%90%86-7" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p><code>house of storm</code>ä¹Ÿæ˜¯ä¸€æ¬¾ç»„åˆæŠ€ï¼Œåˆ©ç”¨å¼€å¯äº†<code>PIE</code>çš„<code>x64</code>ç¨‹åºçš„å †åœ°å€æ€»æ˜¯<code>0x55xxxx...</code>æˆ–è€…<code>0x56xxxx...</code>å¼€å¤´è¿™ä¸€ç‰¹æ€§ï¼Œä½¿ç”¨ä¸€æ¬¡<code>largebin attack</code>å†™ä¸¤ä¸ªå †åœ°å€ï¼Œä½¿ç”¨ä¸€æ¬¡<code>unsortedbin attack</code>å†™ä¸€æ¬¡<code>libc</code>åœ°å€ï¼Œå¯ä»¥å®ç°ä»»æ„åœ°å€åˆ†é…ã€‚è™½ç„¶<code>house of storm</code>æœ€åèƒ½è¾¾åˆ°ä»»æ„åœ°å€åˆ†é…ï¼Œä½†æ˜¯ç”±äºå…¶æ‰€éœ€çš„æ¡ä»¶æ¯”è¾ƒå¤šï¼Œä¸€èˆ¬å¯ä»¥ç”¨å…¶ä»–æ›´ç®€ä¾¿çš„å †åˆ©ç”¨æŠ€æœ¯ä»£æ›¿ã€‚åˆ©ç”¨æ€è·¯å¦‚ä¸‹ï¼š</p>
<ul>
<li>è¿›è¡Œä¸€æ¬¡<code>unsortedbin attack</code>ï¼Œå…¶<code>bk</code>ä¿®æ”¹ä¸º<code>addr</code></li>
<li>è¿›è¡Œä¸€æ¬¡<code>largebin attack</code>ï¼Œå…¶<code>bk</code>ä¿®æ”¹ä¸º<code>addr+0x10</code>ï¼Œ<code>bk_nextsize</code>ä¿®æ”¹ä¸º<code>addr-0x20+3</code></li>
<li>ç”³è¯·<code>0x50</code>å¤§å°çš„<code>chunk</code>å³å¯ç”³è¯·åˆ°<code>addr</code>å¤„</li>
</ul>
<h3 class="heading-element" id="ç›¸å…³æŠ€å·§-7"><span>ç›¸å…³æŠ€å·§</span>
  <a href="#%e7%9b%b8%e5%85%b3%e6%8a%80%e5%b7%a7-7" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p>éœ€è¦æ³¨æ„çš„æœ‰ï¼š</p>
<ul>
<li>è¯¥æ–¹æ³•æˆåŠŸçš„å‡ ç‡æ˜¯<code>50%</code>ï¼Œå› ä¸º<code>0x55</code>ä¼šè§¦å‘<code>assert</code>æ–­è¨€ï¼Œ<code>0x56</code>æ‰èƒ½æˆåŠŸ</li>
<li>ç”³è¯·<code>addr</code>å¤„çš„<code>chunk</code>çš„æ—¶å€™éœ€è¦ä»<code>unsortedbin</code>é‡Œé¢å–</li>
</ul>
<h3 class="heading-element" id="åˆ©ç”¨æ•ˆæœ-7"><span>åˆ©ç”¨æ•ˆæœ</span>
  <a href="#%e5%88%a9%e7%94%a8%e6%95%88%e6%9e%9c-7" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><ul>
<li>ä»»æ„åœ°å€åˆ†é…</li>
</ul>
<h2 class="heading-element" id="29-house-of-corrosion"><span>2.9-House of Corrosion</span>
  <a href="#29-house-of-corrosion" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><h3 class="heading-element" id="æ¼æ´æˆå› -8"><span>æ¼æ´æˆå› </span>
  <a href="#%e6%bc%8f%e6%b4%9e%e6%88%90%e5%9b%a0-8" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p>å †æº¢å‡ºã€<code>use after free</code></p>
<h3 class="heading-element" id="é€‚ç”¨èŒƒå›´-8"><span>é€‚ç”¨èŒƒå›´</span>
  <a href="#%e9%80%82%e7%94%a8%e8%8c%83%e5%9b%b4-8" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><ul>
<li><code>2.23</code>â€”â€”è‡³ä»Š</li>
<li>ä»»æ„å¤§å°åˆ†é…</li>
<li>å¯ä»¥ä¿®æ”¹<code>global_max_fast</code></li>
<li>ä¸éœ€è¦æ³„éœ²åœ°å€</li>
</ul>
<h3 class="heading-element" id="åˆ©ç”¨åŸç†-8"><span>åˆ©ç”¨åŸç†</span>
  <a href="#%e5%88%a9%e7%94%a8%e5%8e%9f%e7%90%86-8" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p>ä¸€ä¸ªéå¸¸<code>tricky</code>çš„æ–¹æ³•ï¼Œå¯ä»¥ç»•è¿‡<code>aslr</code>ï¼Œä¸éœ€è¦æ³„éœ²åœ°å€éƒ½èƒ½è¾¾æˆ<code>rce</code>ï¼Œå¯ä»¥å¾ˆå¾ˆå¤šæ–¹æ³•ç»“åˆèµ·æ¥åº”ç”¨ã€‚å…ˆè¯´åˆ©ç”¨åŸç†ï¼š</p>
<ul>
<li>ä½¿ç”¨<code>unsortedbin attack/largebin attack</code>ç­‰æ–¹æ³•ï¼ŒæˆåŠŸä¿®æ”¹<code>global_max_fast</code>çš„å€¼ä¸ºå¾ˆå¤§çš„å€¼ã€‚å¦‚æœä½¿ç”¨<code>unsortedbin attack</code>ï¼Œä¸éœ€è¦æ³„éœ²åœ°å€ï¼Œçˆ†ç ´<code>1/16</code>å³å¯</li>
<li>ç”³è¯·ä»»æ„å¤§å°çš„<code>chunk</code>ï¼Œè¿™äº›<code>chunk</code>éƒ½ä¼šè¢«è§†ä¸º<code>fastbin chunk</code>ï¼Œç„¶ååˆ©ç”¨è¿™äº›<code>chunk</code>æ¥è¿›è¡Œè¯»å’Œå†™</li>
</ul>
<p>æ­¤æ—¶çš„è®¡ç®—å…¬å¼ä¸ºï¼š</p>
<p><code>chunk size = (chunk addr - &amp;main_arena.fastbinsY) x 2 + 0x20</code></p>
<p>è¯»åŸè¯­ï¼š</p>
<ul>
<li>å‡è®¾å¯¹åº”çš„åœ°å€<code>X</code>ä¸Šå­˜å‚¨ç€<code>Y</code>ï¼Œç°åœ¨çš„ç›®çš„æ˜¯æ³„éœ²å‡º<code>Y</code></li>
<li>æ ¹æ®åç§»è®¡ç®—å‡ºæ¥<code>chunk size</code>ï¼Œä¿®æ”¹<code>chunk A</code>çš„<code>size</code>ä¸ºè®¡ç®—å‡ºæ¥çš„å€¼ï¼Œé‡Šæ”¾<code>chunk A</code>åˆ°åœ°å€<code>X</code>å¤„</li>
<li>æ­¤æ—¶ï¼Œ<code>A-&gt;fd</code>å°±è¢«å†™å…¥äº†<code>Y</code></li>
<li>é€šè¿‡æ‰“å°å³å¯æ³„éœ²å‡º<code>Y</code>çš„ä¿¡æ¯</li>
</ul>
<p>å†™åŸè¯­<code>1</code>ï¼š</p>
<ul>
<li>å‡è®¾å¯¹åº”çš„åœ°å€<code>X</code>ä¸Šå­˜å‚¨ç€<code>Y</code>ï¼Œç°åœ¨çš„ç›®çš„æ˜¯ä¿®æ”¹åœ°å€<code>X</code>å­˜å‚¨çš„<code>Y</code>ä¸ºå…¶ä»–å€¼</li>
<li>æ ¹æ®åç§»è®¡ç®—å‡ºæ¥<code>chunk size</code>ï¼Œä¿®æ”¹<code>chunk A</code>çš„<code>size</code>ä¸ºè®¡ç®—å‡ºæ¥çš„å€¼ï¼Œé‡Šæ”¾<code>chunk A</code>åˆ°åœ°å€<code>X</code>å¤„</li>
<li>æ­¤æ—¶ï¼Œ<code>A-&gt;fd</code>å°±è¢«å†™å…¥äº†<code>Y</code></li>
<li>ä¿®æ”¹<code>A-&gt;fd</code>ä¸ºç›®æ ‡å€¼</li>
<li>åˆ†é…ä¸€æ¬¡<code>chunk A</code>å°±å¯ä»¥æŠŠåœ°å€<code>X</code>å­˜å‚¨çš„å€¼ä¸ºä»»æ„å€¼</li>
</ul>
<p>å†™åŸè¯­<code>2</code>ï¼š</p>
<ul>
<li>å‡è®¾åœ°å€<code>X</code>ä¸Šå­˜å‚¨ç€<code>Y</code>ã€åœ°å€<code>M</code>ä¸Šå­˜å‚¨ç€<code>N</code>ï¼Œç°åœ¨çš„ç›®çš„æ˜¯æŠŠ<code>N</code>å†™åˆ°åœ°å€<code>X</code>å¤„</li>
<li>æ ¹æ®åç§»è®¡ç®—<code>chunk size1</code>ï¼Œå…ˆé‡Šæ”¾<code>chunk A</code>åˆ°åœ°å€<code>X</code>å¤„ï¼Œæ­¤æ—¶æœ‰åœ°å€<code>X</code>å¤„å­˜å‚¨<code>chunk A</code>åœ°å€ï¼Œ<code>chunk A-&gt;fd</code>ä¸º<code>Y</code></li>
<li>æ ¹æ®åç§»è®¡ç®—<code>chunk size2</code>ï¼Œå†æ¬¡é‡Šæ”¾<code>chunk A</code>åˆ°åœ°å€<code>M</code>å¤„ï¼Œæ­¤æ—¶æœ‰åœ°å€<code>M</code>å¤„å­˜å‚¨<code>chunk A</code>åœ°å€ï¼Œ<code>chunk A-&gt;fd</code>ä¸º<code>N</code></li>
<li>ä¿®æ­£<code>chunk A</code>çš„å¤§å°ä¸º<code>chunk size1</code>ï¼Œåˆ†é…<code>1</code>æ¬¡<code>chunk</code>å³å¯ä½¿å¾—<code>N</code>è½¬ç§»åˆ°åœ°å€<code>X</code>å¤„ï¼Œå½“ç„¶åœ¨è½¬ç§»çš„è¿‡ç¨‹ä¸­å¯ä»¥é€‚å½“çš„ä¿®æ”¹<code>N</code></li>
</ul>
<p>æ˜¾ç„¶ï¼Œå€ŸåŠ©å†™åŸè¯­<code>2</code>ï¼Œå³å¯åœ¨ä¸éœ€è¦æ³„éœ²åœ°å€çš„å‰æä¸‹å°†<code>__malloc_hook</code>ç­‰å†™ä¸º<code>one_gadget</code>ï¼Œçˆ†ç ´çš„æ¦‚ç‡æ˜¯<code>1/4096</code>ã€‚</p>
<h3 class="heading-element" id="ç›¸å…³æŠ€å·§-8"><span>ç›¸å…³æŠ€å·§</span>
  <a href="#%e7%9b%b8%e5%85%b3%e6%8a%80%e5%b7%a7-8" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><ul>
<li>è™½ç„¶è‡³ä»Šéƒ½èƒ½ä½¿ç”¨<code>house of corrosion</code>ï¼Œä½†æ˜¯åœ¨<code>glibc-2.37</code>ç‰ˆæœ¬ä¸­ï¼Œ<code>global_max_fast</code>çš„æ•°æ®ç±»å‹è¢«ä¿®æ”¹ä¸ºäº†<code>int8_u</code>ï¼Œè¿›è€Œå¯¼è‡´å¯æ§çš„ç©ºé—´èŒƒå›´å¤§å¹…åº¦ç¼©å°ã€‚</li>
<li><code>house of corrosion</code>ä¹Ÿå¯ä»¥æ‹“å±•åˆ°<code>tcachebin</code>ä¸Š</li>
<li>é€‚å½“æ§åˆ¶<code>global_max_fast</code>çš„å¤§å°ï¼ŒæŠŠæ¡æ§åˆ¶çš„ç©ºé—´èŒƒå›´</li>
<li>å¯ä»¥å’Œ<code>IO_FILE</code>ç»“åˆèµ·æ¥æ³„éœ²ä¿¡æ¯</li>
</ul>
<h3 class="heading-element" id="åˆ©ç”¨æ•ˆæœ-8"><span>åˆ©ç”¨æ•ˆæœ</span>
  <a href="#%e5%88%a9%e7%94%a8%e6%95%88%e6%9e%9c-8" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><ul>
<li><code>glibc</code>ä¸Šçš„åœ°å€æ³„éœ²</li>
<li>æ‰§è¡Œ<code>one_gadget</code></li>
</ul>
<h2 class="heading-element" id="210-house-of-husk"><span>2.10-House of Husk</span>
  <a href="#210-house-of-husk" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><h3 class="heading-element" id="æ¼æ´æˆå› -9"><span>æ¼æ´æˆå› </span>
  <a href="#%e6%bc%8f%e6%b4%9e%e6%88%90%e5%9b%a0-9" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p>å †æº¢å‡º</p>
<h3 class="heading-element" id="é€‚ç”¨èŒƒå›´-9"><span>é€‚ç”¨èŒƒå›´</span>
  <a href="#%e9%80%82%e7%94%a8%e8%8c%83%e5%9b%b4-9" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><ul>
<li><code>2.23</code>â€”â€”è‡³ä»Š</li>
<li>å¯ä»¥ä¿®æ”¹<code>__printf_arginfo_table</code>å’Œ<code>__printf_function_table</code></li>
<li>å¯è§¦å‘æ ¼å¼åŒ–å­—ç¬¦ä¸²è§£æ</li>
</ul>
<h3 class="heading-element" id="åˆ©ç”¨åŸç†-9"><span>åˆ©ç”¨åŸç†</span>
  <a href="#%e5%88%a9%e7%94%a8%e5%8e%9f%e7%90%86-9" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p>ä¸¥æ ¼æ¥è¯´ï¼Œè¿™ä¸ªæ¼æ´æ˜¯ä¸å †çš„å…³ç³»å¹¶ä¸æ˜¯å¾ˆå¤§ï¼Œä¸»è¦æ˜¯æ ¹æ®<code>printf</code>çš„æœºåˆ¶è¿›è¡Œåˆ©ç”¨ã€‚ä½†æ˜¯ï¼Œè¯¥æŠ€æœ¯å¯ä»¥å’Œå¾ˆå¤šå †åˆ©ç”¨æ‰‹æ³•ç»“åˆèµ·æ¥ã€‚</p>
<p>è°ƒç”¨å¤„<code>1</code>ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="c1">//
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="cm">/* Use the slow path in case any printf handler is registered.  */</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="nf">__glibc_unlikely</span> <span class="p">(</span><span class="n">__printf_function_table</span> <span class="o">!=</span> <span class="nb">NULL</span>
</span></span><span class="line"><span class="cl">			<span class="o">||</span> <span class="n">__printf_modifier_table</span> <span class="o">!=</span> <span class="nb">NULL</span>
</span></span><span class="line"><span class="cl">			<span class="o">||</span> <span class="n">__printf_va_arg_table</span> <span class="o">!=</span> <span class="nb">NULL</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="k">goto</span> <span class="n">do_positional</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// vfprintf-internal.c#1763
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">nargs</span> <span class="o">+=</span> <span class="nf">__parse_one_specmb</span> <span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">nargs</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">specs</span><span class="p">[</span><span class="n">nspecs</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">max_ref_arg</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// printf-parsemb.c (__parse_one_specmbå‡½æ•°)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="cm">/* Get the format specification.  */</span>
</span></span><span class="line"><span class="cl"><span class="n">spec</span><span class="o">-&gt;</span><span class="n">info</span><span class="p">.</span><span class="n">spec</span> <span class="o">=</span> <span class="p">(</span><span class="kt">wchar_t</span><span class="p">)</span> <span class="o">*</span><span class="n">format</span><span class="o">++</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">spec</span><span class="o">-&gt;</span><span class="n">size</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="nf">__builtin_expect</span> <span class="p">(</span><span class="n">__printf_function_table</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="c1">// åˆ¤æ–­æ˜¯å¦ä¸ºç©º
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="o">||</span> <span class="n">spec</span><span class="o">-&gt;</span><span class="n">info</span><span class="p">.</span><span class="n">spec</span> <span class="o">&gt;</span> <span class="n">UCHAR_MAX</span>
</span></span><span class="line"><span class="cl">  <span class="o">||</span> <span class="n">__printf_arginfo_table</span><span class="p">[</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">info</span><span class="p">.</span><span class="n">spec</span><span class="p">]</span> <span class="o">==</span> <span class="nb">NULL</span> <span class="c1">// åˆ¤æ–­æ˜¯å¦ä¸ºç©º
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="cm">/* We don&#39;t try to get the types for all arguments if the format
</span></span></span><span class="line"><span class="cl"><span class="cm"> uses more than one.  The normal case is covered though.  If
</span></span></span><span class="line"><span class="cl"><span class="cm"> the call returns -1 we continue with the normal specifiers.  */</span>
</span></span><span class="line"><span class="cl">  <span class="o">||</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span> <span class="p">(</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">ndata_args</span> <span class="o">=</span> <span class="p">(</span><span class="o">*</span><span class="n">__printf_arginfo_table</span><span class="p">[</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">info</span><span class="p">.</span><span class="n">spec</span><span class="p">])</span> <span class="c1">// è°ƒç”¨__printf_arginfo_tableä¸­çš„å‡½æ•°æŒ‡é’ˆ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>               <span class="p">(</span><span class="o">&amp;</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">info</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">data_arg_type</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="o">&amp;</span><span class="n">spec</span><span class="o">-&gt;</span><span class="n">size</span><span class="p">))</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// ......
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><p>åˆ©ç”¨æ–¹å¼ä¸ºï¼š</p>
<ul>
<li><code>__printf_function_table</code>å’Œ<code>__printf_arginfo_table</code>åˆ†åˆ«å†™ä¸º<code>chunk A</code>å’Œ<code>chunk B</code>çš„åœ°å€</li>
<li>è®¾å ä½ç¬¦ä¸º<code>Î±</code>ï¼Œæ­¤æ—¶<code>chunk B</code>çš„å†…å®¹åº”è¯¥ä¸º<code>p64(0) x ord(Î±-2) + p64(one_gadget)</code></li>
</ul>
<p>è°ƒç”¨å¤„<code>2</code>ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="c1">// vfprintf-internal.c#1962
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">if</span> <span class="p">(</span><span class="n">spec</span> <span class="o">&lt;=</span> <span class="n">UCHAR_MAX</span>
</span></span><span class="line"><span class="cl">          <span class="o">&amp;&amp;</span> <span class="n">__printf_function_table</span> <span class="o">!=</span> <span class="nb">NULL</span>
</span></span><span class="line"><span class="cl">          <span class="o">&amp;&amp;</span> <span class="n">__printf_function_table</span><span class="p">[(</span><span class="kt">size_t</span><span class="p">)</span> <span class="n">spec</span><span class="p">]</span> <span class="o">!=</span> <span class="nb">NULL</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="c1">// ......
</span></span></span><span class="line"><span class="cl"><span class="c1"></span> 
</span></span><span class="line"><span class="cl">      <span class="cm">/* Call the function.  */</span>
</span></span><span class="line"><span class="cl">      <span class="n">function_done</span> <span class="o">=</span> <span class="n">__printf_function_table</span><span class="p">[(</span><span class="kt">size_t</span><span class="p">)</span> <span class="n">spec</span><span class="p">](</span><span class="n">s</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">specs</span><span class="p">[</span><span class="n">nspecs_done</span><span class="p">].</span><span class="n">info</span><span class="p">,</span> <span class="n">ptr</span><span class="p">);</span> <span class="c1">// è°ƒç”¨__printf_function_tableä¸­çš„å‡½æ•°æŒ‡é’ˆ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span> 
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">function_done</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="cm">/* If an error occurred we don&#39;t have information
</span></span></span><span class="line"><span class="cl"><span class="cm">         about # of chars.  */</span>
</span></span><span class="line"><span class="cl">      <span class="k">if</span> <span class="p">(</span><span class="n">function_done</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">          <span class="cm">/* Function has set errno.  */</span>
</span></span><span class="line"><span class="cl">          <span class="n">done</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">          <span class="k">goto</span> <span class="n">all_done</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">      <span class="nf">done_add</span> <span class="p">(</span><span class="n">function_done</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><p>åˆ©ç”¨æ–¹å¼ä¸ºï¼š</p>
<ul>
<li><code>__printf_function_table</code>å’Œ<code>__printf_arginfo_table</code>åˆ†åˆ«å†™ä¸º<code>chunk A</code>å’Œ<code>chunk B</code>çš„åœ°å€</li>
<li>è®¾å ä½ç¬¦ä¸º<code>Î±</code>ï¼Œæ­¤æ—¶<code>chunk A</code>çš„å†…å®¹åº”è¯¥ä¸º<code>p64(0) x ord(Î±-2) + p64(one_gadget)</code></li>
</ul>
<p>è¯¥å¤„è°ƒç”¨åœ¨é«˜ç‰ˆæœ¬è¢«åˆ é™¤ã€‚</p>
<h3 class="heading-element" id="ç›¸å…³æŠ€å·§-9"><span>ç›¸å…³æŠ€å·§</span>
  <a href="#%e7%9b%b8%e5%85%b3%e6%8a%80%e5%b7%a7-9" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><ul>
<li>è¯¥æŠ€å·§ä¸€èˆ¬å’Œ<code>largebin attack</code>ç»“åˆèµ·æ¥</li>
<li>åœ¨ä½äº<code>2.36</code>ç‰ˆæœ¬ä¸­ï¼Œ<code>__malloc_assert</code>ä¸­æœ‰æ ¼å¼åŒ–å­—ç¬¦ä¸²çš„è§£æ</li>
<li>è¿˜æœ‰ä¸€ä¸ª<code>__printf_va_arg_table</code>ä¹Ÿæ˜¯å¯ä»¥åˆ©ç”¨çš„ï¼Œä½†æ˜¯æ¡ä»¶æ¯”è¾ƒè‹›åˆ»</li>
</ul>
<h3 class="heading-element" id="åˆ©ç”¨æ•ˆæœ-9"><span>åˆ©ç”¨æ•ˆæœ</span>
  <a href="#%e5%88%a9%e7%94%a8%e6%95%88%e6%9e%9c-9" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><ul>
<li>æ‰§è¡Œ<code>one_gadget</code></li>
<li>æ‰§è¡Œ<code>rop</code>æ§åˆ¶ç¨‹åºæ‰§è¡Œæµ</li>
</ul>
<h2 class="heading-element" id="211-house-of-atum"><span>2.11-House of Atum</span>
  <a href="#211-house-of-atum" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><h3 class="heading-element" id="æ¼æ´æˆå› -10"><span>æ¼æ´æˆå› </span>
  <a href="#%e6%bc%8f%e6%b4%9e%e6%88%90%e5%9b%a0-10" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p><code>edit after free</code></p>
<h3 class="heading-element" id="é€‚ç”¨èŒƒå›´-10"><span>é€‚ç”¨èŒƒå›´</span>
  <a href="#%e9%80%82%e7%94%a8%e8%8c%83%e5%9b%b4-10" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><ul>
<li><code>2.26</code>â€”â€”<code>2.30</code></li>
<li>å¯ä»¥ä¿®æ”¹<code>tcachebin</code>çš„<code>next</code>å’Œ<code>key</code></li>
</ul>
<h3 class="heading-element" id="åˆ©ç”¨åŸç†-10"><span>åˆ©ç”¨åŸç†</span>
  <a href="#%e5%88%a9%e7%94%a8%e5%8e%9f%e7%90%86-10" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p>è¿™æ˜¯ä¸€ä¸ªå…³äº<code>tcachebin</code>çš„æŠ€å·§ï¼Œç”¨äºä¿®æ”¹<code>chunk presize/size</code>ï¼Œåˆ©ç”¨è¿‡ç¨‹å¦‚ä¸‹ï¼š</p>
<ul>
<li>ç”³è¯·<code>chunk A</code>ï¼Œå¤§å°åœ¨<code>fastbin</code>èŒƒå›´å†…</li>
<li>é‡Šæ”¾<code>A</code>ï¼Œè¿ç»­é‡Šæ”¾<code>8</code>æ¬¡ï¼Œæ­¤æ—¶ï¼Œ<code>A</code>çš„<code>fd</code>è¢«æ¸…<code>0</code>ï¼Œ<code>A</code>ä¹Ÿè¢«æ”¾ç½®åˆ°äº†<code>fastbin</code>é‡Œé¢</li>
<li>ç”³è¯·ä¸€ä¸ª<code>chunk</code>ï¼Œå°†å…¶<code>fd</code>ä¿®æ”¹ä¸º<code>A - 0x10</code>ï¼Œæ­¤æ—¶<code>tcache</code>ä¸­çš„<code>counts</code>ä¸º<code>6</code></li>
<li>å†ç”³è¯·ä¸€ä¸ª<code>chunk</code>ï¼Œä»<code>fastbin</code>é‡Œé¢å–ï¼Œä½†æ˜¯ä¼šæŠŠ<code>fastbin</code>é‡Œé¢å‰©ä½™çš„ä¸€ä¸ª<code>chunk</code>é“¾å…¥åˆ°<code>tcachebin</code></li>
<li>å†æ¬¡åˆ†é…å°±ä¼šåˆ†é…åˆ°åœ°å€<code>A-0x10</code>å¤„ï¼Œå°±å¯ä»¥ä¿®æ”¹åŸæ¥<code>A</code>çš„<code>presize/size</code>ç­‰</li>
</ul>
<h3 class="heading-element" id="ç›¸å…³æŠ€å·§-10"><span>ç›¸å…³æŠ€å·§</span>
  <a href="#%e7%9b%b8%e5%85%b3%e6%8a%80%e5%b7%a7-10" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><ul>
<li>
<p><code>2.30</code>ä¹‹åé€»è¾‘å˜äº†ï¼ŒåŸæ¥æ˜¯åˆ¤æ–­<code>entry[idx]!=NULL</code>ï¼Œ<code>2.31</code>ä¹‹ååˆ¤æ–­<code>count[idx] &gt; 0</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="c1">// glibc â‰¥ 2.30
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">void</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl"><span class="nf">__libc_malloc</span> <span class="p">(</span><span class="kt">size_t</span> <span class="n">bytes</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="c1">//......
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nf">MAYBE_INIT_TCACHE</span> <span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">DIAG_PUSH_NEEDS_COMMENT</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="n">tc_idx</span> <span class="o">&lt;</span> <span class="n">mp_</span><span class="p">.</span><span class="n">tcache_bins</span>
</span></span><span class="line"><span class="cl">      <span class="o">&amp;&amp;</span> <span class="n">tcache</span>
</span></span><span class="line"><span class="cl">      <span class="o">&amp;&amp;</span> <span class="n">tcache</span><span class="o">-&gt;</span><span class="n">counts</span><span class="p">[</span><span class="n">tc_idx</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="nf">tcache_get</span> <span class="p">(</span><span class="n">tc_idx</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// glibc &lt; 2.30
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">void</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl"><span class="nf">__libc_malloc</span> <span class="p">(</span><span class="kt">size_t</span> <span class="n">bytes</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="c1">//......
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nf">MAYBE_INIT_TCACHE</span> <span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">DIAG_PUSH_NEEDS_COMMENT</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="n">tc_idx</span> <span class="o">&lt;</span> <span class="n">mp_</span><span class="p">.</span><span class="n">tcache_bins</span>
</span></span><span class="line"><span class="cl">      <span class="o">&amp;&amp;</span> <span class="n">tcache</span>
</span></span><span class="line"><span class="cl">      <span class="o">&amp;&amp;</span> <span class="n">tcache</span><span class="o">-&gt;</span><span class="n">entries</span><span class="p">[</span><span class="n">tc_idx</span><span class="p">]</span> <span class="o">!=</span> <span class="nb">NULL</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="nf">tcache_get</span> <span class="p">(</span><span class="n">tc_idx</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>æœ‰æ—¶å€™éœ€è¦ç»•è¿‡<code>tcache-&gt;key</code>çš„æ£€æµ‹</p>
</li>
</ul>
<h3 class="heading-element" id="åˆ©ç”¨æ•ˆæœ-10"><span>åˆ©ç”¨æ•ˆæœ</span>
  <a href="#%e5%88%a9%e7%94%a8%e6%95%88%e6%9e%9c-10" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><ul>
<li>ä¿®æ”¹<code>chunk size</code>ä»¥åŠ<code>chunk presize</code></li>
</ul>
<h2 class="heading-element" id="212-house-of-kauri"><span>2.12-House of Kauri</span>
  <a href="#212-house-of-kauri" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><h3 class="heading-element" id="æ¼æ´æˆå› -11"><span>æ¼æ´æˆå› </span>
  <a href="#%e6%bc%8f%e6%b4%9e%e6%88%90%e5%9b%a0-11" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p>å †æº¢å‡º</p>
<h3 class="heading-element" id="é€‚ç”¨èŒƒå›´-11"><span>é€‚ç”¨èŒƒå›´</span>
  <a href="#%e9%80%82%e7%94%a8%e8%8c%83%e5%9b%b4-11" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><ul>
<li><code>2.26</code>â€”â€”<code>2.32</code></li>
</ul>
<h3 class="heading-element" id="åˆ©ç”¨åŸç†-11"><span>åˆ©ç”¨åŸç†</span>
  <a href="#%e5%88%a9%e7%94%a8%e5%8e%9f%e7%90%86-11" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p>åˆ©ç”¨åŸç†å¾ˆç®€å•ï¼Œä¿®æ”¹<code>tcachebin</code>çš„<code>size</code>ï¼Œç„¶åä½¿å…¶è¢«æ”¾åˆ°ä¸åŒå¤§å°çš„<code>tcachebin</code>é“¾è¡¨é‡Œé¢å»ã€‚æˆ‘æ„Ÿè§‰è¿™ä¸ªæŠ€å·§æ˜¯å¾ˆåŸºç¡€çš„<code>tcachebin</code>æŠ€å·§ï¼Œç”šè‡³ä¸åº”è¯¥è¢«ç§°ä¹‹ä¸º<code>house of</code>ã€‚</p>
<h3 class="heading-element" id="ç›¸å…³æŠ€å·§-11"><span>ç›¸å…³æŠ€å·§</span>
  <a href="#%e7%9b%b8%e5%85%b3%e6%8a%80%e5%b7%a7-11" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><ul>
<li>æ— </li>
</ul>
<h3 class="heading-element" id="åˆ©ç”¨æ•ˆæœ-11"><span>åˆ©ç”¨æ•ˆæœ</span>
  <a href="#%e5%88%a9%e7%94%a8%e6%95%88%e6%9e%9c-11" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><ul>
<li>å¤šä¸ª<code>tcachebin</code>é“¾è¡¨ä¸­å­˜æ”¾åŒä¸€ä¸ª<code>chunk</code></li>
</ul>
<h2 class="heading-element" id="213-house-of-fun"><span>2.13-House of Fun</span>
  <a href="#213-house-of-fun" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><h3 class="heading-element" id="æ¼æ´æˆå› -12"><span>æ¼æ´æˆå› </span>
  <a href="#%e6%bc%8f%e6%b4%9e%e6%88%90%e5%9b%a0-12" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p>å †æº¢å‡ºã€<code>use after free</code></p>
<h3 class="heading-element" id="é€‚ç”¨èŒƒå›´-12"><span>é€‚ç”¨èŒƒå›´</span>
  <a href="#%e9%80%82%e7%94%a8%e8%8c%83%e5%9b%b4-12" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><ul>
<li><code>2.23</code>â€”â€”<code>2.30</code></li>
<li>å¯ä»¥ç”³è¯·<code>largebin</code>èŒƒå›´çš„<code>chunk</code></li>
</ul>
<h3 class="heading-element" id="åˆ©ç”¨åŸç†-12"><span>åˆ©ç”¨åŸç†</span>
  <a href="#%e5%88%a9%e7%94%a8%e5%8e%9f%e7%90%86-12" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p>æˆ–è®¸è¿™ä¸ªæŠ€å·§åº”è¯¥å«åš<code>largebin attack</code>ã€‚</p>
<p>åœ¨è¿™ä¸ª<a href="https://sourceware.org/git/?p=glibc.git;a=blobdiff;f=malloc/malloc.c;h=801ba1f499b566e677b763fc84f8ba86f4f7ccd0;hp=6e766d11bc85b6480fa5c9f2a76559f8acf9deb5;hb=5b06f538c5aee0389ed034f60d90a8884d6d54de;hpb=a0a0dc83173ce11ff45105fd32e5d14356cdfb9c"target="_blank" rel="external nofollow noopener noreferrer">sourceware.org Git - glibc.git/blobdiff - malloc/malloc.c<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a><code>commit</code>è¢«æ£€æµ‹äº†ï¼š</p>
<p><img loading="lazy" src='https://image.roderickchan.cn/img/image-20230306115614058.png' alt="image-20230306115614058"></p>
<h3 class="heading-element" id="ç›¸å…³æŠ€å·§-12"><span>ç›¸å…³æŠ€å·§</span>
  <a href="#%e7%9b%b8%e5%85%b3%e6%8a%80%e5%b7%a7-12" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><ul>
<li>æ— </li>
</ul>
<h3 class="heading-element" id="åˆ©ç”¨æ•ˆæœ-12"><span>åˆ©ç”¨æ•ˆæœ</span>
  <a href="#%e5%88%a9%e7%94%a8%e6%95%88%e6%9e%9c-12" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><ul>
<li>ä»»æ„åœ°å€å†™å †åœ°å€</li>
</ul>
<h2 class="heading-element" id="214-house-of-mind"><span>2.14-House of Mind</span>
  <a href="#214-house-of-mind" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><h3 class="heading-element" id="æ¼æ´æˆå› -13"><span>æ¼æ´æˆå› </span>
  <a href="#%e6%bc%8f%e6%b4%9e%e6%88%90%e5%9b%a0-13" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p>å †æº¢å‡º</p>
<h3 class="heading-element" id="é€‚ç”¨èŒƒå›´-13"><span>é€‚ç”¨èŒƒå›´</span>
  <a href="#%e9%80%82%e7%94%a8%e8%8c%83%e5%9b%b4-13" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><ul>
<li><code>2.23</code>â€”â€”è‡³ä»Š</li>
<li>å¯ä»¥åˆ†é…ä»»æ„å¤§å°çš„<code>chunk</code></li>
</ul>
<h3 class="heading-element" id="åˆ©ç”¨åŸç†-13"><span>åˆ©ç”¨åŸç†</span>
  <a href="#%e5%88%a9%e7%94%a8%e5%8e%9f%e7%90%86-13" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p>ä¸»è¦åˆ©ç”¨çš„æ˜¯ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="cp">#define heap_for_ptr(ptr) \
</span></span></span><span class="line"><span class="cl"><span class="cp">  ((heap_info *) ((unsigned long) (ptr) &amp; ~(HEAP_MAX_SIZE - 1)))
</span></span></span><span class="line"><span class="cl"><span class="cp">#define arena_for_chunk(ptr) \
</span></span></span><span class="line"><span class="cl"><span class="cp">  (chunk_non_main_arena (ptr) ? heap_for_ptr (ptr)-&gt;ar_ptr : &amp;main_arena)</span></span></span></code></pre></td></tr></table>
</div>
</div><p>å¦‚æœæ˜¯<code>non-mainarean</code>çš„<code>chunk</code>ï¼Œä¼šæ ¹æ®å…¶åœ°å€æ‰¾åˆ°<code>heapinfo</code>ï¼Œç„¶åæ‰¾åˆ°<code>malloc_state</code>ç»“æ„ä½“ã€‚</p>
<p>å› æ­¤ï¼Œåˆ©ç”¨æŠ€å·§æ˜¯ï¼š</p>
<ul>
<li>æ ¹æ®è¦é‡Šæ”¾çš„<code>fastbin chunk A</code>çš„å †åœ°å€ï¼Œæ‰¾åˆ°å¯¹åº”çš„<code>heap_for_ptr</code>åœ°å€</li>
<li>åœ¨<code>heapinfo</code>åœ°å€å¤„ä¼ªé€ å¥½ç›¸å…³å˜é‡ï¼Œé‡ç‚¹æ˜¯<code>mstate</code>æŒ‡é’ˆ</li>
<li>ä¿®æ”¹<code>chunk A</code>çš„<code>non-main</code>æ ‡å¿—ä½ï¼Œé‡Šæ”¾åˆ°ä¼ªé€ çš„<code>arena</code>é‡Œé¢ï¼Œæ§åˆ¶å¥½åç§»å³å¯</li>
</ul>
<h3 class="heading-element" id="ç›¸å…³æŠ€å·§-13"><span>ç›¸å…³æŠ€å·§</span>
  <a href="#%e7%9b%b8%e5%85%b3%e6%8a%80%e5%b7%a7-13" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><ul>
<li>ä¸€èˆ¬æ¥è¯´ï¼Œå¯ä»¥åˆ†é…ä»»æ„å¤§å°çš„<code>chunk</code>ï¼Œè¿˜èƒ½å †æº¢å‡ºï¼Œå¾ˆå¤šæŠ€å·§éƒ½èƒ½ç”¨</li>
<li>è¿™ä¸ªæŠ€å·§æ˜¯å¸Œæœ›å¤§å®¶å…³æ³¨å¯¹äº<code>arena</code>çš„æ”»å‡»</li>
<li>ç”šè‡³å¯ä»¥ç›´æ¥ä¿®æ”¹<code>thread_arena</code>è¿™ä¸ªå˜é‡</li>
</ul>
<h3 class="heading-element" id="åˆ©ç”¨æ•ˆæœ-13"><span>åˆ©ç”¨æ•ˆæœ</span>
  <a href="#%e5%88%a9%e7%94%a8%e6%95%88%e6%9e%9c-13" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><ul>
<li>ä»»æ„åœ°å€å†™å †åœ°å€</li>
</ul>
<h2 class="heading-element" id="215-house-of-muney"><span>2.15-House of Muney</span>
  <a href="#215-house-of-muney" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><h3 class="heading-element" id="æ¼æ´æˆå› -14"><span>æ¼æ´æˆå› </span>
  <a href="#%e6%bc%8f%e6%b4%9e%e6%88%90%e5%9b%a0-14" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p>å †æº¢å‡º</p>
<h3 class="heading-element" id="é€‚ç”¨èŒƒå›´-14"><span>é€‚ç”¨èŒƒå›´</span>
  <a href="#%e9%80%82%e7%94%a8%e8%8c%83%e5%9b%b4-14" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><ul>
<li><code>2.23</code>â€”â€”è‡³ä»Š</li>
<li>èƒ½åˆ†é…<code>mmap</code>çš„<code>chunk</code></li>
<li>èƒ½ä¿®æ”¹<code>mmap</code>çš„<code>chunk</code>çš„å¤§å°</li>
</ul>
<h3 class="heading-element" id="åˆ©ç”¨åŸç†-14"><span>åˆ©ç”¨åŸç†</span>
  <a href="#%e5%88%a9%e7%94%a8%e5%8e%9f%e7%90%86-14" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p>è¿™ä¸ªæŠ€å·§è¢«ç§°ä¹‹ä¸º<code>steal heap from glibc</code>ã€‚ä¸»è¦çš„ç‚¹æœ‰ä»¥ä¸‹å‡ ä¸ªï¼š</p>
<ul>
<li><code>libc.so.6</code>æ˜ å°„çš„åœ°å€ç©ºé—´ï¼Œå‰é¢éƒ½æ˜¯ä¸ç¬¦å·è¡¨ã€å“ˆå¸Œè¡¨ã€å­—ç¬¦ä¸²è¡¨ç­‰é‡å®šä½æˆ–è€…è§£æå‡½æ•°åœ°å€æœ‰å…³ï¼Œå‰é¢ä¸€æ®µçš„æƒé™æ˜¯<code>r--</code></li>
<li><code>mmap(NULL, ...)</code>æ˜¯ä¼šåˆ†é…åˆ°<code>libc.so.6</code>çš„ä¸Šæ–¹çš„</li>
</ul>
<p>åŸºäºè¿™ä¸¤ä¸ªçŸ¥è¯†ç‚¹ï¼Œåˆ©ç”¨è¿‡ç¨‹å¦‚ä¸‹ï¼š</p>
<ul>
<li>ç”³è¯·<code>chunk A</code>ï¼Œå‡è®¾ä¸º<code>0x40000</code>å¤§å°ï¼Œåˆ™ä¼šèµ°<code>mmap</code>ç”³è¯·ï¼Œå¹¶ä¸”ç”³è¯·åˆ°<code>libc.so.6</code>çš„ä¸Šæ–¹</li>
<li>ä¿®æ”¹<code>chunk A</code>çš„å¤§å°ä¸º<code>0x45000</code>ï¼Œè®¾ç½®<code>MMAP</code>æ ‡å¿—ä½</li>
<li>é‡Šæ”¾<code>chunk A</code>ï¼Œåˆ™ä¼šæŠŠ<code>libc.so.6</code>çš„<code>0x5000</code>çš„å†…å­˜ä¹Ÿé‡Šæ”¾æ‰</li>
<li>å†æ¬¡ç”³è¯·<code>0x45000</code>ï¼Œå°±å¯ä»¥æ§åˆ¶<code>libc.so.6</code>åŸæ¥çš„ç¬¦å·è¡¨ã€å“ˆå¸Œè¡¨ç­‰ç­‰</li>
<li>è§¦å‘ä¸€æ¬¡<code>dl_runtime_resolve</code>ç­‰å°±èƒ½æ§åˆ¶ç¨‹åºæ‰§è¡Œä»»æ„ä»£ç </li>
</ul>
<h3 class="heading-element" id="ç›¸å…³æŠ€å·§-14"><span>ç›¸å…³æŠ€å·§</span>
  <a href="#%e7%9b%b8%e5%85%b3%e6%8a%80%e5%b7%a7-14" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><ul>
<li>éœ€è¦ä¼ªé€ çš„ç¬¦å·è¡¨ã€å“ˆå¸Œè¡¨ç­‰éœ€è¦é€æ­¥è°ƒè¯•</li>
<li>å¯ä»¥æ‰©å±•ä¸º<code>steal heap from everywhere</code></li>
</ul>
<h3 class="heading-element" id="åˆ©ç”¨æ•ˆæœ-14"><span>åˆ©ç”¨æ•ˆæœ</span>
  <a href="#%e5%88%a9%e7%94%a8%e6%95%88%e6%9e%9c-14" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><ul>
<li>ä»»æ„ä»£ç æ‰§è¡Œ</li>
</ul>
<h2 class="heading-element" id="216-house-of-botcake"><span>2.16-House of Botcake</span>
  <a href="#216-house-of-botcake" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><h3 class="heading-element" id="æ¼æ´æˆå› -15"><span>æ¼æ´æˆå› </span>
  <a href="#%e6%bc%8f%e6%b4%9e%e6%88%90%e5%9b%a0-15" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p><code>double free</code></p>
<h3 class="heading-element" id="é€‚ç”¨èŒƒå›´-15"><span>é€‚ç”¨èŒƒå›´</span>
  <a href="#%e9%80%82%e7%94%a8%e8%8c%83%e5%9b%b4-15" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><ul>
<li><code>2.26</code>â€”â€”è‡³ä»Š</li>
<li>å¤šæ¬¡é‡Šæ”¾<code>chunk</code>çš„èƒ½åŠ›</li>
</ul>
<h3 class="heading-element" id="åˆ©ç”¨åŸç†-15"><span>åˆ©ç”¨åŸç†</span>
  <a href="#%e5%88%a9%e7%94%a8%e5%8e%9f%e7%90%86-15" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p>è¯¥æŠ€å·§å¯ä»¥ç”¨äºç»•è¿‡<code>tcache-&gt;key</code>çš„æ£€æŸ¥ï¼Œåˆ©ç”¨è¿‡ç¨‹å¦‚ä¸‹ï¼š</p>
<ul>
<li>ç”³è¯·<code>7</code>ä¸ªå¤§å°ç›¸åŒï¼Œå¤§å°å¤§äº<code>0x80</code>çš„<code>chunk</code>ï¼Œå†ç”³è¯·ä¸‰ä¸ªï¼Œåˆ†åˆ«ä¸º<code>chunk A</code>å’Œ<code>chunkB</code>å’Œ<code>chunk C</code></li>
<li>é‡Šæ”¾å‰<code>7</code>ä¸ªå’Œ<code>chunk A</code>ï¼Œå‰é¢<code>7</code>ä¸ªéƒ½ä¼šè¿›å…¥åˆ°<code>tcachebin</code>é‡Œé¢ï¼Œ<code>chunk A</code>è¿›å…¥åˆ°<code>unsortedbin</code></li>
<li>é‡Šæ”¾<code>chunk B</code>ï¼Œåˆ™<code>chunk B</code>ä¼šå’Œ<code>chunk A</code>åˆå¹¶</li>
<li>ä»<code>tcachebin</code>åˆ†é…èµ°ä¸€ä¸ª</li>
<li>å†æ¬¡é‡Šæ”¾<code>chunk B</code>ï¼Œæ­¤æ—¶<code>B</code>åŒæ—¶å­˜åœ¨ä¸<code>unsortedbin</code>å’Œ<code>tcachebin</code></li>
</ul>
<h3 class="heading-element" id="ç›¸å…³æŠ€å·§-15"><span>ç›¸å…³æŠ€å·§</span>
  <a href="#%e7%9b%b8%e5%85%b3%e6%8a%80%e5%b7%a7-15" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><ul>
<li>åœ¨é«˜ç‰ˆæœ¬éœ€è¦ç»•è¿‡æŒ‡é’ˆä¿æŠ¤çš„æ£€æŸ¥</li>
</ul>
<h3 class="heading-element" id="åˆ©ç”¨æ•ˆæœ-15"><span>åˆ©ç”¨æ•ˆæœ</span>
  <a href="#%e5%88%a9%e7%94%a8%e6%95%88%e6%9e%9c-15" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><ul>
<li>æ„é€ å‡ºå †é‡å ï¼Œä¸ºåç»­åˆ©ç”¨åšå‡†å¤‡</li>
</ul>
<h2 class="heading-element" id="217-house-of-rust"><span>2.17-House of Rust</span>
  <a href="#217-house-of-rust" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><h3 class="heading-element" id="æ¼æ´æˆå› -16"><span>æ¼æ´æˆå› </span>
  <a href="#%e6%bc%8f%e6%b4%9e%e6%88%90%e5%9b%a0-16" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p>å †æº¢å‡º</p>
<h3 class="heading-element" id="é€‚ç”¨èŒƒå›´-16"><span>é€‚ç”¨èŒƒå›´</span>
  <a href="#%e9%80%82%e7%94%a8%e8%8c%83%e5%9b%b4-16" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><ul>
<li><code>2.26</code>â€”â€”è‡³ä»Š</li>
<li>å¯ä»¥è¿›è¡Œ<code>tcache stash unlinking</code>æ”»å‡»</li>
<li>å¯ä»¥è¿›è¡Œ<code>largebin attack</code></li>
<li>ä¸éœ€è¦æ³„éœ²åœ°å€</li>
</ul>
<h3 class="heading-element" id="åˆ©ç”¨åŸç†-16"><span>åˆ©ç”¨åŸç†</span>
  <a href="#%e5%88%a9%e7%94%a8%e5%8e%9f%e7%90%86-16" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p>åŸä½œè€…çš„åšå®¢å†™å¾—å¾ˆå¤æ‚ï¼Œæˆ‘è¿™é‡Œæç‚¼å‡ºå…³é”®ä¿¡æ¯ã€‚è¯¥æŠ€å·§å°±æ˜¯<code>tcachebin stash unlinking</code>+<code>largebin attack</code>çš„ç»„åˆæŠ€å·§ã€‚</p>
<p>é¦–å…ˆéœ€è¦çŸ¥é“<code>tcachebin stash unlinking</code>ï¼Œä¸‹é¢ç§°ä¹‹ä¸º<code>TSU</code>æŠ€å·§ï¼š</p>
<ul>
<li><code>tcachebin[A]</code>ä¸ºç©º</li>
<li><code>smallbin[A]</code>æœ‰<code>8</code>ä¸ª</li>
<li>ä¿®æ”¹ç¬¬<code>8</code>ä¸ª<code>smallbin chunk</code>çš„<code>bk</code>ä¸º<code>addr</code></li>
<li>åˆ†é…<code>malloc(A)</code>çš„æ—¶å€™ï¼Œ<code>addr+0x10</code>ä¼šè¢«å†™ä¸€ä¸ª<code>libc</code>åœ°å€</li>
</ul>
<p>è¿˜è¦çŸ¥é“<code>tcachebin stash unlinking+</code>ï¼Œä¸‹é¢ç§°ä¹‹ä¸º<code>TSU+</code>æŠ€å·§ï¼š</p>
<ul>
<li><code>tcachebin[A]</code>ä¸ºç©º</li>
<li><code>smallbin[A]</code>æœ‰<code>8</code>ä¸ª</li>
<li>ä¿®æ”¹ç¬¬<code>7</code>ä¸ª<code>smallbin chunk</code>çš„<code>bk</code>ä¸º<code>addr</code>ï¼Œè¿˜è¦ä¿è¯<code>addr+0x18</code>æ˜¯ä¸€ä¸ªåˆæ³•å¯å†™çš„åœ°å€</li>
<li>åˆ†é…<code>malloc(A)</code>çš„æ—¶å€™ï¼Œ<code>addr</code>ä¼šè¢«é“¾å…¥åˆ°<code>tcachebin</code>ï¼Œä¹Ÿå°±æ˜¯å¯ä»¥åˆ†é…åˆ°<code>addr</code>å¤„</li>
</ul>
<p>ä»¥<code>0x90</code>å¤§å°çš„<code>chunk</code>ä¸ºä¾‹ï¼Œæ­¤æ—¶çš„<code>tcache_key</code>è¿˜æ˜¯æŒ‡å‘<code>tcache_perthread_struct + 0x10</code>çš„ï¼š</p>
<ul>
<li>ç¬¬ä¸€æ­¥ï¼ŒæŠŠ<code>tcachebin[0x90]</code>å¡«æ»¡ï¼ŒæŠŠ<code>smallbin[0x90]</code>ä¹Ÿå¡«æ»¡</li>
<li>ç¬¬äºŒæ­¥ï¼ŒæŠŠæœ€åä¸€ä¸ª<code>smallbin 0x90</code>çš„<code>chunk</code>çš„<code>size</code>æ”¹æˆ<code>0xb0</code>ï¼Œå°†å…¶é‡Šæ”¾åˆ°<code>tcachebin[0xb0]</code>ï¼Œè¿™ä¸€æ­¥ä¸»è¦æ˜¯ä¸ºäº†æ”¹å˜å…¶<code>bk</code>æŒ‡å‘<code>tcache_perthread_struct + 0x10</code>ï¼Œå¯ä»¥éƒ¨åˆ†ä¿®æ”¹ä½ä½çš„å­—èŠ‚ï¼Œä»¥ä¾¿ä¸‹ä¸€æ­¥åˆ†é…åˆ°ç›®æ ‡åŒºåŸŸ</li>
<li>ç¬¬ä¸‰æ­¥ï¼Œä½¿ç”¨<code>largebin attack</code>å¾€ä¸Šä¸€æ­¥çš„<code>bk-&gt;bk</code>å†™ä¸€ä¸ªåˆæ³•åœ°å€ï¼Œç„¶åè€—å°½<code>tcachebin[0x90]</code>ï¼Œå†åˆ†é…çš„æ—¶å€™å°±ä¼šè§¦å‘<code>TSU+</code>ï¼Œä¹‹åå°±èƒ½åˆ†é…åˆ°<code>tcache_perthread_struct </code>ç»“æ„ä½“</li>
<li>ç¬¬å››æ­¥ï¼Œè¿˜æ˜¯å †é£æ°´ï¼Œä½†æ˜¯ç”¨<code>TSU</code>æŠ€æœ¯ï¼Œåœ¨<code>tcache_perthread_struct</code>ä¸Šå†™ä¸€ä¸ª<code>libc</code>åœ°å€ï¼ˆæ¯”å‰é¢ä¸€æ­¥è¦ç®€å•å¾ˆå¤šï¼‰</li>
<li>ç¬¬äº”æ­¥ï¼Œé€šè¿‡æ§åˆ¶<code>tcache_perthread_struct</code>ç»“æ„ä½“ï¼Œéƒ¨åˆ†å†™ä¸Šé¢çš„<code>libc</code>åœ°å€ï¼Œåˆ†é…åˆ°<code>stdout</code>ç»“æ„ä½“ï¼Œæ³„éœ²ä¿¡æ¯</li>
<li>ç¬¬å…­æ­¥ï¼Œé€šè¿‡æ§åˆ¶<code>tcache_perthread_struct</code>ç»“æ„ä½“åˆ†é…åˆ°ä»»æ„åœ°å€</li>
</ul>
<p>ä¸Šé¢çš„è¿‡ç¨‹æœ€å¥½çš„æƒ…å†µä¸‹éœ€è¦çˆ†ç ´<code>1/16</code>ï¼Œæœ€å·®<code>1/256</code>ã€‚</p>
<p>ä½†æ˜¯ï¼Œ<code>2.34</code>ä¹‹åï¼Œ<code>tcache_key</code>æ˜¯ä¸€ä¸ªéšæœºæ•°ï¼Œä¸æ˜¯<code>tcache_perthread_struct + 0x10</code>äº†ã€‚</p>
<p>æ‰€ä»¥ï¼Œæ­¤æ—¶å¯ä»¥åŠ ä¸Š<code>largebin attack</code>ï¼ŒæŠŠä»¥ä¸Šçš„ç¬¬äºŒæ­¥å˜ä¸ºï¼šç»§ç»­ç”¨<code>largebin attack</code>å‘å…¶<code>bk</code>å†™ä¸€ä¸ªå †åœ°å€ï¼Œç„¶åè¿˜è¦éƒ¨åˆ†å†™<code>bk</code>ä½¿å…¶è½åœ¨<code>tcache_perthread_struct</code>åŒºåŸŸã€‚å…¶ä»–æ­¥éª¤ä¸€æ ·ã€‚</p>
<p>æˆ–è€…ï¼Œåœ¨<code>smallbin</code>é‡Œé¢æ”¾<code>9</code>ä¸ªï¼Œè¿™æ ·ç¬¬<code>8</code>ä¸ªçš„<code>bk</code>è‚¯å®šå°±æ˜¯ä¸€ä¸ªå †åœ°å€ã€‚æ­¤æ—¶å°±éœ€è¦çˆ†ç ´<code>1/16</code>çš„å †ï¼Œ<code>1/16</code>çš„<code>glibc</code>åœ°å€ï¼ŒæˆåŠŸçš„æ¦‚ç‡æ˜¯<code>1/256</code>ã€‚</p>
<h3 class="heading-element" id="ç›¸å…³æŠ€å·§-16"><span>ç›¸å…³æŠ€å·§</span>
  <a href="#%e7%9b%b8%e5%85%b3%e6%8a%80%e5%b7%a7-16" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><ul>
<li>æ€»çš„æ¥è¯´ï¼Œå°±æ˜¯åˆ©ç”¨<code>tcachebin stash unlinking</code>æ‰“<code>tcache_perthread_struct</code></li>
<li>åˆ©ç”¨<code>largebin attack</code>æ„é€ åˆæ³•åœ°å€</li>
</ul>
<h3 class="heading-element" id="åˆ©ç”¨æ•ˆæœ-16"><span>åˆ©ç”¨æ•ˆæœ</span>
  <a href="#%e5%88%a9%e7%94%a8%e6%95%88%e6%9e%9c-16" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><ul>
<li>ä»»æ„åœ°å€åˆ†é…</li>
<li>ä»»æ„å‡½æ•°æ‰§è¡Œ</li>
</ul>
<h2 class="heading-element" id="218-house-of-crust"><span>2.18-House of Crust</span>
  <a href="#218-house-of-crust" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><h3 class="heading-element" id="æ¼æ´æˆå› -17"><span>æ¼æ´æˆå› </span>
  <a href="#%e6%bc%8f%e6%b4%9e%e6%88%90%e5%9b%a0-17" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p>å †æº¢å‡º</p>
<h3 class="heading-element" id="é€‚ç”¨èŒƒå›´-17"><span>é€‚ç”¨èŒƒå›´</span>
  <a href="#%e9%80%82%e7%94%a8%e8%8c%83%e5%9b%b4-17" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><ul>
<li><code>2.26</code>â€”â€”<code>2.37</code></li>
<li>å¯ä»¥è¿›è¡Œ<code>tcache stash unlinking</code>æ”»å‡»</li>
<li>å¯ä»¥è¿›è¡Œ<code>largebin attack</code></li>
<li>ä¸éœ€è¦æ³„éœ²åœ°å€</li>
</ul>
<h3 class="heading-element" id="åˆ©ç”¨åŸç†-17"><span>åˆ©ç”¨åŸç†</span>
  <a href="#%e5%88%a9%e7%94%a8%e5%8e%9f%e7%90%86-17" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p>å…¶ä»–æ­¥éª¤å’Œä¸Šé¢çš„<code>house of rust</code>ä¸€æ ·ï¼Œä½†æ˜¯åˆ°ç¬¬äº”æ­¥çš„æ—¶å€™ï¼Œå»ä¿®æ”¹<code>global_max_fast</code></p>
<p>åé¢çš„æ­¥éª¤å’Œ<code>house of corrosion</code>æ˜¯ä¸€æ ·çš„ï¼Œé€šè¿‡å†™åŸè¯­æ‰“<code>stderr</code>ä¿®æ”¹<code>one_gadget</code>æ‹¿åˆ°<code>shell</code>ã€‚</p>
<h3 class="heading-element" id="ç›¸å…³æŠ€å·§-17"><span>ç›¸å…³æŠ€å·§</span>
  <a href="#%e7%9b%b8%e5%85%b3%e6%8a%80%e5%b7%a7-17" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><ul>
<li><code>house of crust = house of corrosion + house of rust</code></li>
<li><code>2.37</code>ä¹‹åï¼Œ<code>house of corrosion</code>ä½¿ç”¨å—é™</li>
</ul>
<h2 class="heading-element" id="219-house-of-io"><span>2.19-House of Io</span>
  <a href="#219-house-of-io" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><h3 class="heading-element" id="æ¼æ´æˆå› -18"><span>æ¼æ´æˆå› </span>
  <a href="#%e6%bc%8f%e6%b4%9e%e6%88%90%e5%9b%a0-18" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p>å †æº¢å‡º</p>
<h3 class="heading-element" id="é€‚ç”¨èŒƒå›´-18"><span>é€‚ç”¨èŒƒå›´</span>
  <a href="#%e9%80%82%e7%94%a8%e8%8c%83%e5%9b%b4-18" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><ul>
<li><code>2.26</code>â€”â€”è‡³ä»Š</li>
</ul>
<h3 class="heading-element" id="åˆ©ç”¨åŸç†-18"><span>åˆ©ç”¨åŸç†</span>
  <a href="#%e5%88%a9%e7%94%a8%e5%8e%9f%e7%90%86-18" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p>å…¶ä»–åšå®¢ä¸Šå¯¹è¯¥æ–¹æ³•çš„ä»‹ç»å¦‚ä¸‹ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">The tcache_perthread_object is allocated when the heap is created. Furthermore, it is stored right at the heap&#39;s beginning (at a relatively low memory address). The safe-linking mitigation aims to protect the fd/next pointer within the free lists. However, the head of each free-list is not protected. Additionally, freeing a chunk and placing it into the tcachebin also places a non-protected pointer to the appropriate tcache entry in the 2nd qword of a chunks&#39; user data. The House of IO assumes one of three scenarios for the bypass to work. First, any attacker with a controlled linear buffer underflow over a heap buffer, or a relative arbitrary write will be able to corrupt the tcache. Secondly, a UAF bug allowing to read from a freed tcache eligible chunk leaks the tcache and with that, the heap base. Thirdly, a badly ordered set of calls to free(), ultimately passing the address of the tcache itself to free, would link the tcache into the 0x290 sized tcachebin. Allocating it as a new chunk would mean complete control over the tcache&#39;s values.</span></span></code></pre></td></tr></table>
</div>
</div><p>å¯ä»¥çœ‹å‡ºæ¥ï¼Œå…¶å®å°±æ˜¯å¯¹<code>tcache_perthread_struct</code>ç»“æ„ä½“çš„æ”»å‡»ï¼Œæƒ³åŠæ³•å°†å…¶é‡Šæ”¾æ‰ï¼Œç„¶åå†ç”³è¯·å›æ¥ï¼Œç”³è¯·å›æ¥çš„æ—¶å€™å°±èƒ½æ§åˆ¶æ•´ä¸ª<code>tcache</code>çš„åˆ†é…ã€‚</p>
<h3 class="heading-element" id="ç›¸å…³æŠ€å·§-18"><span>ç›¸å…³æŠ€å·§</span>
  <a href="#%e7%9b%b8%e5%85%b3%e6%8a%80%e5%b7%a7-18" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><ul>
<li>å›´ç»•<code>tcache_perthread_struct</code>è¿›è¡Œæ”»å‡»</li>
</ul>
<h3 class="heading-element" id="åˆ©ç”¨æ•ˆæœ-17"><span>åˆ©ç”¨æ•ˆæœ</span>
  <a href="#%e5%88%a9%e7%94%a8%e6%95%88%e6%9e%9c-17" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><ul>
<li>ä»»æ„åœ°å€åˆ†é…</li>
</ul>
<h2 class="heading-element" id="220-house-of-banana"><span>2.20-House of Banana</span>
  <a href="#220-house-of-banana" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><h3 class="heading-element" id="æ¼æ´æˆå› -19"><span>æ¼æ´æˆå› </span>
  <a href="#%e6%bc%8f%e6%b4%9e%e6%88%90%e5%9b%a0-19" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p>å †æº¢å‡º</p>
<h3 class="heading-element" id="é€‚ç”¨èŒƒå›´-19"><span>é€‚ç”¨èŒƒå›´</span>
  <a href="#%e9%80%82%e7%94%a8%e8%8c%83%e5%9b%b4-19" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><ul>
<li><code>2.23</code>â€”â€”è‡³ä»Š</li>
<li>å¯ä»¥è¿›è¡Œ<code>largebin attack</code></li>
<li>èƒ½æ‰§è¡Œ<code>exit</code>å‡½æ•°</li>
</ul>
<h3 class="heading-element" id="åˆ©ç”¨åŸç†-19"><span>åˆ©ç”¨åŸç†</span>
  <a href="#%e5%88%a9%e7%94%a8%e5%8e%9f%e7%90%86-19" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p>é¦–å…ˆæ˜¯<code>largebin attack</code>åœ¨é«˜ç‰ˆæœ¬åªèƒ½ä»ä¸‹é¢è¿™ä¸ªåˆ†æ”¯åˆ©ç”¨ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="cm">/* maintain large bins in sorted order */</span>
</span></span><span class="line"><span class="cl">              <span class="k">if</span> <span class="p">(</span><span class="n">fwd</span> <span class="o">!=</span> <span class="n">bck</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                  <span class="cm">/* Or with inuse bit to speed comparisons */</span>
</span></span><span class="line"><span class="cl">                  <span class="n">size</span> <span class="o">|=</span> <span class="n">PREV_INUSE</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                  <span class="cm">/* if smaller than smallest, bypass loop below */</span>
</span></span><span class="line"><span class="cl">                  <span class="nf">assert</span> <span class="p">(</span><span class="nf">chunk_main_arena</span> <span class="p">(</span><span class="n">bck</span><span class="o">-&gt;</span><span class="n">bk</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">                  <span class="k">if</span> <span class="p">((</span><span class="kt">unsigned</span> <span class="kt">long</span><span class="p">)</span> <span class="p">(</span><span class="n">size</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		      <span class="o">&lt;</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span><span class="p">)</span> <span class="nf">chunksize_nomask</span> <span class="p">(</span><span class="n">bck</span><span class="o">-&gt;</span><span class="n">bk</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span>
</span></span><span class="line"><span class="cl">                      <span class="n">fwd</span> <span class="o">=</span> <span class="n">bck</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                      <span class="n">bck</span> <span class="o">=</span> <span class="n">bck</span><span class="o">-&gt;</span><span class="n">bk</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                      <span class="n">victim</span><span class="o">-&gt;</span><span class="n">fd_nextsize</span> <span class="o">=</span> <span class="n">fwd</span><span class="o">-&gt;</span><span class="n">fd</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                      <span class="n">victim</span><span class="o">-&gt;</span><span class="n">bk_nextsize</span> <span class="o">=</span> <span class="n">fwd</span><span class="o">-&gt;</span><span class="n">fd</span><span class="o">-&gt;</span><span class="n">bk_nextsize</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                      <span class="n">fwd</span><span class="o">-&gt;</span><span class="n">fd</span><span class="o">-&gt;</span><span class="n">bk_nextsize</span> <span class="o">=</span> <span class="n">victim</span><span class="o">-&gt;</span><span class="n">bk_nextsize</span><span class="o">-&gt;</span><span class="n">fd_nextsize</span> <span class="o">=</span> <span class="n">victim</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                    <span class="p">}</span>
</span></span><span class="line"><span class="cl">                  <span class="k">else</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span>
</span></span><span class="line"><span class="cl">                      <span class="c1">//......
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                  <span class="p">}</span>
</span></span><span class="line"><span class="cl">                  <span class="c1">//......
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>              <span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><p>ä¹Ÿå°±æ˜¯ï¼ŒåŒé“¾è¡¨é‡Œé¢è‡³å°‘å­˜åœ¨ä¸€ä¸ª<code>largebin chunk</code>ï¼Œä¸”ç›®å‰è¦å…¥é“¾çš„<code>chunk</code>æ¯”æœ€å°çš„è¿˜å°ï¼Œä¿®æ”¹äº†<code>bk_nextsize</code>ä¹‹åå°±ä¼šè§¦å‘ã€‚å¯ä»¥é€ æˆä»»æ„åœ°å€å†™å †åœ°å€ã€‚</p>
<p>ç„¶åæ˜¯<code>exit</code>è°ƒç”¨çš„æ—¶å€™ï¼Œä¼šè°ƒç”¨åˆ°<code>_dl_fini</code>å‡½æ•°ï¼Œæ‰§è¡Œæ¯ä¸ª<code>so</code>ä¸­æ³¨å†Œçš„<code>fini</code>å‡½æ•°ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">nmaps</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">struct</span> <span class="n">link_map</span> <span class="o">*</span><span class="n">l</span> <span class="o">=</span> <span class="n">maps</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">l</span><span class="o">-&gt;</span><span class="n">l_init_called</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="cm">/* Make sure nothing happens if we are called twice.  */</span>
</span></span><span class="line"><span class="cl">        <span class="n">l</span><span class="o">-&gt;</span><span class="n">l_init_called</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="cm">/* Is there a destructor function?  */</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">l</span><span class="o">-&gt;</span><span class="n">l_info</span><span class="p">[</span><span class="n">DT_FINI_ARRAY</span><span class="p">]</span> <span class="o">!=</span> <span class="nb">NULL</span>
</span></span><span class="line"><span class="cl">            <span class="o">||</span> <span class="p">(</span><span class="n">ELF_INITFINI</span> <span class="o">&amp;&amp;</span> <span class="n">l</span><span class="o">-&gt;</span><span class="n">l_info</span><span class="p">[</span><span class="n">DT_FINI</span><span class="p">]</span> <span class="o">!=</span> <span class="nb">NULL</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="cm">/* When debugging print a message first.  */</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="nf">__builtin_expect</span> <span class="p">(</span><span class="nf">GLRO</span><span class="p">(</span><span class="n">dl_debug_mask</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                                  <span class="o">&amp;</span> <span class="n">DL_DEBUG_IMPCALLS</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">                <span class="nf">_dl_debug_printf</span> <span class="p">(</span><span class="s">&#34;</span><span class="se">\n</span><span class="s">calling fini: %s [%lu]</span><span class="se">\n\n</span><span class="s">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                                  <span class="nf">DSO_FILENAME</span> <span class="p">(</span><span class="n">l</span><span class="o">-&gt;</span><span class="n">l_name</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">                                  <span class="n">ns</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="cm">/* First see whether an array is given.  */</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="n">l</span><span class="o">-&gt;</span><span class="n">l_info</span><span class="p">[</span><span class="n">DT_FINI_ARRAY</span><span class="p">]</span> <span class="o">!=</span> <span class="nb">NULL</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nf">ElfW</span><span class="p">(</span><span class="n">Addr</span><span class="p">)</span> <span class="o">*</span><span class="n">array</span> <span class="o">=</span>
</span></span><span class="line"><span class="cl">                    <span class="p">(</span><span class="nf">ElfW</span><span class="p">(</span><span class="n">Addr</span><span class="p">)</span> <span class="o">*</span><span class="p">)</span> <span class="p">(</span><span class="n">l</span><span class="o">-&gt;</span><span class="n">l_addr</span>
</span></span><span class="line"><span class="cl">                                    <span class="o">+</span> <span class="n">l</span><span class="o">-&gt;</span><span class="n">l_info</span><span class="p">[</span><span class="n">DT_FINI_ARRAY</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">d_un</span><span class="p">.</span><span class="n">d_ptr</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="p">(</span><span class="n">l</span><span class="o">-&gt;</span><span class="n">l_info</span><span class="p">[</span><span class="n">DT_FINI_ARRAYSZ</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">d_un</span><span class="p">.</span><span class="n">d_val</span>
</span></span><span class="line"><span class="cl">                                  <span class="o">/</span> <span class="k">sizeof</span> <span class="p">(</span><span class="nf">ElfW</span><span class="p">(</span><span class="n">Addr</span><span class="p">)));</span>
</span></span><span class="line"><span class="cl">                <span class="k">while</span> <span class="p">(</span><span class="n">i</span><span class="o">--</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                    <span class="p">((</span><span class="kt">fini_t</span><span class="p">)</span> <span class="n">array</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="p">();</span> <span class="c1">// è¿™é‡Œcall
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="cm">/* Next try the old-style destructor.  */</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="n">ELF_INITFINI</span> <span class="o">&amp;&amp;</span> <span class="n">l</span><span class="o">-&gt;</span><span class="n">l_info</span><span class="p">[</span><span class="n">DT_FINI</span><span class="p">]</span> <span class="o">!=</span> <span class="nb">NULL</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="nf">DL_CALL_DT_FINI</span>
</span></span><span class="line"><span class="cl">                <span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">l</span><span class="o">-&gt;</span><span class="n">l_addr</span> <span class="o">+</span> <span class="n">l</span><span class="o">-&gt;</span><span class="n">l_info</span><span class="p">[</span><span class="n">DT_FINI</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">d_un</span><span class="p">.</span><span class="n">d_ptr</span><span class="p">);</span> <span class="c1">// è¿™é‡Œcall
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><p>å¯ä»¥è§¦å‘<code>call</code>çš„æœ‰ä¸¤ä¸ªç‚¹ï¼Œç¬¬ä¸€ä¸ªç‚¹å¯ä»¥<code>call</code>åˆ°å¾ˆå¤šæŒ‡é’ˆï¼Œæ˜¯ä¸€ä¸ªæ•°ç»„ï¼›å¦ä¸€ä¸ªç‚¹å°±åªæœ‰ä¸€ä¸ªå‡½æ•°ã€‚</p>
<p>å‰©ä¸‹çš„å·¥ä½œå°±æ˜¯æ ¹æ®ä»£ç ç»•è¿‡æ£€æµ‹ï¼Œè°ƒç”¨åˆ°è°ƒç”¨ç‚¹ã€‚</p>
<p>æ‰€ä»¥ï¼Œåˆ©ç”¨çš„æ€è·¯æœ‰ï¼š</p>
<ul>
<li>ç›´æ¥ä¼ªé€ <code>_rtld_global</code>çš„<code>_ns_loaded</code>ï¼Œå¸ƒå±€å¥½å…¶ä»–å†…å®¹ï¼Œä½¿å…¶è°ƒç”¨åˆ°<code>fini_array</code></li>
<li>ä¼ªé€ <code>link_map</code>çš„<code>next</code>æŒ‡é’ˆï¼Œå¸ƒå±€å¥½å…¶ä»–å†…å®¹ï¼Œä½¿å…¶è°ƒç”¨åˆ°<code>fini_array</code></li>
<li>ä¿®æ”¹<code>link_map-&gt;l_addr</code>ï¼Œæ ¹æ®åç§»ä½¿å…¶è°ƒç”¨åˆ°æŒ‡å®šåŒºåŸŸçš„å‡½æ•°</li>
</ul>
<h3 class="heading-element" id="ç›¸å…³æŠ€å·§-19"><span>ç›¸å…³æŠ€å·§</span>
  <a href="#%e7%9b%b8%e5%85%b3%e6%8a%80%e5%b7%a7-19" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><ul>
<li>ä¼ªé€ <code>fini_array</code>æ•°ç»„çš„æ—¶å€™ï¼Œæ˜¯ä»åå¾€å‰éå†çš„</li>
<li>æœ‰æ—¶å€™è¿œç¨‹çš„<code>rtld_global</code>çš„åç§»ä¸æœ¬åœ°ä¸ä¸€æ ·ï¼Œéœ€è¦çˆ†ç ´</li>
<li>å¦‚æœä¸æƒ³é€ä¸ªä¼ªé€ ï¼Œå¯ä»¥ç›´æ¥ç”¨<code>gdb</code>ä»å†…å­˜é‡Œé¢<code>dump</code>å‡ºæ¥ï¼Œç„¶ååŸºäºåç§»ä¿®æ”¹å†…å­˜å³å¯</li>
</ul>
<h3 class="heading-element" id="åˆ©ç”¨æ•ˆæœ-18"><span>åˆ©ç”¨æ•ˆæœ</span>
  <a href="#%e5%88%a9%e7%94%a8%e6%95%88%e6%9e%9c-18" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><ul>
<li>ä»»æ„ä»£ç æ‰§è¡Œ</li>
</ul>
<h2 class="heading-element" id="221-house-of-kiwi"><span>2.21-House of Kiwi</span>
  <a href="#221-house-of-kiwi" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><h3 class="heading-element" id="æ¼æ´æˆå› -20"><span>æ¼æ´æˆå› </span>
  <a href="#%e6%bc%8f%e6%b4%9e%e6%88%90%e5%9b%a0-20" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p>å †æº¢å‡º</p>
<h3 class="heading-element" id="é€‚ç”¨èŒƒå›´-20"><span>é€‚ç”¨èŒƒå›´</span>
  <a href="#%e9%80%82%e7%94%a8%e8%8c%83%e5%9b%b4-20" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><ul>
<li><code>2.23</code>â€”â€”<code>2.36</code></li>
<li>åœ¨<code>malloc</code>æµç¨‹ä¸­è§¦å‘<code>assert</code></li>
</ul>
<h3 class="heading-element" id="åˆ©ç”¨åŸç†-20"><span>åˆ©ç”¨åŸç†</span>
  <a href="#%e5%88%a9%e7%94%a8%e5%8e%9f%e7%90%86-20" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p>ä¸»è¦æ˜¯æä¾›äº†ä¸€ç§åœ¨ç¨‹åºä¸­è°ƒç”¨<code>IO</code>æµå‡½æ•°çš„æ€è·¯ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="cp">#if IS_IN (libc)
</span></span></span><span class="line"><span class="cl"><span class="cp">#ifndef NDEBUG
</span></span></span><span class="line"><span class="cl"><span class="cp"># define __assert_fail(assertion, file, line, function)			\
</span></span></span><span class="line"><span class="cl"><span class="cp">	 __malloc_assert(assertion, file, line, function)
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="k">extern</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">__progname</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">static</span> <span class="kt">void</span>
</span></span><span class="line"><span class="cl"><span class="nf">__malloc_assert</span> <span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">assertion</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">file</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">line</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">		 <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">function</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="nf">__fxprintf</span> <span class="p">(</span><span class="nb">NULL</span><span class="p">,</span> <span class="s">&#34;%s%s%s:%u: %s%sAssertion `%s&#39; failed.</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">		     <span class="n">__progname</span><span class="p">,</span> <span class="n">__progname</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">?</span> <span class="s">&#34;: &#34;</span> <span class="o">:</span> <span class="s">&#34;&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">		     <span class="n">file</span><span class="p">,</span> <span class="n">line</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">		     <span class="n">function</span> <span class="o">?</span> <span class="nl">function</span> <span class="p">:</span> <span class="s">&#34;&#34;</span><span class="p">,</span> <span class="n">function</span> <span class="o">?</span> <span class="s">&#34;: &#34;</span> <span class="o">:</span> <span class="s">&#34;&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">		     <span class="n">assertion</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">fflush</span> <span class="p">(</span><span class="n">stderr</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">abort</span> <span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="cp">#endif
</span></span></span><span class="line"><span class="cl"><span class="cp">#endif</span></span></span></code></pre></td></tr></table>
</div>
</div><p>å¯ä»¥çœ‹åˆ°ï¼Œè°ƒç”¨åˆ°äº†<code>fxprintf</code>å’Œ<code>fflush</code>ã€‚</p>
<p>è‡³äºåŸ<code>house of kiwi</code>æ‰€æåˆ°çš„æ§åˆ¶<code>rdx</code>çš„æ€è·¯ï¼Œåœ¨å¾ˆå¤šç‰ˆæœ¬ä¸­æ— æ³•ä½¿ç”¨ï¼Œå› ä¸º<code>IO_jumps_table</code>éƒ½æ˜¯ä¸å¯å†™çš„ï¼Œæ•…æ­¤å¤„ä¸å†è¯¦è¿°ã€‚</p>
<h3 class="heading-element" id="ç›¸å…³æŠ€å·§-20"><span>ç›¸å…³æŠ€å·§</span>
  <a href="#%e7%9b%b8%e5%85%b3%e6%8a%80%e5%b7%a7-20" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><ul>
<li>åœ¨<code>2.36</code>ä¹‹åï¼Œ<code>__malloc_assert</code>è¢«ä¿®æ”¹ä¸ºï¼š</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="n">_Noreturn</span> <span class="k">static</span> <span class="kt">void</span>
</span></span><span class="line"><span class="cl"><span class="nf">__malloc_assert</span> <span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">assertion</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">file</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">line</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">		 <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">function</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nf">__libc_message</span> <span class="p">(</span><span class="n">do_abort</span><span class="p">,</span> <span class="s">&#34;\
</span></span></span><span class="line"><span class="cl"><span class="s">Fatal glibc error: malloc assertion failure in %s: %s</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">		  <span class="n">function</span><span class="p">,</span> <span class="n">assertion</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">__builtin_unreachable</span> <span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><p>è€Œåœ¨<code>2.37</code>è¯¥å‡½æ•°ç›´æ¥è¢«åˆ æ‰äº†ã€‚</p>
<ul>
<li>
<p>å¦‚æœ<code>stderr</code>åœ¨<code>libc</code>ä¸Šï¼Œéœ€è¦ä¿®æ”¹è°ƒ<code>stderr</code>å¤„çš„æŒ‡é’ˆï¼Œä¹Ÿæœ‰å¯èƒ½åœ¨ç¨‹åºçš„åœ°å€ç©ºé—´ä¸Š</p>
</li>
<li>
<p>ä¼ªé€ çš„æŠ€å·§å¦‚ä¸‹ï¼Œè§¦å‘<code>fxprintf(stderrï¼Œ......)</code>ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">flags &amp; 0x8000çš„è¯ï¼Œä¸ç”¨ä¼ªé€ _lock
</span></span><span class="line"><span class="cl">flags &amp; ~(0x2 | 0x8) å¿…é¡»æˆç«‹ï¼Œé¿å…èµ°åˆ°unbufferedçš„æµç¨‹
</span></span><span class="line"><span class="cl">mode è®¾ç½®ä¸º0
</span></span><span class="line"><span class="cl">vtableé»˜è®¤è°ƒç”¨çš„æ˜¯åç§»0x38çš„å‡½æ•°ï¼Œå¦‚æœæƒ³åŠ«æŒä¸º_IO_xxx_overflowï¼Œéœ€è¦è®¾ç½®ä¸º_IO_xxx_jumps-0x20
</span></span><span class="line"><span class="cl">flags å¯ä»¥è®¾ç½®ä¸º&#34;  sh||&#34;ï¼Œå‰é¢æœ‰ä¸¤ä¸ªç©ºæ ¼ï¼Œæ­¤æ—¶è¿˜éœ€è¦è®¾ç½®_lockï¼Œä¸æƒ³è®¾ç½®_lockçš„æ—¶å€™ï¼Œflagså¯ä»¥ä¸º&#34;\x20\x80;sh||&#34;</span></span></code></pre></td></tr></table>
</div>
</div></li>
</ul>
<h3 class="heading-element" id="åˆ©ç”¨æ•ˆæœ-19"><span>åˆ©ç”¨æ•ˆæœ</span>
  <a href="#%e5%88%a9%e7%94%a8%e6%95%88%e6%9e%9c-19" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><ul>
<li>è§¦å‘<code>IO</code>å¤„ç†æµç¨‹ï¼Œä¸ºåç»­åˆ©ç”¨åšå‡†å¤‡</li>
</ul>
<h2 class="heading-element" id="222-house-of-emma"><span>2.22-House of Emma</span>
  <a href="#222-house-of-emma" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><h3 class="heading-element" id="æ¼æ´æˆå› -21"><span>æ¼æ´æˆå› </span>
  <a href="#%e6%bc%8f%e6%b4%9e%e6%88%90%e5%9b%a0-21" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p>å †æº¢å‡º</p>
<h3 class="heading-element" id="é€‚ç”¨èŒƒå›´-21"><span>é€‚ç”¨èŒƒå›´</span>
  <a href="#%e9%80%82%e7%94%a8%e8%8c%83%e5%9b%b4-21" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><ul>
<li><code>2.23</code>â€”â€”è‡³ä»Š</li>
<li>å¯ä»¥è¿›è¡Œä¸¤æ¬¡<code>largebin attack</code></li>
<li>æˆ–è€…å¯ä»¥è¿›è¡Œä¸¤æ¬¡ä»»æ„åœ°å€å†™å †åœ°å€</li>
<li>å¯ä»¥è§¦å‘<code>IO</code>æµæ“ä½œ</li>
</ul>
<h3 class="heading-element" id="åˆ©ç”¨åŸç†-21"><span>åˆ©ç”¨åŸç†</span>
  <a href="#%e5%88%a9%e7%94%a8%e5%8e%9f%e7%90%86-21" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p>åœ¨<code>_IO_cookie_jumps</code>ä¸­å­˜åœ¨ä¸€äº›<code>_IO_cookie_read</code>ç­‰å‡½æ•°ï¼Œå¦‚ä¸‹ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="k">static</span> <span class="kt">ssize_t</span>
</span></span><span class="line"><span class="cl"><span class="nf">_IO_cookie_read</span> <span class="p">(</span><span class="n">FILE</span> <span class="o">*</span><span class="n">fp</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">buf</span><span class="p">,</span> <span class="kt">ssize_t</span> <span class="n">size</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">struct</span> <span class="n">_IO_cookie_file</span> <span class="o">*</span><span class="n">cfile</span> <span class="o">=</span> <span class="p">(</span><span class="k">struct</span> <span class="n">_IO_cookie_file</span> <span class="o">*</span><span class="p">)</span> <span class="n">fp</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="kt">cookie_read_function_t</span> <span class="o">*</span><span class="n">read_cb</span> <span class="o">=</span> <span class="n">cfile</span><span class="o">-&gt;</span><span class="n">__io_functions</span><span class="p">.</span><span class="n">read</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="cp">#ifdef PTR_DEMANGLE
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>  <span class="nf">PTR_DEMANGLE</span> <span class="p">(</span><span class="n">read_cb</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="cp">#endif
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="n">read_cb</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="nf">read_cb</span> <span class="p">(</span><span class="n">cfile</span><span class="o">-&gt;</span><span class="n">__cookie</span><span class="p">,</span> <span class="n">buf</span><span class="p">,</span> <span class="n">size</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><p>å¯ä»¥çœ‹åˆ°æœ‰å‡½æ•°æŒ‡é’ˆçš„è°ƒç”¨ã€‚ä½†æ˜¯å¯¹å‡½æ•°æŒ‡é’ˆä½¿ç”¨<code>pointer_guard</code>è¿›è¡Œäº†åŠ å¯†ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="c1">#  define PTR_MANGLE(var)	asm (&#34;xorl %%gs:%c2, %0\n&#34;		      \</span>
</span></span><span class="line"><span class="cl">				     <span class="s2">&#34;roll $9, %0&#34;</span>			      \
</span></span><span class="line"><span class="cl">				     <span class="p">:</span> <span class="s2">&#34;=r&#34;</span> <span class="p">(</span><span class="k">var</span><span class="p">)</span>			      \
</span></span><span class="line"><span class="cl">				     <span class="p">:</span> <span class="s2">&#34;0&#34;</span> <span class="p">(</span><span class="k">var</span><span class="p">),</span>			      \
</span></span><span class="line"><span class="cl">				       <span class="s2">&#34;i&#34;</span> <span class="p">(</span><span class="n">offsetof</span> <span class="p">(</span><span class="n">tcbhead_t</span><span class="p">,</span>	      \
</span></span><span class="line"><span class="cl">						      <span class="n">pointer_guard</span><span class="p">)))</span>
</span></span><span class="line"><span class="cl"><span class="c1">#  define PTR_DEMANGLE(var)	asm (&#34;rorl $9, %0\n&#34;			      \</span>
</span></span><span class="line"><span class="cl">				     <span class="s2">&#34;xorl </span><span class="si">%%</span><span class="s2">gs:</span><span class="si">%c</span><span class="s2">2, %0&#34;</span>		      \
</span></span><span class="line"><span class="cl">				     <span class="p">:</span> <span class="s2">&#34;=r&#34;</span> <span class="p">(</span><span class="k">var</span><span class="p">)</span>			      \
</span></span><span class="line"><span class="cl">				     <span class="p">:</span> <span class="s2">&#34;0&#34;</span> <span class="p">(</span><span class="k">var</span><span class="p">),</span>			      \
</span></span><span class="line"><span class="cl">				       <span class="s2">&#34;i&#34;</span> <span class="p">(</span><span class="n">offsetof</span> <span class="p">(</span><span class="n">tcbhead_t</span><span class="p">,</span>	      \
</span></span><span class="line"><span class="cl">						      <span class="n">pointer_guard</span><span class="p">)))</span>
</span></span><span class="line"><span class="cl"><span class="c1"># endif</span></span></span></code></pre></td></tr></table>
</div>
</div><p>å¾ªç¯å³ç§»åï¼Œå†å¼‚æˆ–ã€‚</p>
<p>å› æ­¤ï¼Œåˆ©ç”¨æ€è·¯å¦‚ä¸‹ï¼š</p>
<ul>
<li>æˆªè‡³æŸä¸ª<code>IO_FILE</code>çš„æŒ‡é’ˆï¼ˆ<code>IO_list_all/stdxxx-&gt;chain</code>ç­‰éƒ½å¯ä»¥ï¼‰ä¸ºå †åœ°å€</li>
<li>å †ä¸Šä¼ªé€ <code>IO_FILE</code>ç»“æ„ï¼Œå…¶<code>vtable</code>æ›¿æ¢ä¸º<code>_IO_cookie_jumps+XX</code>ï¼Œ<code>XX</code>ä¸ºä¸€ä¸ªåç§»é‡</li>
<li>ä¼ªé€ å¥½å‡½æ•°æŒ‡é’ˆå’Œè°ƒç”¨å‚æ•°ï¼ŒæŒ‡é’ˆéœ€è¦å¾ªç¯å¼‚æˆ–å’ŒåŠ å¯†</li>
<li>è°ƒç”¨åˆ°<code>_IO_cookie_read</code>ç­‰å‡½æ•°ï¼Œè¿›è€Œæ‰§è¡Œä»»æ„å‡½æ•°</li>
</ul>
<h3 class="heading-element" id="ç›¸å…³æŠ€å·§-21"><span>ç›¸å…³æŠ€å·§</span>
  <a href="#%e7%9b%b8%e5%85%b3%e6%8a%80%e5%b7%a7-21" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><ul>
<li>
<p>å¸¸ç”¨çš„<code>gadget</code>æœ‰ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">;æ ˆè¿ç§»
</span></span><span class="line"><span class="cl">mov    rbp,QWORD PTR [rdi+0x48]
</span></span><span class="line"><span class="cl">mov    rax,QWORD PTR [rbp+0x18]
</span></span><span class="line"><span class="cl">lea    r13,[rbp+0x10]
</span></span><span class="line"><span class="cl">mov    DWORD PTR [rbp+0x10],0x0
</span></span><span class="line"><span class="cl">mov    rdi,r13
</span></span><span class="line"><span class="cl">call   QWORD PTR [rax+0x28]
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">; rdiè½¬rdx
</span></span><span class="line"><span class="cl">mov rdx, qword ptr [rdi + 8]
</span></span><span class="line"><span class="cl">mov qword ptr [rsp], rax
</span></span><span class="line"><span class="cl">call qword ptr [rdx + 0x20]</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p><code>pointer_guard</code>å°±åœ¨<code>canary</code>ä¸‹é¢ï¼Œåç§»å¯èƒ½éœ€è¦çˆ†ç ´</p>
</li>
</ul>
<h3 class="heading-element" id="åˆ©ç”¨æ•ˆæœ-20"><span>åˆ©ç”¨æ•ˆæœ</span>
  <a href="#%e5%88%a9%e7%94%a8%e6%95%88%e6%9e%9c-20" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><ul>
<li>ä»»æ„å‡½æ•°æ‰§è¡Œ</li>
</ul>
<h2 class="heading-element" id="223-house-of-pig"><span>2.23-House of Pig</span>
  <a href="#223-house-of-pig" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><h3 class="heading-element" id="æ¼æ´æˆå› -22"><span>æ¼æ´æˆå› </span>
  <a href="#%e6%bc%8f%e6%b4%9e%e6%88%90%e5%9b%a0-22" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p>å †æº¢å‡º</p>
<h3 class="heading-element" id="é€‚ç”¨èŒƒå›´-22"><span>é€‚ç”¨èŒƒå›´</span>
  <a href="#%e9%80%82%e7%94%a8%e8%8c%83%e5%9b%b4-22" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><ul>
<li><code>2.23</code>â€”â€”è‡³ä»Š</li>
<li>å¯ä»¥è¿›è¡Œ<code>largebin attack</code></li>
<li>å¯ä»¥è§¦å‘<code>IO</code>æµæ“ä½œ</li>
</ul>
<h3 class="heading-element" id="åˆ©ç”¨åŸç†-22"><span>åˆ©ç”¨åŸç†</span>
  <a href="#%e5%88%a9%e7%94%a8%e5%8e%9f%e7%90%86-22" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p>åœ¨<code>_IO_str_jumps</code>ä¸­ï¼Œå­˜åœ¨ç€<code>_IO_str_overflow</code>å‡½æ•°ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">int</span>
</span></span><span class="line"><span class="cl"><span class="nf">_IO_str_overflow</span> <span class="p">(</span><span class="n">FILE</span> <span class="o">*</span><span class="n">fp</span><span class="p">,</span> <span class="kt">int</span> <span class="n">c</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kt">int</span> <span class="n">flush_only</span> <span class="o">=</span> <span class="n">c</span> <span class="o">==</span> <span class="n">EOF</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="kt">size_t</span> <span class="n">pos</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="n">fp</span><span class="o">-&gt;</span><span class="n">_flags</span> <span class="o">&amp;</span> <span class="n">_IO_NO_WRITES</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="n">flush_only</span> <span class="o">?</span> <span class="mi">0</span> <span class="o">:</span> <span class="n">EOF</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">((</span><span class="n">fp</span><span class="o">-&gt;</span><span class="n">_flags</span> <span class="o">&amp;</span> <span class="n">_IO_TIED_PUT_GET</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="p">(</span><span class="n">fp</span><span class="o">-&gt;</span><span class="n">_flags</span> <span class="o">&amp;</span> <span class="n">_IO_CURRENTLY_PUTTING</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="n">fp</span><span class="o">-&gt;</span><span class="n">_flags</span> <span class="o">|=</span> <span class="n">_IO_CURRENTLY_PUTTING</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="n">fp</span><span class="o">-&gt;</span><span class="n">_IO_write_ptr</span> <span class="o">=</span> <span class="n">fp</span><span class="o">-&gt;</span><span class="n">_IO_read_ptr</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="n">fp</span><span class="o">-&gt;</span><span class="n">_IO_read_ptr</span> <span class="o">=</span> <span class="n">fp</span><span class="o">-&gt;</span><span class="n">_IO_read_end</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="n">pos</span> <span class="o">=</span> <span class="n">fp</span><span class="o">-&gt;</span><span class="n">_IO_write_ptr</span> <span class="o">-</span> <span class="n">fp</span><span class="o">-&gt;</span><span class="n">_IO_write_base</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="n">pos</span> <span class="o">&gt;=</span> <span class="p">(</span><span class="kt">size_t</span><span class="p">)</span> <span class="p">(</span><span class="nf">_IO_blen</span> <span class="p">(</span><span class="n">fp</span><span class="p">)</span> <span class="o">+</span> <span class="n">flush_only</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="k">if</span> <span class="p">(</span><span class="n">fp</span><span class="o">-&gt;</span><span class="n">_flags</span> <span class="o">&amp;</span> <span class="n">_IO_USER_BUF</span><span class="p">)</span> <span class="cm">/* not allowed to enlarge */</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="n">EOF</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="k">else</span>
</span></span><span class="line"><span class="cl">	<span class="p">{</span>
</span></span><span class="line"><span class="cl">	  <span class="kt">char</span> <span class="o">*</span><span class="n">new_buf</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	  <span class="kt">char</span> <span class="o">*</span><span class="n">old_buf</span> <span class="o">=</span> <span class="n">fp</span><span class="o">-&gt;</span><span class="n">_IO_buf_base</span><span class="p">;</span> <span class="c1">// è¦†ç›–åˆ°è¿™é‡Œ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	  <span class="kt">size_t</span> <span class="n">old_blen</span> <span class="o">=</span> <span class="nf">_IO_blen</span> <span class="p">(</span><span class="n">fp</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	  <span class="kt">size_t</span> <span class="n">new_size</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">old_blen</span> <span class="o">+</span> <span class="mi">100</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	  <span class="k">if</span> <span class="p">(</span><span class="n">new_size</span> <span class="o">&lt;</span> <span class="n">old_blen</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	    <span class="k">return</span> <span class="n">EOF</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	  <span class="n">new_buf</span> <span class="o">=</span> <span class="nf">malloc</span> <span class="p">(</span><span class="n">new_size</span><span class="p">);</span> <span class="c1">// è°ƒç”¨malloc
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	  <span class="k">if</span> <span class="p">(</span><span class="n">new_buf</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	    <span class="p">{</span>
</span></span><span class="line"><span class="cl">	      <span class="cm">/*	  __ferror(fp) = 1; */</span>
</span></span><span class="line"><span class="cl">	      <span class="k">return</span> <span class="n">EOF</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	    <span class="p">}</span>
</span></span><span class="line"><span class="cl">	  <span class="k">if</span> <span class="p">(</span><span class="n">old_buf</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	    <span class="p">{</span>
</span></span><span class="line"><span class="cl">	      <span class="nf">memcpy</span> <span class="p">(</span><span class="n">new_buf</span><span class="p">,</span> <span class="n">old_buf</span><span class="p">,</span> <span class="n">old_blen</span><span class="p">);</span><span class="c1">// è°ƒç”¨memecpyï¼Œè¦†ç›–
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	      <span class="nf">free</span> <span class="p">(</span><span class="n">old_buf</span><span class="p">);</span> <span class="c1">// è°ƒç”¨free
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	      <span class="cm">/* Make sure _IO_setb won&#39;t try to delete _IO_buf_base. */</span>
</span></span><span class="line"><span class="cl">	      <span class="n">fp</span><span class="o">-&gt;</span><span class="n">_IO_buf_base</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	    <span class="p">}</span>
</span></span><span class="line"><span class="cl">	  <span class="nf">memset</span> <span class="p">(</span><span class="n">new_buf</span> <span class="o">+</span> <span class="n">old_blen</span><span class="p">,</span> <span class="sc">&#39;\0&#39;</span><span class="p">,</span> <span class="n">new_size</span> <span class="o">-</span> <span class="n">old_blen</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="c1">//......
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><p>ä»å‡½æ•°ä¸­å°±èƒ½çœ‹åˆ°ï¼Œåˆ©ç”¨æµç¨‹å¦‚ä¸‹ï¼š</p>
<ul>
<li>ä¼ªé€ <code>IO_FILE</code>çš„<code>_IO_buf_base</code></li>
<li>åˆç†æ§åˆ¶<code>_IO_buf_end-_IO_buf_base</code>çš„å€¼ï¼Œè¿›è€Œæ§åˆ¶åˆ†é…çš„<code>chunk</code>çš„å¤§å°ï¼Œåˆ†é…åˆ°å¸ƒå±€å¥½çš„åœ°å€</li>
<li>åœ¨<code>memcpy</code>ä¸­è¦†ç›–åœ°å€ï¼Œå¦‚å¯ä»¥è¦†ç›–<code>__malloc_hook/__free_hook</code>ç­‰</li>
</ul>
<p>è¯¥æ–¹æ³•éœ€è¦ç»“åˆå…¶ä»–å †åˆ©ç”¨æŠ€æœ¯ï¼Œéœ€è¦ä¿è¯<code>malloc</code>åˆ†é…å‡ºæ¥çš„<code>chunk</code>çš„åœ°å€æ˜¯å¯æ§çš„ã€‚è¯¥æ–¹æ³•ä¸»è¦æä¾›äº†å¯¹<code>IO</code>ç³»åˆ—å‡½æ•°ä¸­é—´æ¥è°ƒç”¨<code>mallc/free/memcpy</code>çš„ç»„åˆåˆ©ç”¨ã€‚</p>
<h3 class="heading-element" id="ç›¸å…³æŠ€å·§-22"><span>ç›¸å…³æŠ€å·§</span>
  <a href="#%e7%9b%b8%e5%85%b3%e6%8a%80%e5%b7%a7-22" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><ul>
<li>å¯ä»¥<code>largebin attack</code>æ‰“æ‰<code>mp_.tcachebins</code>ï¼Œè¿›è€Œèƒ½æŠŠå¾ˆå¤§çš„<code>chunk</code>ä¹Ÿæ”¾è¿›å…¥<code>tcache</code>è¿›è¡Œç®¡ç†</li>
<li>é«˜ç‰ˆæœ¬æ²¡æœ‰<code>hook</code>çš„è¯ï¼Œå¯ä»¥åˆ©ç”¨<code>memcpy@got</code>ï¼Œé€šè¿‡è¦†å†™<code>got</code>æ¥è¿›è¡Œ<code>rce</code></li>
<li>å¯ä»¥å¤šæ¬¡<code>house of pig</code>ç»„åˆè°ƒç”¨</li>
</ul>
<h3 class="heading-element" id="åˆ©ç”¨æ•ˆæœ-21"><span>åˆ©ç”¨æ•ˆæœ</span>
  <a href="#%e5%88%a9%e7%94%a8%e6%95%88%e6%9e%9c-21" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><ul>
<li>ä»»æ„å‡½æ•°æ‰§è¡Œ</li>
<li><code>ROP</code>æ§åˆ¶ç¨‹åºæ‰§è¡Œæµ</li>
</ul>
<h2 class="heading-element" id="224-house-of-obstack"><span>2.24-House of Obstack</span>
  <a href="#224-house-of-obstack" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><h3 class="heading-element" id="æ¼æ´æˆå› -23"><span>æ¼æ´æˆå› </span>
  <a href="#%e6%bc%8f%e6%b4%9e%e6%88%90%e5%9b%a0-23" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p>å †æº¢å‡º</p>
<h3 class="heading-element" id="é€‚ç”¨èŒƒå›´-23"><span>é€‚ç”¨èŒƒå›´</span>
  <a href="#%e9%80%82%e7%94%a8%e8%8c%83%e5%9b%b4-23" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><ul>
<li><code>2.23</code>â€”â€”è‡³ä»Š</li>
<li>å¯ä»¥æ‰§è¡Œä¸€æ¬¡<code>largebin attack</code></li>
<li>å¯ä»¥è§¦å‘<code>IO</code>æµæ“ä½œ</li>
</ul>
<h3 class="heading-element" id="åˆ©ç”¨åŸç†-23"><span>åˆ©ç”¨åŸç†</span>
  <a href="#%e5%88%a9%e7%94%a8%e5%8e%9f%e7%90%86-23" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p>ä¸€æ¡æ–°çš„åˆ©ç”¨é“¾ï¼Œä¼ªé€ <code>vtable</code>ä¸º<code>_IO_obstack_jumps</code>ï¼Œç„¶åè°ƒç”¨åˆ°<code>_IO_obstack_xsputn</code>ï¼Œç´§æ¥ç€è°ƒç”¨<code>obstack_grow</code>ï¼Œå…¶ä»£ç ä¸ºï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="cp">#define obstack_grow(OBSTACK, where, length)                      \
</span></span></span><span class="line"><span class="cl"><span class="cp">  __extension__                                   \
</span></span></span><span class="line"><span class="cl"><span class="cp">    ({ struct obstack *__o = (OBSTACK);                       \
</span></span></span><span class="line"><span class="cl"><span class="cp">       int __len = (length);                              \
</span></span></span><span class="line"><span class="cl"><span class="cp">       if (_o-&gt;next_free + __len &gt; __o-&gt;chunk_limit)                  \
</span></span></span><span class="line"><span class="cl"><span class="cp">     _obstack_newchunk (__o, __len);                      \
</span></span></span><span class="line"><span class="cl"><span class="cp">       memcpy (__o-&gt;next_free, where, __len);                     \
</span></span></span><span class="line"><span class="cl"><span class="cp">       __o-&gt;next_free += __len;                           \
</span></span></span><span class="line"><span class="cl"><span class="cp">       (void) 0; })</span></span></span></code></pre></td></tr></table>
</div>
</div><p>ç„¶ååœ¨<code>_obstack_newchunk</code>è°ƒç”¨äº†<code>CALL_CHUNKFUN</code>è¿™ä¸ªå®</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">void</span>
</span></span><span class="line"><span class="cl"><span class="nf">_obstack_newchunk</span> <span class="p">(</span><span class="k">struct</span> <span class="n">obstack</span> <span class="o">*</span><span class="n">h</span><span class="p">,</span> <span class="kt">int</span> <span class="n">length</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">struct</span> <span class="n">_obstack_chunk</span> <span class="o">*</span><span class="n">old_chunk</span> <span class="o">=</span> <span class="n">h</span><span class="o">-&gt;</span><span class="n">chunk</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">struct</span> <span class="n">_obstack_chunk</span> <span class="o">*</span><span class="n">new_chunk</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="kt">long</span> <span class="n">new_size</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="kt">long</span> <span class="n">obj_size</span> <span class="o">=</span> <span class="n">h</span><span class="o">-&gt;</span><span class="n">next_free</span> <span class="o">-</span> <span class="n">h</span><span class="o">-&gt;</span><span class="n">object_base</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="kt">long</span> <span class="n">i</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="kt">long</span> <span class="n">already</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="kt">char</span> <span class="o">*</span><span class="n">object_base</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="cm">/* Compute size for new chunk.  */</span>
</span></span><span class="line"><span class="cl">  <span class="n">new_size</span> <span class="o">=</span> <span class="p">(</span><span class="n">obj_size</span> <span class="o">+</span> <span class="n">length</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">obj_size</span> <span class="o">&gt;&gt;</span> <span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">h</span><span class="o">-&gt;</span><span class="n">alignment_mask</span> <span class="o">+</span> <span class="mi">100</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="n">new_size</span> <span class="o">&lt;</span> <span class="n">h</span><span class="o">-&gt;</span><span class="n">chunk_size</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">new_size</span> <span class="o">=</span> <span class="n">h</span><span class="o">-&gt;</span><span class="n">chunk_size</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="cm">/* Allocate and initialize the new chunk.  */</span>
</span></span><span class="line"><span class="cl">  <span class="n">new_chunk</span> <span class="o">=</span> <span class="nf">CALL_CHUNKFUN</span> <span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">new_size</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">[...]</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><p>è¿™ä¸ªå®ä¼šè°ƒç”¨åˆ°å‡½æ•°æŒ‡é’ˆï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="cp"># define CALL_CHUNKFUN(h, size) \
</span></span></span><span class="line"><span class="cl"><span class="cp">  (((h)-&gt;use_extra_arg)                               \
</span></span></span><span class="line"><span class="cl"><span class="cp">   ? (*(h)-&gt;chunkfun)((h)-&gt;extra_arg, (size))                     \
</span></span></span><span class="line"><span class="cl"><span class="cp">   : (*(struct _obstack_chunk *(*)(long))(h)-&gt;chunkfun)((size)))</span></span></span></code></pre></td></tr></table>
</div>
</div><p>å› æ­¤ï¼Œå…¶å°±æ˜¯åˆ©ç”¨è¯¥å‡½æ•°æŒ‡é’ˆè¿›è¡Œæ§åˆ¶ç¨‹åºçš„æ‰§è¡Œæµã€‚</p>
<h3 class="heading-element" id="ç›¸å…³æŠ€å·§-23"><span>ç›¸å…³æŠ€å·§</span>
  <a href="#%e7%9b%b8%e5%85%b3%e6%8a%80%e5%b7%a7-23" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p>ä¼ªé€ çš„<code>IO_FILE</code>å¸ƒå±€å¦‚ä¸‹ï¼š</p>
<ul>
<li>åˆ©ç”¨<code>largebin attack</code>ä¼ªé€ <code>_IO_FILE</code>ï¼Œè®°å®Œæˆä¼ªé€ çš„<code>chunk</code>ä¸º<code>A</code>ï¼ˆæˆ–è€…åˆ«çš„æ‰‹æ³•ï¼‰</li>
<li><code>chunk A</code>å†…åç§»ä¸º<code>0xd8</code>å¤„è®¾ä¸º<code>_IO_obstack_jumps+0x20</code></li>
<li><code>chunk A</code>å†…åç§»ä¸º<code>0xe0</code>å¤„è®¾ç½®<code>chunk A</code>çš„åœ°å€ä½œä¸º<code>obstack</code>ç»“æ„ä½“</li>
<li><code>chunk A</code>å†…åç§»ä¸º<code>0x18</code>å¤„è®¾ä¸º<code>1</code>ï¼ˆ<code>next_free</code>)</li>
<li><code>chunk A</code>å†…åç§»ä¸º<code>0x20</code>å¤„è®¾ä¸º<code>0</code>ï¼ˆ<code>chunk_limit</code>ï¼‰</li>
<li><code>chunk A</code>å†…åç§»ä¸º<code>0x48</code>å¤„è®¾ä¸º<code>&amp;/bin/sh</code></li>
<li><code>chunk A</code>å†…åç§»ä¸º<code>0x38</code>å¤„è®¾ä¸º<code>system</code>å‡½æ•°çš„åœ°å€</li>
<li><code>chunk A</code>å†…åç§»ä¸º<code>0x28</code>å¤„è®¾ä¸º<code>1</code>ï¼ˆ<code>_IO_write_ptr</code>)</li>
<li><code>chunk A</code>å†…åç§»ä¸º<code>0x30</code>å¤„è®¾ä¸º<code>0</code> (<code>_IO_write_end</code>)</li>
<li><code>chunk A</code>å†…åç§»ä¸º<code>0x50</code>å¤„è®¾ä¸º<code>1</code> (<code>use_extra_arg</code>)</li>
</ul>
<p><code>glibc-2.37</code>å¼€å§‹è¿™ä¸ªæ–¹æ³•çš„è°ƒç”¨é“¾ä¸ºï¼š<code>__printf_buffer_as_file_overflow -&gt; __printf_buffer_flush -&gt; __printf_buffer_flush_obstack-&gt;__obstack_newchunk</code>ã€‚</p>
<h3 class="heading-element" id="åˆ©ç”¨æ•ˆæœ-22"><span>åˆ©ç”¨æ•ˆæœ</span>
  <a href="#%e5%88%a9%e7%94%a8%e6%95%88%e6%9e%9c-22" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><ul>
<li>ä»»æ„å‡½æ•°æ‰§è¡Œ</li>
</ul>
<h2 class="heading-element" id="225-house-of-apple1"><span>2.25-House of Apple1</span>
  <a href="#225-house-of-apple1" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><h3 class="heading-element" id="æ¼æ´æˆå› -24"><span>æ¼æ´æˆå› </span>
  <a href="#%e6%bc%8f%e6%b4%9e%e6%88%90%e5%9b%a0-24" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p>å †æº¢å‡º</p>
<h3 class="heading-element" id="é€‚ç”¨èŒƒå›´-24"><span>é€‚ç”¨èŒƒå›´</span>
  <a href="#%e9%80%82%e7%94%a8%e8%8c%83%e5%9b%b4-24" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><ul>
<li>
<p><code>2.23</code>â€”â€”è‡³ä»Š</p>
</li>
<li>
<p>ç¨‹åºä» <code>main</code> å‡½æ•°è¿”å›æˆ–èƒ½è°ƒç”¨ <code>exit</code> å‡½æ•°</p>
</li>
<li>
<p>èƒ½æ³„éœ²å‡º <code>heap</code> åœ°å€å’Œ <code>libc</code> åœ°å€</p>
</li>
<li>
<p>èƒ½ä½¿ç”¨ä¸€æ¬¡ <code>largebin attack</code>ï¼ˆä¸€æ¬¡å³å¯ï¼‰</p>
</li>
</ul>
<h3 class="heading-element" id="åˆ©ç”¨åŸç†-24"><span>åˆ©ç”¨åŸç†</span>
  <a href="#%e5%88%a9%e7%94%a8%e5%8e%9f%e7%90%86-24" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p>åˆ©ç”¨<code>_IO_wstr_overflow</code>å°†ä»»æ„åœ°å€å­˜å‚¨çš„å€¼ä¿®æ”¹å·²çŸ¥å€¼ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="k">static</span> <span class="kt">wint_t</span>
</span></span><span class="line"><span class="cl"><span class="nf">_IO_wstrn_overflow</span> <span class="p">(</span><span class="n">FILE</span> <span class="o">*</span><span class="n">fp</span><span class="p">,</span> <span class="kt">wint_t</span> <span class="n">c</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="cm">/* When we come to here this means the user supplied buffer is
</span></span></span><span class="line"><span class="cl"><span class="cm">     filled.  But since we must return the number of characters which
</span></span></span><span class="line"><span class="cl"><span class="cm">     would have been written in total we must provide a buffer for
</span></span></span><span class="line"><span class="cl"><span class="cm">     further use.  We can do this by writing on and on in the overflow
</span></span></span><span class="line"><span class="cl"><span class="cm">     buffer in the _IO_wstrnfile structure.  */</span>
</span></span><span class="line"><span class="cl">  <span class="n">_IO_wstrnfile</span> <span class="o">*</span><span class="n">snf</span> <span class="o">=</span> <span class="p">(</span><span class="n">_IO_wstrnfile</span> <span class="o">*</span><span class="p">)</span> <span class="n">fp</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="n">fp</span><span class="o">-&gt;</span><span class="n">_wide_data</span><span class="o">-&gt;</span><span class="n">_IO_buf_base</span> <span class="o">!=</span> <span class="n">snf</span><span class="o">-&gt;</span><span class="n">overflow_buf</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nf">_IO_wsetb</span> <span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="n">snf</span><span class="o">-&gt;</span><span class="n">overflow_buf</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">		 <span class="n">snf</span><span class="o">-&gt;</span><span class="n">overflow_buf</span> <span class="o">+</span> <span class="p">(</span><span class="k">sizeof</span> <span class="p">(</span><span class="n">snf</span><span class="o">-&gt;</span><span class="n">overflow_buf</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">				      <span class="o">/</span> <span class="k">sizeof</span> <span class="p">(</span><span class="kt">wchar_t</span><span class="p">)),</span> <span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="n">fp</span><span class="o">-&gt;</span><span class="n">_wide_data</span><span class="o">-&gt;</span><span class="n">_IO_write_base</span> <span class="o">=</span> <span class="n">snf</span><span class="o">-&gt;</span><span class="n">overflow_buf</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="n">fp</span><span class="o">-&gt;</span><span class="n">_wide_data</span><span class="o">-&gt;</span><span class="n">_IO_read_base</span> <span class="o">=</span> <span class="n">snf</span><span class="o">-&gt;</span><span class="n">overflow_buf</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="n">fp</span><span class="o">-&gt;</span><span class="n">_wide_data</span><span class="o">-&gt;</span><span class="n">_IO_read_ptr</span> <span class="o">=</span> <span class="n">snf</span><span class="o">-&gt;</span><span class="n">overflow_buf</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="n">fp</span><span class="o">-&gt;</span><span class="n">_wide_data</span><span class="o">-&gt;</span><span class="n">_IO_read_end</span> <span class="o">=</span> <span class="p">(</span><span class="n">snf</span><span class="o">-&gt;</span><span class="n">overflow_buf</span>
</span></span><span class="line"><span class="cl">				      <span class="o">+</span> <span class="p">(</span><span class="k">sizeof</span> <span class="p">(</span><span class="n">snf</span><span class="o">-&gt;</span><span class="n">overflow_buf</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">					 <span class="o">/</span> <span class="k">sizeof</span> <span class="p">(</span><span class="kt">wchar_t</span><span class="p">)));</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">fp</span><span class="o">-&gt;</span><span class="n">_wide_data</span><span class="o">-&gt;</span><span class="n">_IO_write_ptr</span> <span class="o">=</span> <span class="n">snf</span><span class="o">-&gt;</span><span class="n">overflow_buf</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">fp</span><span class="o">-&gt;</span><span class="n">_wide_data</span><span class="o">-&gt;</span><span class="n">_IO_write_end</span> <span class="o">=</span> <span class="n">snf</span><span class="o">-&gt;</span><span class="n">overflow_buf</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="cm">/* Since we are not really interested in storing the characters
</span></span></span><span class="line"><span class="cl"><span class="cm">     which do not fit in the buffer we simply ignore it.  */</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="n">c</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><p>æ¯”å¦‚ä¿®æ”¹<code>tcache</code>å˜é‡ã€<code>mp_</code>ç»“æ„ä½“ã€<code>pointer_guard</code>å˜é‡ç­‰ã€‚</p>
<p>ä¿®æ”¹æˆåŠŸåï¼Œå†ä½¿ç”¨å…¶ä»–æŠ€æœ¯æ§åˆ¶ç¨‹åºæ‰§è¡Œæµã€‚</p>
<h3 class="heading-element" id="ç›¸å…³æŠ€å·§-24"><span>ç›¸å…³æŠ€å·§</span>
  <a href="#%e7%9b%b8%e5%85%b3%e6%8a%80%e5%b7%a7-24" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p><code>house of apple1</code> æ˜¯å¯¹ç°æœ‰ä¸€äº› <code>IO</code> æµæ”»å‡»æ–¹æ³•çš„è¡¥å……ï¼Œèƒ½åœ¨ä¸€æ¬¡åŠ«æŒ <code>IO</code> æµçš„è¿‡ç¨‹ä¸­åšåˆ°ä»»æ„åœ°å€å†™å·²çŸ¥å€¼ï¼Œè¿›è€Œæ„é€ å‡ºå…¶ä»–æ–¹æ³•æ”»å‡»æˆåŠŸçš„æ¡ä»¶ã€‚</p>
<h3 class="heading-element" id="åˆ©ç”¨æ•ˆæœ-23"><span>åˆ©ç”¨æ•ˆæœ</span>
  <a href="#%e5%88%a9%e7%94%a8%e6%95%88%e6%9e%9c-23" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><ul>
<li>ä»»æ„åœ°å€å†™å·²çŸ¥å †åœ°å€</li>
</ul>
<h2 class="heading-element" id="226-house-of-apple2"><span>2.26-House of Apple2</span>
  <a href="#226-house-of-apple2" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><h3 class="heading-element" id="æ¼æ´æˆå› -25"><span>æ¼æ´æˆå› </span>
  <a href="#%e6%bc%8f%e6%b4%9e%e6%88%90%e5%9b%a0-25" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p>å †æº¢å‡º</p>
<h3 class="heading-element" id="é€‚ç”¨èŒƒå›´-25"><span>é€‚ç”¨èŒƒå›´</span>
  <a href="#%e9%80%82%e7%94%a8%e8%8c%83%e5%9b%b4-25" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><ul>
<li><code>2.23</code>â€”â€”è‡³ä»Š</li>
<li>å·²çŸ¥ <code>heap</code> åœ°å€å’Œ <code>glibc</code> åœ°å€</li>
<li>èƒ½æ§åˆ¶ç¨‹åºæ‰§è¡Œ <code>IO</code> æ“ä½œï¼ŒåŒ…æ‹¬ä½†ä¸é™äºï¼šä» <code>main</code> å‡½æ•°è¿”å›ã€è°ƒç”¨ <code>exit</code> å‡½æ•°ã€é€šè¿‡<code>__malloc_assert</code> è§¦å‘</li>
<li>èƒ½æ§åˆ¶<code>_IO_FILE</code> çš„ <code>vtable</code> å’Œ<code>_wide_data</code>ï¼Œä¸€èˆ¬ä½¿ç”¨ <code>largebin attack</code> å»æ§åˆ¶</li>
</ul>
<h3 class="heading-element" id="åˆ©ç”¨åŸç†-25"><span>åˆ©ç”¨åŸç†</span>
  <a href="#%e5%88%a9%e7%94%a8%e5%8e%9f%e7%90%86-25" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p><code>_IO_WIDE_JUMPS</code>æ²¡æœ‰æ£€æŸ¥<code>_wide_vtable</code>çš„åˆæ³•æ€§ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="cp">#define _IO_WOVERFLOW(FP, CH) WJUMP1 (__overflow, FP, CH)
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="cp">#define WJUMP1(FUNC, THIS, X1) (_IO_WIDE_JUMPS_FUNC(THIS)-&gt;FUNC) (THIS, X1)
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="cp">#define _IO_WIDE_JUMPS_FUNC(THIS) _IO_WIDE_JUMPS(THIS)
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="cp">#define _IO_WIDE_JUMPS(THIS) \
</span></span></span><span class="line"><span class="cl"><span class="cp">  _IO_CAST_FIELD_ACCESS ((THIS), struct _IO_FILE, _wide_data)-&gt;_wide_vtable</span></span></span></code></pre></td></tr></table>
</div>
</div><p>æ‰€ä»¥åˆ©ç”¨<code>_IO_wfile_jumps</code>ç­‰ä¼ªé€ <code>_wide_vtable</code>å³å¯ã€‚</p>
<h3 class="heading-element" id="ç›¸å…³æŠ€å·§-25"><span>ç›¸å…³æŠ€å·§</span>
  <a href="#%e7%9b%b8%e5%85%b3%e6%8a%80%e5%b7%a7-25" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p>åˆ©ç”¨<code>_IO_wfile_overflow</code> å‡½æ•°æ§åˆ¶ç¨‹åºæ‰§è¡Œæµæ—¶å¯¹ <code>fp</code> çš„è®¾ç½®å¦‚ä¸‹ï¼š</p>
<ul>
<li><code>_flags</code> è®¾ç½®ä¸º <code>~(2 | 0x8 | 0x800)</code>ï¼Œå¦‚æœä¸éœ€è¦æ§åˆ¶ <code>rdi</code>ï¼Œè®¾ç½®ä¸º <code>0</code> å³å¯ï¼›å¦‚æœéœ€è¦è·å¾— <code>shell</code>ï¼Œå¯è®¾ç½®ä¸º<code> sh;</code>ï¼Œæ³¨æ„å‰é¢æœ‰ä¸¤ä¸ªç©ºæ ¼</li>
<li><code>vtable</code> è®¾ç½®ä¸º<code>_IO_wfile_jumps/_IO_wfile_jumps_mmap/_IO_wfile_jumps_maybe_mmap</code> åœ°å€ï¼ˆåŠ å‡åç§»ï¼‰ï¼Œä½¿å…¶èƒ½æˆåŠŸè°ƒç”¨<code>_IO_wfile_overflow</code> å³å¯</li>
<li><code>_wide_data</code> è®¾ç½®ä¸ºå¯æ§å †åœ°å€ <code>A</code>ï¼Œå³æ»¡è¶³ <code>*(fp + 0xa0) = A</code></li>
<li><code>_wide_data-&gt;_IO_write_base</code> è®¾ç½®ä¸º <code>0</code>ï¼Œå³æ»¡è¶³ <code>*(A + 0x18) = 0</code></li>
<li><code>_wide_data-&gt;_IO_buf_base</code> è®¾ç½®ä¸º <code>0</code>ï¼Œå³æ»¡è¶³ <code>*(A + 0x30) = 0</code></li>
<li><code>_wide_data-&gt;_wide_vtable</code> è®¾ç½®ä¸ºå¯æ§å †åœ°å€ <code>B</code>ï¼Œå³æ»¡è¶³ <code>*(A + 0xe0) = B</code></li>
<li><code>_wide_data-&gt;_wide_vtable-&gt;doallocate</code> è®¾ç½®ä¸ºåœ°å€ <code>C</code> ç”¨äºåŠ«æŒ <code>RIP</code>ï¼Œå³æ»¡è¶³ <code>*(B + 0x68) = C</code></li>
</ul>
<h3 class="heading-element" id="åˆ©ç”¨æ•ˆæœ-24"><span>åˆ©ç”¨æ•ˆæœ</span>
  <a href="#%e5%88%a9%e7%94%a8%e6%95%88%e6%9e%9c-24" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><ul>
<li>ä»»æ„å‡½æ•°æ‰§è¡Œ</li>
</ul>
<h2 class="heading-element" id="227-house-of-apple3"><span>2.27-House of Apple3</span>
  <a href="#227-house-of-apple3" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><h3 class="heading-element" id="æ¼æ´æˆå› -26"><span>æ¼æ´æˆå› </span>
  <a href="#%e6%bc%8f%e6%b4%9e%e6%88%90%e5%9b%a0-26" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p>å †æº¢å‡º</p>
<h3 class="heading-element" id="é€‚ç”¨èŒƒå›´-26"><span>é€‚ç”¨èŒƒå›´</span>
  <a href="#%e9%80%82%e7%94%a8%e8%8c%83%e5%9b%b4-26" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><ul>
<li><code>2.23</code>â€”â€”è‡³ä»Š</li>
<li>å·²çŸ¥ <code>heap</code> åœ°å€å’Œ <code>glibc</code> åœ°å€</li>
<li>èƒ½æ§åˆ¶ç¨‹åºæ‰§è¡Œ <code>IO</code> æ“ä½œï¼ŒåŒ…æ‹¬ä½†ä¸é™äºï¼šä» <code>main</code> å‡½æ•°è¿”å›ã€è°ƒç”¨ <code>exit</code> å‡½æ•°ã€é€šè¿‡<code>__malloc_assert</code> è§¦å‘</li>
<li>èƒ½æ§åˆ¶<code>_IO_FILE</code> çš„ <code>vtable</code> å’Œ<code>_wide_data</code>ï¼Œä¸€èˆ¬ä½¿ç”¨ <code>largebin attack</code> å»æ§åˆ¶</li>
</ul>
<h3 class="heading-element" id="åˆ©ç”¨åŸç†-26"><span>åˆ©ç”¨åŸç†</span>
  <a href="#%e5%88%a9%e7%94%a8%e5%8e%9f%e7%90%86-26" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p><code>__libio_codecvt_in</code>ç­‰å‡½æ•°ï¼Œå¯ä»¥è®¾ç½®<code>gs-&gt;__shlib_handle == NULL</code>ç»•è¿‡<code>PTR_DEMANGLE</code>å¯¹æŒ‡é’ˆçš„ä¿æŠ¤ï¼Œç„¶åé€šè¿‡<code>_IO_wfile_underflow </code>è°ƒç”¨åˆ°<code>__libio_codecvt_in</code>æ¥æ§åˆ¶å‡½æ•°æŒ‡é’ˆï¼Œæ‰§è¡Œä»»æ„ä»£ç ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="k">enum</span> <span class="n">__codecvt_result</span>
</span></span><span class="line"><span class="cl"><span class="nf">__libio_codecvt_in</span> <span class="p">(</span><span class="k">struct</span> <span class="n">_IO_codecvt</span> <span class="o">*</span><span class="n">codecvt</span><span class="p">,</span> <span class="n">__mbstate_t</span> <span class="o">*</span><span class="n">statep</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">		    <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">from_start</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">from_end</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">		    <span class="k">const</span> <span class="kt">char</span> <span class="o">**</span><span class="n">from_stop</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">		    <span class="kt">wchar_t</span> <span class="o">*</span><span class="n">to_start</span><span class="p">,</span> <span class="kt">wchar_t</span> <span class="o">*</span><span class="n">to_end</span><span class="p">,</span> <span class="kt">wchar_t</span> <span class="o">**</span><span class="n">to_stop</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">enum</span> <span class="n">__codecvt_result</span> <span class="n">result</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="c1">// gs æºè‡ªç¬¬ä¸€ä¸ªå‚æ•°
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="k">struct</span> <span class="n">__gconv_step</span> <span class="o">*</span><span class="n">gs</span> <span class="o">=</span> <span class="n">codecvt</span><span class="o">-&gt;</span><span class="n">__cd_in</span><span class="p">.</span><span class="n">step</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="kt">int</span> <span class="n">status</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="kt">size_t</span> <span class="n">dummy</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="o">*</span><span class="n">from_start_copy</span> <span class="o">=</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">char</span> <span class="o">*</span><span class="p">)</span> <span class="n">from_start</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">codecvt</span><span class="o">-&gt;</span><span class="n">__cd_in</span><span class="p">.</span><span class="n">step_data</span><span class="p">.</span><span class="n">__outbuf</span> <span class="o">=</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">char</span> <span class="o">*</span><span class="p">)</span> <span class="n">to_start</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">codecvt</span><span class="o">-&gt;</span><span class="n">__cd_in</span><span class="p">.</span><span class="n">step_data</span><span class="p">.</span><span class="n">__outbufend</span> <span class="o">=</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">char</span> <span class="o">*</span><span class="p">)</span> <span class="n">to_end</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">codecvt</span><span class="o">-&gt;</span><span class="n">__cd_in</span><span class="p">.</span><span class="n">step_data</span><span class="p">.</span><span class="n">__statep</span> <span class="o">=</span> <span class="n">statep</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">__gconv_fct</span> <span class="n">fct</span> <span class="o">=</span> <span class="n">gs</span><span class="o">-&gt;</span><span class="n">__fct</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="cp">#ifdef PTR_DEMANGLE
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>  <span class="c1">// å¦‚æœgs-&gt;__shlib_handleä¸ä¸ºç©ºï¼Œåˆ™ä¼šç”¨__pointer_guardå»è§£å¯†
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="c1">// è¿™é‡Œå¦‚æœå¯æ§ï¼Œè®¾ç½®ä¸ºNULLå³å¯ç»•è¿‡è§£å¯†
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="k">if</span> <span class="p">(</span><span class="n">gs</span><span class="o">-&gt;</span><span class="n">__shlib_handle</span> <span class="o">!=</span> <span class="nb">NULL</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nf">PTR_DEMANGLE</span> <span class="p">(</span><span class="n">fct</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="cp">#endif
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>  <span class="c1">// è¿™é‡Œæœ‰å‡½æ•°æŒ‡é’ˆè°ƒç”¨
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="c1">// è¿™ä¸ªå®å°±æ˜¯è°ƒç”¨fct(gs, ...)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="n">status</span> <span class="o">=</span> <span class="nf">DL_CALL_FCT</span> <span class="p">(</span><span class="n">fct</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">			<span class="p">(</span><span class="n">gs</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">codecvt</span><span class="o">-&gt;</span><span class="n">__cd_in</span><span class="p">.</span><span class="n">step_data</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">from_start_copy</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">			 <span class="p">(</span><span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="o">*</span><span class="p">)</span> <span class="n">from_end</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">			 <span class="o">&amp;</span><span class="n">dummy</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">       <span class="c1">// ......
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><h3 class="heading-element" id="ç›¸å…³æŠ€å·§-26"><span>ç›¸å…³æŠ€å·§</span>
  <a href="#%e7%9b%b8%e5%85%b3%e6%8a%80%e5%b7%a7-26" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p>åˆ©ç”¨_IO_wfile_underflow å‡½æ•°æ§åˆ¶ç¨‹åºæ‰§è¡Œæµæ—¶å¯¹ <code>fp</code> çš„è®¾ç½®å¦‚ä¸‹ï¼š</p>
<ul>
<li><code>_flags</code> è®¾ç½®ä¸º <code>~(4 | 0x10)</code></li>
<li><code>vtable</code> è®¾ç½®ä¸º<code>_IO_wfile_jumps</code> åœ°å€ï¼ˆåŠ å‡åç§»ï¼‰ï¼Œä½¿å…¶èƒ½æˆåŠŸè°ƒç”¨<code>_IO_wfile_underflow</code> å³å¯</li>
<li><code>fp-&gt;_IO_read_ptr &lt; fp-&gt;_IO_read_end</code>ï¼Œå³æ»¡è¶³ <code>*(fp + 8) &lt; *(fp + 0x10)</code></li>
<li><code>_wide_data</code> ä¿æŒé»˜è®¤ï¼Œæˆ–è€…è®¾ç½®ä¸ºå †åœ°å€ï¼Œå‡è®¾å…¶åœ°å€ä¸º <code>A</code>ï¼Œå³æ»¡è¶³ <code>*(fp + 0xa0) = A</code></li>
<li><code>_wide_data-&gt;_IO_read_ptr &gt;= _wide_data-&gt;_IO_read_end</code>ï¼Œå³æ»¡è¶³ <code>*A &gt;= *(A + 8)</code></li>
<li><code>_codecvt</code> è®¾ç½®ä¸ºå¯æ§å †åœ°å€ <code>B</code>ï¼Œå³æ»¡è¶³ <code>*(fp + 0x98) = B</code></li>
<li><code>codecvt-&gt;__cd_in.step</code> è®¾ç½®ä¸ºå¯æ§å †åœ°å€ <code>C</code>ï¼Œå³æ»¡è¶³ <code>*B = C</code></li>
<li><code>codecvt-&gt;__cd_in.step-&gt;__shlib_handle</code> è®¾ç½®ä¸º <code>0</code>ï¼Œå³æ»¡è¶³ <code>*C = 0</code></li>
<li><code>codecvt-&gt;__cd_in.step-&gt;__fct</code> è®¾ç½®ä¸ºåœ°å€ <code>D</code>, åœ°å€ <code>D</code> ç”¨äºæ§åˆ¶ <code>rip</code>ï¼Œå³æ»¡è¶³ <code>*(C + 0x28) = D</code>ã€‚å½“è°ƒç”¨åˆ° <code>D</code> çš„æ—¶å€™ï¼Œæ­¤æ—¶çš„ <code>rdi</code> ä¸º <code>C</code>ã€‚å¦‚æœ<code>_wide_data</code> ä¹Ÿå¯æ§çš„è¯ï¼Œ<code>rsi</code> ä¹Ÿèƒ½æ§åˆ¶ã€‚</li>
</ul>
<h3 class="heading-element" id="åˆ©ç”¨æ•ˆæœ-25"><span>åˆ©ç”¨æ•ˆæœ</span>
  <a href="#%e5%88%a9%e7%94%a8%e6%95%88%e6%9e%9c-25" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><ul>
<li>ä»»æ„å‡½æ•°æ‰§è¡Œ</li>
</ul>
<h2 class="heading-element" id="228-house-of-gods"><span>2.28-House of Gods</span>
  <a href="#228-house-of-gods" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><h3 class="heading-element" id="æ¼æ´æˆå› -27"><span>æ¼æ´æˆå› </span>
  <a href="#%e6%bc%8f%e6%b4%9e%e6%88%90%e5%9b%a0-27" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p>å †æº¢å‡º</p>
<h3 class="heading-element" id="é€‚ç”¨èŒƒå›´-27"><span>é€‚ç”¨èŒƒå›´</span>
  <a href="#%e9%80%82%e7%94%a8%e8%8c%83%e5%9b%b4-27" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><ul>
<li><code>2.23</code>â€”â€”<code>2.27</code></li>
<li>æ³„éœ²å †åœ°å€å’Œ<code>libc</code>åœ°å€</li>
<li>ä»»æ„å¤§å°åˆ†é…</li>
</ul>
<h3 class="heading-element" id="åˆ©ç”¨åŸç†-27"><span>åˆ©ç”¨åŸç†</span>
  <a href="#%e5%88%a9%e7%94%a8%e5%8e%9f%e7%90%86-27" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p>è¿™ä¸ªæŠ€å·§æ¯”è¾ƒæœ‰æ„æ€ï¼Œéå¸¸å»ºè®®æŠŠä½œè€…çš„åŸåšå®¢è¯»ä¸€ä¸‹ã€‚æˆ‘ä¼šç®€è¿°ä¸€ä¸‹è¯¥æŠ€å·§çš„åˆ©ç”¨è¿‡ç¨‹ã€‚</p>
<p>æ€»çš„æ¥è¯´ï¼Œè¯¥æŠ€å·§æœ€ç»ˆçš„ç›®çš„æ˜¯ä¼ªé€ ä¸€ä¸ª<code>fake arena</code>ï¼Œé€šè¿‡åŠ«æŒ<code>main_arena.next</code>å­—æ®µå®Œæˆã€‚</p>
<p>å…¶ä¸»è¦è¿‡ç¨‹ä¸ºï¼š</p>
<ul>
<li>é€šè¿‡<code>binmap</code>çš„èµ‹å€¼ï¼Œå°†å…¶å½“åš<code>chunk</code>çš„<code>size</code>ï¼Œç„¶åä¿®æ”¹<code>unsortedbin</code>é“¾çš„<code>bk</code>æŒ‡å‘<code>binmap</code>ï¼Œä½œè€…é€‰æ‹©çš„æ˜¯<code>0x90</code>å¤§å°çš„<code>chunk</code>ï¼Œé‡Šæ”¾åæ°å¥½è®©<code>binmap</code>ç§°ä¸º<code>0x200</code>ï¼Œç„¶å<code>binmap-&gt;bk</code>æ˜¯<code>main_arena</code>(åˆå§‹çŠ¶æ€ä¸‹<code>main_arena.next = &amp;main_arena</code>)ï¼Œç„¶å<code>main_arena-&gt;bk= fastbin[0x40]</code></li>
<li>åˆ†é…<code>0x1f0</code>å¤§å°çš„<code>chunk</code>å°±åˆšå¥½èƒ½åˆ†é…åˆ°<code>binmap</code></li>
<li>ä¹‹åä¿®æ”¹æ‰<code>main_arena</code>çš„<code>system_mem</code>ä¸ºå¾ˆå¤§çš„å€¼å’Œ<code>next</code>æŒ‡å‘<code>fake arena</code></li>
<li>ç„¶åç”¨<code>unsortedbin attack</code>æ‰“æ‰<code>narenas</code>ï¼Œå°†å…¶æ”¹ä¸ºä¸€ä¸ªå¾ˆå¤§çš„æ•°</li>
<li>ç„¶ååˆ†é…ä¸¤æ¬¡<code>malloc(0xffffffffffffffbf + 1)</code>ï¼Œè§¦å‘<code>arena_get_retry</code>ï¼Œè¿›è€Œè§¦å‘ä¸¤æ¬¡<code>reused_arena</code>ï¼Œå°±èƒ½æŠŠ<code>fake arena</code>ç»™<code>thread_arena</code>å˜é‡</li>
<li>æœ€åç›´æ¥ä¼ªé€ <code>fastbin</code>ä»»æ„åœ°å€åˆ†é…</li>
</ul>
<h3 class="heading-element" id="ç›¸å…³æŠ€å·§-27"><span>ç›¸å…³æŠ€å·§</span>
  <a href="#%e7%9b%b8%e5%85%b3%e6%8a%80%e5%b7%a7-27" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><ul>
<li>ä»…ä»…å€ŸåŠ©<code>unsortedbin</code>é“¾å°±èƒ½æ§åˆ¶<code>main_arena</code>çš„<code>next</code>å’Œ<code>system_mem</code></li>
<li>åˆ©ç”¨<code>binmap</code>çš„å€¼æ„é€ å‡ºåˆæ³•çš„<code>size</code></li>
</ul>
<h3 class="heading-element" id="åˆ©ç”¨æ•ˆæœ-26"><span>åˆ©ç”¨æ•ˆæœ</span>
  <a href="#%e5%88%a9%e7%94%a8%e6%95%88%e6%9e%9c-26" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><ul>
<li>åŠ«æŒ<code>thread_arena</code>ä¸º<code>fake_arena</code></li>
</ul>
<h2 class="heading-element" id="229-house-of-lys"><span>2.29-House of Lys</span>
  <a href="#229-house-of-lys" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><h3 class="heading-element" id="æ¼æ´æˆå› -28"><span>æ¼æ´æˆå› </span>
  <a href="#%e6%bc%8f%e6%b4%9e%e6%88%90%e5%9b%a0-28" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p>å †æº¢å‡º</p>
<h3 class="heading-element" id="é€‚ç”¨èŒƒå›´-28"><span>é€‚ç”¨èŒƒå›´</span>
  <a href="#%e9%80%82%e7%94%a8%e8%8c%83%e5%9b%b4-28" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><ul>
<li><code>2.23</code> â€”â€”è‡³ä»Š</li>
<li>æ³„éœ²å †åœ°å€å’Œ<code>libc</code>åœ°å€</li>
<li>ä»»æ„å¤§å°åˆ†é…</li>
</ul>
<h3 class="heading-element" id="åˆ©ç”¨åŸç†-28"><span>åˆ©ç”¨åŸç†</span>
  <a href="#%e5%88%a9%e7%94%a8%e5%8e%9f%e7%90%86-28" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p>è°ƒç”¨ <code>_IO_obstack_XXX</code> å‡½æ•°çš„æ—¶å€™ï¼Œæ²¡æœ‰æ£€æŸ¥å‡½æ•°æŒ‡é’ˆçš„æœ‰æ•ˆæ€§ã€‚è°ƒç”¨é“¾ä¸ºï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">exit
</span></span><span class="line"><span class="cl"> __run_exit_handlers
</span></span><span class="line"><span class="cl">   fcloseall
</span></span><span class="line"><span class="cl">     _IO_cleanup
</span></span><span class="line"><span class="cl">		_IO_flush_all_lockp
</span></span><span class="line"><span class="cl">     		_IO_obstack_xsputn
</span></span><span class="line"><span class="cl">         		obstack_grow
</span></span><span class="line"><span class="cl">           			_obstack_newchunk
</span></span><span class="line"><span class="cl">              			CALL_CHUNKFUN(ä¸€ä¸ªå®å®šä¹‰)
</span></span><span class="line"><span class="cl">                			(*(h)-&gt;chunkfun)((h)-&gt;extra_arg, (size))</span></span></code></pre></td></tr></table>
</div>
</div><h3 class="heading-element" id="ç›¸å…³æŠ€å·§-28"><span>ç›¸å…³æŠ€å·§</span>
  <a href="#%e7%9b%b8%e5%85%b3%e6%8a%80%e5%b7%a7-28" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><ul>
<li>ä¼ªé€  <code>vtable</code> ä¸º <code>_IO_obstack_jumps</code>ï¼Œç„¶åè§¦å‘ <code>_IO_obstack_xsputn</code> å‡½æ•°æ‰§è¡Œä¸Šè¿°è°ƒç”¨é“¾</li>
</ul>
<h3 class="heading-element" id="åˆ©ç”¨æ•ˆæœ-27"><span>åˆ©ç”¨æ•ˆæœ</span>
  <a href="#%e5%88%a9%e7%94%a8%e6%95%88%e6%9e%9c-27" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><ul>
<li>ä»»æ„å‡½æ•°æ‰§è¡Œ</li>
</ul>
<h2 class="heading-element" id="230-house-of-snake"><span>2.30-House of Snake</span>
  <a href="#230-house-of-snake" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><p>å’Œä¸Šä¸€ä¸ª <code>house of lys</code> çš„åŸç†æ˜¯ç±»ä¼¼çš„ï¼Œä½†æ˜¯ç”¨äº <code>glibc-2.37</code></p>
<h2 class="heading-element" id="3-æ€»ç»“"><span>3-æ€»ç»“</span>
  <a href="#3-%e6%80%bb%e7%bb%93" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><ul>
<li>æ€»ç»“äº† <code>30</code> ç§ <code>house of</code> ç³»åˆ—åˆ©ç”¨æ‰‹æ³•</li>
<li>ç»™å‡ºäº†æ¯ç§åˆ©ç”¨æ‰‹æ³•çš„å½±å“ç‰ˆæœ¬ã€é€‚ç”¨èŒƒå›´ã€åˆ©ç”¨åŸç†ç­‰</li>
<li>æ‰€æœ‰çš„åˆ©ç”¨æ–¹æ³•éƒ½å¯ä»¥åœ¨æºç ä¸­æ‰¾åˆ°ç­”æ¡ˆï¼Œå› æ­¤å¼ºçƒˆå»ºè®®å°†æºç åå¤é˜…è¯»</li>
<li>å¯ä»¥æ ¹æ®ç›®å‰å·²æœ‰çš„æŠ€æœ¯æå‡ºæ–°çš„ç»„åˆæŠ€</li>
</ul>
<h2 class="heading-element" id="4-å‚è€ƒ"><span>4-å‚è€ƒ</span>
  <a href="#4-%e5%8f%82%e8%80%83" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><p>[1] <a href="https://www.anquanke.com/post/id/244158"target="_blank" rel="external nofollow noopener noreferrer">å †åˆ©ç”¨ç³»åˆ—ä¹‹house of spirit-å®‰å…¨å®¢ - å®‰å…¨èµ„è®¯å¹³å° (anquanke.com)<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a></p>
<p>[2] <a href="https://github.com/shellphish/how2heap"target="_blank" rel="external nofollow noopener noreferrer">shellphish/how2heap: A repository for learning various heap exploitation techniques. (github.com)<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a></p>
<p>[3] <a href="https://0x434b.dev/overview-of-glibc-heap-exploitation-techniques"target="_blank" rel="external nofollow noopener noreferrer">Overview of GLIBC heap exploitation techniques (0x434b.dev)<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a></p>
<p>[4] [<a href="https://bbs.kanxue.com/thread-272098.htm#msg_header_h2_1"target="_blank" rel="external nofollow noopener noreferrer">åŸåˆ›] CTF ä¸­ glibcå †åˆ©ç”¨ åŠ IO_FILE æ€»ç»“-Pwn-çœ‹é›ªè®ºå›-å®‰å…¨ç¤¾åŒº|å®‰å…¨æ‹›è˜|bbs.pediy.com (kanxue.com)<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a></p>
<p>[5] <a href="https://www.anquanke.com/post/id/251596"target="_blank" rel="external nofollow noopener noreferrer">PWNâ€”â€”House Of Einherjar CTF Wikiä¾‹é¢˜è¯¦è§£-å®‰å…¨å®¢ - å®‰å…¨èµ„è®¯å¹³å° (anquanke.com)<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a></p>
<p>[6] <a href="https://www.anquanke.com/post/id/175630"target="_blank" rel="external nofollow noopener noreferrer">Top chunkåŠ«æŒï¼šHouse of forceæ”»å‡»-å®‰å…¨å®¢ - å®‰å…¨èµ„è®¯å¹³å° (anquanke.com)<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a></p>
<p>[7] <a href="https://ctf-wiki.org/pwn/linux/user-mode/heap/ptmalloc2/house-of-lore/"target="_blank" rel="external nofollow noopener noreferrer">House of Lore - CTF Wiki (ctf-wiki.org)<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a></p>
<p>[8] <a href="https://www.anquanke.com/post/id/218887"target="_blank" rel="external nofollow noopener noreferrer">House of orange-å®‰å…¨å®¢ - å®‰å…¨èµ„è®¯å¹³å° (anquanke.com)<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a></p>
<p>[9] <a href="http://p4nda.top/2018/04/18/house-of-rabbit/"target="_blank" rel="external nofollow noopener noreferrer">house of rabbit<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a></p>
<p>[10] <a href="https://ctf-wiki.org/pwn/linux/user-mode/heap/ptmalloc2/house-of-roman/"target="_blank" rel="external nofollow noopener noreferrer">House of Roman - CTF Wiki (ctf-wiki.org)<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a></p>
<p>[11] <a href="https://www.anquanke.com/post/id/203096"target="_blank" rel="external nofollow noopener noreferrer">House of storm åŸç†åŠåˆ©ç”¨-å®‰å…¨å®¢ - å®‰å…¨èµ„è®¯å¹³å° (anquanke.com)<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a></p>
<p>[12] <a href="https://xz.aliyun.com/t/6862#toc-5"target="_blank" rel="external nofollow noopener noreferrer">House-of-Corrosion ä¸€ç§æ–°çš„å †åˆ©ç”¨æŠ€å·§ - å…ˆçŸ¥ç¤¾åŒº (aliyun.com)<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a></p>
<p>[13] <a href="https://www.anquanke.com/post/id/202387"target="_blank" rel="external nofollow noopener noreferrer">house-of-huskå­¦ä¹ ç¬”è®°-å®‰å…¨å®¢ - å®‰å…¨èµ„è®¯å¹³å° (anquanke.com)<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a></p>
<p>[14] <a href="https://www.anquanke.com/post/id/254797"target="_blank" rel="external nofollow noopener noreferrer">House of Muney åˆ†æ-å®‰å…¨å®¢ - å®‰å…¨èµ„è®¯å¹³å° (anquanke.com)<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a></p>
<p>[15] <a href="https://forum.butian.net/share/1709"target="_blank" rel="external nofollow noopener noreferrer">å¥‡å®‰ä¿¡æ”»é˜²ç¤¾åŒº-æ·±å…¥ç†è§£ House of Botcake å †åˆ©ç”¨æ‰‹æ³• (butian.net)<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a></p>
<p>[16] <a href="https://github.com/c4ebt/House-of-Rust"target="_blank" rel="external nofollow noopener noreferrer">c4ebt/House-of-Rust: The House of Rust is a heap exploitation technique that drops a shell against full PIE binaries that donâ€™t leak any addresses. (github.com)<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a></p>
<p>[17] <a href="https://www.anquanke.com/post/id/222948"target="_blank" rel="external nofollow noopener noreferrer">house of banana-å®‰å…¨å®¢ - å®‰å…¨èµ„è®¯å¹³å° (anquanke.com)<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a></p>
<p>[18] <a href="https://www.anquanke.com/post/id/235598"target="_blank" rel="external nofollow noopener noreferrer">House OF Kiwi-å®‰å…¨å®¢ - å®‰å…¨èµ„è®¯å¹³å° (anquanke.com)<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a></p>
<p>[19] <a href="https://www.anquanke.com/post/id/260614"target="_blank" rel="external nofollow noopener noreferrer">house of emma<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a></p>
<p>[20] <a href="https://www.anquanke.com/post/id/242640"target="_blank" rel="external nofollow noopener noreferrer">house of pigä¸€ä¸ªæ–°çš„å †åˆ©ç”¨è¯¦è§£-å®‰å…¨å®¢ - å®‰å…¨èµ„è®¯å¹³å° (anquanke.com)<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a></p>
<p>[21] <a href="https://tttang.com/archive/1845/"target="_blank" rel="external nofollow noopener noreferrer">ä¸€æ¡æ–°çš„glibc IO_FILEåˆ©ç”¨é“¾ï¼š_IO_obstack_jumpsåˆ©ç”¨åˆ†æ - è·³è·³ç³– (tttang.com)<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a></p>
<p>[22] <a href="https://roderickchan.github.io/zh-cn/house-of-apple-%e4%b8%80%e7%a7%8d%e6%96%b0%e7%9a%84glibc%e4%b8%adio%e6%94%bb%e5%87%bb%e6%96%b9%e6%b3%95-1/"target="_blank" rel="external nofollow noopener noreferrer">House of Apple ä¸€ç§æ–°çš„glibcä¸­IOæ”»å‡»æ–¹æ³• (1) - roderick - record and learn! (roderickchan.cn)<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a></p>
<p>[23] <a href="https://roderickchan.github.io/zh-cn/house-of-apple-%e4%b8%80%e7%a7%8d%e6%96%b0%e7%9a%84glibc%e4%b8%adio%e6%94%bb%e5%87%bb%e6%96%b9%e6%b3%95-2/"target="_blank" rel="external nofollow noopener noreferrer">House of Apple ä¸€ç§æ–°çš„glibcä¸­IOæ”»å‡»æ–¹æ³• (2) - roderick - record and learn! (roderickchan.cn)<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a></p>
<p>[24] <a href="https://roderickchan.github.io/zh-cn/house-of-apple-%e4%b8%80%e7%a7%8d%e6%96%b0%e7%9a%84glibc%e4%b8%adio%e6%94%bb%e5%87%bb%e6%96%b9%e6%b3%95-3/"target="_blank" rel="external nofollow noopener noreferrer">House of Apple ä¸€ç§æ–°çš„glibcä¸­IOæ”»å‡»æ–¹æ³• (3) - roderick - record and learn! (roderickchan.cn)<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a></p>
<p>[25] <a href="https://roderickchan.github.io/zh-cn/2022-06-18-glibcheap-house-of-muney/"target="_blank" rel="external nofollow noopener noreferrer">GlibcHeap-house of muney - roderick - record and learn! (roderickchan.cn)<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a></p>
<p>[26] <a href="https://github.com/Milo-D/house-of-gods/blob/master/rev2/HOUSE_OF_GODS.TXT"target="_blank" rel="external nofollow noopener noreferrer">house-of-gods/HOUSE_OF_GODS.TXT at master Â· Milo-D/house-of-gods (github.com)<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a></p></div><hr class="awesome-hr" />
    <h2 id="see-also">ç›¸å…³å†…å®¹</h2>
    <ul><li>
          <a href="/zh-cn/house-of-apple-%E4%B8%80%E7%A7%8D%E6%96%B0%E7%9A%84glibc%E4%B8%ADio%E6%94%BB%E5%87%BB%E6%96%B9%E6%B3%95-3/" title="House of Apple ä¸€ç§æ–°çš„glibcä¸­IOæ”»å‡»æ–¹æ³• (3)">House of Apple ä¸€ç§æ–°çš„glibcä¸­IOæ”»å‡»æ–¹æ³• (3)</a></li><li>
          <a href="/zh-cn/house-of-apple-%E4%B8%80%E7%A7%8D%E6%96%B0%E7%9A%84glibc%E4%B8%ADio%E6%94%BB%E5%87%BB%E6%96%B9%E6%B3%95-2/" title="House of Apple ä¸€ç§æ–°çš„glibcä¸­IOæ”»å‡»æ–¹æ³• (2)">House of Apple ä¸€ç§æ–°çš„glibcä¸­IOæ”»å‡»æ–¹æ³• (2)</a></li><li>
          <a href="/zh-cn/house-of-apple-%E4%B8%80%E7%A7%8D%E6%96%B0%E7%9A%84glibc%E4%B8%ADio%E6%94%BB%E5%87%BB%E6%96%B9%E6%B3%95-1/" title="House of Apple ä¸€ç§æ–°çš„glibcä¸­IOæ”»å‡»æ–¹æ³• (1)">House of Apple ä¸€ç§æ–°çš„glibcä¸­IOæ”»å‡»æ–¹æ³• (1)</a></li><li>
          <a href="/zh-cn/2022-06-18-glibcheap-house-of-muney/" title="GlibcHeap-House of Muney">GlibcHeap-House of Muney</a></li></ul><div class="post-footer" id="post-footer">
  <div class="post-info">
    <div class="post-info-line">
      <div class="post-info-mod">
        <span title="æ›´æ–°äº 2025-06-08 22:47:19">æ›´æ–°äº 2025-06-08&nbsp;</span>
      </div><div class="post-info-license">
            <span><a rel="license external nofollow noopener noreferrer" href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a></span>
          </div></div><div class="post-info-line">
        <div class="post-info-md"></div>
        <div class="post-info-share">
          <span><a href="javascript:void(0);" title="åˆ†äº«åˆ° X" data-sharer="twitter" data-url="https://roderickchan.github.io/zh-cn/2023-02-27-house-of-all-about-glibc-heap-exploitation/" data-title="Glibcå †åˆ©ç”¨ä¹‹house Ofç³»åˆ—æ€»ç»“" data-hashtags="heap exploitation,house of,glibc"><i class="fa-brands fa-x-twitter fa-fw" aria-hidden="true"></i></a>
  <a href="javascript:void(0);" title="åˆ†äº«åˆ° Facebook" data-sharer="facebook" data-url="https://roderickchan.github.io/zh-cn/2023-02-27-house-of-all-about-glibc-heap-exploitation/" data-hashtag="heap exploitation"><i class="fa-brands fa-facebook-square fa-fw" aria-hidden="true"></i></a>
  <a href="javascript:void(0);" title="åˆ†äº«åˆ° Hacker News" data-sharer="hackernews" data-url="https://roderickchan.github.io/zh-cn/2023-02-27-house-of-all-about-glibc-heap-exploitation/" data-title="Glibcå †åˆ©ç”¨ä¹‹house Ofç³»åˆ—æ€»ç»“"><i class="fa-brands fa-hacker-news fa-fw" aria-hidden="true"></i></a>
  <a href="javascript:void(0);" title="åˆ†äº«åˆ° Line" data-sharer="line" data-url="https://roderickchan.github.io/zh-cn/2023-02-27-house-of-all-about-glibc-heap-exploitation/" data-title="Glibcå †åˆ©ç”¨ä¹‹house Ofç³»åˆ—æ€»ç»“"><svg class="icon" role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>LINE</title><path d="M19.365 9.863c.349.0.63.285.63.631.0.345-.281.63-.63.63H17.61v1.125h1.755c.349.0.63.283.63.63.0.344-.281.629-.63.629h-2.386c-.345.0-.627-.285-.627-.629V8.108c0-.345.282-.63.63-.63h2.386c.346.0.627.285.627.63.0.349-.281.63-.63.63H17.61v1.125h1.755zm-3.855 3.016c0 .27-.174.51-.432.596-.064.021-.133.031-.199.031-.211.0-.391-.09-.51-.25l-2.443-3.317v2.94c0 .344-.279.629-.631.629-.346.0-.626-.285-.626-.629V8.108c0-.27.173-.51.43-.595.06-.023.136-.033.194-.033.195.0.375.104.495.254l2.462 3.33V8.108c0-.345.282-.63.63-.63.345.0.63.285.63.63v4.771zm-5.741.0c0 .344-.282.629-.631.629-.345.0-.627-.285-.627-.629V8.108c0-.345.282-.63.63-.63.346.0.628.285.628.63v4.771zm-2.466.629H4.917c-.345.0-.63-.285-.63-.629V8.108c0-.345.285-.63.63-.63.348.0.63.285.63.63v4.141h1.756c.348.0.629.283.629.63.0.344-.282.629-.629.629M24 10.314C24 4.943 18.615.572 12 .572S0 4.943.0 10.314c0 4.811 4.27 8.842 10.035 9.608.391.082.923.258 1.058.59.12.301.079.766.038 1.08l-.164 1.02c-.045.301-.24 1.186 1.049.645 1.291-.539 6.916-4.078 9.436-6.975C23.176 14.393 24 12.458 24 10.314"/></svg></a>
  <a href="javascript:void(0);" title="åˆ†äº«åˆ° å¾®åš" data-sharer="weibo" data-url="https://roderickchan.github.io/zh-cn/2023-02-27-house-of-all-about-glibc-heap-exploitation/" data-title="Glibcå †åˆ©ç”¨ä¹‹house Ofç³»åˆ—æ€»ç»“"><i class="fa-brands fa-weibo fa-fw" aria-hidden="true"></i></a>
  </span>
        </div>
      </div></div>

  <div class="post-info-more">
    <section class="post-tags"><i class="fa-solid fa-tags fa-fw me-1" aria-hidden="true"></i><a href="/zh-cn/tags/heap-exploitation/" class="post-tag" title="æ ‡ç­¾ - heap exploitation">heap exploitation</a><a href="/zh-cn/tags/house-of/" class="post-tag" title="æ ‡ç­¾ - house of">house of</a><a href="/zh-cn/tags/glibc/" class="post-tag" title="æ ‡ç­¾ - glibc">glibc</a></section>
    <section>
      <span><a href="javascript:void(0);" onclick="window.history.back();">è¿”å›</a></span>&nbsp;|&nbsp;<span><a href="/zh-cn/">ä¸»é¡µ</a></span>
    </section>
  </div><div class="post-nav"><a href="/zh-cn/2023-02-20-the-art-of-shellcode/" class="post-nav-item" rel="prev" title="Linuxä¸‹çš„shellcodeæŠ€å·§æ€»ç»“"><i class="fa-solid fa-angle-left fa-fw" aria-hidden="true"></i>Linuxä¸‹çš„shellcodeæŠ€å·§æ€»ç»“</a><a href="/zh-cn/2023-03-01-analysis-of-glibc-heap-exploitation-in-high-version/" class="post-nav-item" rel="next" title="Glibcé«˜ç‰ˆæœ¬å †åˆ©ç”¨æ–¹æ³•æ€»ç»“">Glibcé«˜ç‰ˆæœ¬å †åˆ©ç”¨æ–¹æ³•æ€»ç»“<i class="fa-solid fa-angle-right fa-fw" aria-hidden="true"></i></a></div>
</div>
<div class="post-reward">
    <div class="comment">Buy me a coffee~</div>
    <input type="checkbox" class="reward-input" name="reward" id="fi-reward" hidden />
    <label class="reward-button" for="fi-reward"><i class="fa-solid fa-qrcode fa-fw" aria-hidden="true"></i>èµèµ</label>
    <div class="reward-ways" data-mode="fixed"><div><img src='/images/alipay.jpg' alt="roderick æ”¯ä»˜å®"><span data-animation>æ”¯ä»˜å®</span>
          </div><div><img src='/images/wechatpay.jpg' alt="roderick å¾®ä¿¡"><span data-animation>å¾®ä¿¡</span>
          </div></div>
  </div><div id="comments"><div id="waline" class="comment"></div><noscript>
        Please enable JavaScript to view the comments powered by <a href="https://waline.js.org/" rel="external nofollow noopener noreferrer">Waline</a>.
      </noscript></div></article>

  <aside class="toc" id="toc-auto" aria-label="ç›®å½•"><div class="follow-container">
    <a href="https://www.roderickchan.cn" class="author-link" target="_blank">
      <img src="https://gravatar.loli.net/avatar/6f579d9b68b13aed76b08fee1c3ede40?s=32&amp;d=mp" alt="roderick" class="author-avatar"> roderick
    </a>
    <a href="https://github.com/RoderickChan" class="follow-btn" target="_blank" title="å…³æ³¨æˆ‘çš„ GitHubï¼">
      <i class="fa-brands fa-github fa-fw fa-beat" aria-hidden="true"></i> å…³æ³¨
    </a>
  </div>
  <hr class="hr-edge-weak"><h2 class="toc-title">ç›®å½•&nbsp;<i class="toc-icon fa-solid fa-angle-down fa-fw" aria-hidden="true"></i></h2>
      <div class="toc-content" id="toc-content-auto"></div></aside></main><footer class="footer">
    <div class="footer-container"><div class="clustrmaps-custom">
  <center>
    <script type='text/javascript' id='clustrmaps' src='//cdn.clustrmaps.com/map_v2.js?cl=ffffff&amp;w=600&amp;t=tt&amp;d=bKrzPRSdAZuPQnsWUdvwNdyX5hI0m3cpvARXwWbJct4'></script>
  </center>
</div><style>
.clustrmaps-custom {
  width: 100%;
  max-width: 600px;
  margin: 0 auto;
  overflow: hidden;
}

.clustrmaps-custom center {
  width: 100%;
}

.clustrmaps-custom #clustrmaps {
  max-width: 100% !important;
  height: auto !important;
}

 
@media (max-width: 768px) {
  .clustrmaps-custom {
    max-width: 100%;
    padding: 0 10px;
  }
  
  .clustrmaps-custom #clustrmaps {
    width: 100% !important;
    max-width: 350px !important;
  }
}

 
@media (max-width: 480px) {
  .clustrmaps-custom {
    padding: 0 5px;
  }
  
  .clustrmaps-custom #clustrmaps {
    max-width: 280px !important;
  }
}

 
@media (max-width: 360px) {
  .clustrmaps-custom #clustrmaps {
    max-width: 250px !important;
  }
}
</style>
<div class="footer-line powered">ç”± <a href="https://gohugo.io/" target="_blank" rel="external nofollow noopener noreferrer" title="Hugo 0.147.7"><img class="hugo-icon" src="/images/hugo.min.svg" alt="Hugo logo" /> Hugo</a> å¼ºåŠ›é©±åŠ¨ | ä¸»é¢˜ - <a href="https://github.com/hugo-fixit/FixIt" target="_blank" rel="external" title="FixIt v0.3.21-87ca54d0"><img class="fixit-icon" src="/images/fixit.min.svg" alt="FixIt logo" /> FixIt</a>
        </div><div class="footer-line copyright" itemscope itemtype="http://schema.org/CreativeWork"><i class="fa-regular fa-copyright fa-fw" aria-hidden="true"></i>
            <span itemprop="copyrightYear">2022 - 2025</span><span class="author" itemprop="copyrightHolder">
              <a href="https://www.roderickchan.cn"target="_blank" rel="external nofollow noopener noreferrer">roderick</a></span><span class="license footer-divider"><a rel="license external nofollow noopener noreferrer" href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a></span></div><div class="footer-line statistics"><span class="site-time" title='ç½‘ç«™è¿è¡Œä¸­â€¦â€¦'><i class="fa-solid fa-heartbeat fa-fw animate-icon" aria-hidden="true"></i><span class="run-times ms-1">ç½‘ç«™è¿è¡Œä¸­â€¦â€¦</span></span></div><div class="footer-line visitor">
          <span id="busuanzi_container_site_uv" title='æ€»è®¿å®¢æ•°'><i class="fa-regular fa-user fa-fw me-1" aria-hidden="true"></i><span id="busuanzi_value_site_uv"><i class="fa-solid fa-spinner fa-spin fa-fw" aria-hidden="true"></i></span></span><span id="busuanzi_container_site_pv" class="footer-divider" title='æ€»è®¿é—®é‡'><i class="fa-regular fa-eye fa-fw me-1" aria-hidden="true"></i><span id="busuanzi_value_site_pv"><i class="fa-solid fa-spinner fa-spin fa-fw" aria-hidden="true"></i></span></span>
        </div><div class="footer-line beian"><span class="icp footer-divider"><a href="http://beian.miit.gov.cn/">é„‚ICPå¤‡2022016286å·</a></span></div></div>
  </footer></div><div class="widgets"><div class="fixed-buttons animate__faster d-none"><div class="fixed-button back-to-top" role="button" aria-label="å›åˆ°é¡¶éƒ¨"><i class="fa-solid fa-arrow-up fa-fw" aria-hidden="true"></i><span class="variant-numeric">0%</span>
        </div><div class="fixed-button view-comments d-none" role="button" aria-label="æŸ¥çœ‹è¯„è®º"><i class="fa-solid fa-comment fa-fw" aria-hidden="true"></i></div></div><a href="https://github.com/RoderickChan" title="View source on GitHub"target="_blank" rel="external nofollow" class="github-corner right d-none-mobile"><svg viewBox="0 0 250 250" aria-hidden="true" width="56" height="56"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><div id="mask"></div><div class="reading-progress-bar" style="left: 0;top: 0;--bg-progress: #000;--bg-progress-dark: #fff;"></div><noscript>
    <div class="noscript-warning">è¯¥ç½‘ç«™åœ¨å¯ç”¨ JavaScript çš„æƒ…å†µä¸‹æ•ˆæœæœ€ä½³ã€‚</div>
  </noscript>
</div><link rel="stylesheet" href="/lib/waline/waline.css"><link rel="preload" href="/lib/katex/katex.min.css" as="style" onload="this.removeAttribute('onload');this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="/lib/katex/katex.min.css"></noscript><link rel="preload" href="/lib/aplayer/APlayer.min.css" as="style" onload="this.removeAttribute('onload');this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="/lib/aplayer/APlayer.min.css"></noscript><link rel="stylesheet" href="/lib/aplayer/dark.min.css"><link rel="stylesheet" href="/lib/cookieconsent/cookieconsent.min.css"><link rel="stylesheet" href="/lib/pace/themes/blue/pace-theme-minimal.css"><script src="/lib/waline/waline.umd.js" defer></script><script src="/lib/autocomplete/autocomplete.min.js" defer></script><script src="/lib/fuse/fuse.min.js" defer></script><script src="/lib/instant-page/instantpage.min.js" async defer type="module"></script><script src="/lib/twemoji/twemoji.min.js" defer></script><script src="/lib/sharer/sharer.min.js" async defer></script><script src="/lib/typeit/index.umd.js" defer></script><script src="/lib/katex/katex.min.js" defer></script><script src="/lib/katex/auto-render.min.js" defer></script><script src="/lib/katex/copy-tex.min.js" defer></script><script src="/lib/katex/mhchem.min.js" defer></script><script src="/lib/aplayer/APlayer.min.js" defer></script><script src="/lib/meting/Meting.min.js" defer></script><script src="/lib/cookieconsent/cookieconsent.min.js" defer></script><script src="/lib/pangu/pangu.min.js" defer></script><script src="/lib/cell-watermark/watermark.min.js" defer></script><script src="https://cn.vercount.one/js" async defer></script><script src="/lib/pace/pace.min.js" async defer></script><script>window.config={"autoBookmark":true,"code":{"copyTitle":"å¤åˆ¶åˆ°å‰ªè´´æ¿","maxShownLines":-1},"comment":{"enable":true,"expired":false,"waline":{"copyright":true,"dark":"html[data-theme='dark']","el":"#waline","emoji":["//unpkg.com/@waline/emojis@1.1.0/weibo"],"highlighter":true,"imageUploader":true,"lang":"zh-cn","login":"enable","meta":["nick","mail","link"],"pageSize":10,"reaction":true,"search":false,"serverURL":"https://waline.roderickchan.cn/","texRenderer":false}},"cookieconsent":{"content":{"dismiss":"åŒæ„","link":"äº†è§£æ›´å¤š","message":"æœ¬ç½‘ç«™ä½¿ç”¨ Cookies æ¥æ”¹å–„æ‚¨çš„æµè§ˆä½“éªŒã€‚"},"enable":true,"palette":{"button":{"background":"#f0f0f0"},"popup":{"background":"#1aa3ff"}},"theme":"edgeless"},"enablePWA":true,"math":{"delimiters":[{"display":true,"left":"$$","right":"$$"},{"display":true,"left":"\\[","right":"\\]"},{"display":true,"left":"\\begin{equation}","right":"\\end{equation}"},{"display":true,"left":"\\begin{equation*}","right":"\\end{equation*}"},{"display":true,"left":"\\begin{align}","right":"\\end{align}"},{"display":true,"left":"\\begin{align*}","right":"\\end{align*}"},{"display":true,"left":"\\begin{alignat}","right":"\\end{alignat}"},{"display":true,"left":"\\begin{alignat*}","right":"\\end{alignat*}"},{"display":true,"left":"\\begin{gather}","right":"\\end{gather}"},{"display":true,"left":"\\begin{CD}","right":"\\end{CD}"},{"display":false,"left":"$","right":"$"},{"display":false,"left":"\\(","right":"\\)"}],"strict":false},"pangu":{"enable":true,"selector":"article"},"search":{"distance":100,"findAllMatches":false,"fuseIndexURL":"/zh-cn/search.json","highlightTag":"em","ignoreFieldNorm":false,"ignoreLocation":false,"isCaseSensitive":false,"location":0,"maxResultLength":10,"minMatchCharLength":2,"noResultsFound":"æ²¡æœ‰æ‰¾åˆ°ç»“æœ","snippetLength":30,"threshold":0.3,"type":"fuse","useExtendedSearch":false},"siteTime":"2022-10-01T09:00:00+08:00","twemoji":true,"typeit":{"cursorChar":"|","cursorSpeed":1000,"duration":-1,"loop":false,"speed":100},"version":"v0.3.21-87ca54d0","watermark":{"colspacing":30,"content":"roderick' blog","enable":true,"fontfamily":"inherit","fontsize":0.85,"height":21,"opacity":0.0125,"rotate":15,"rowspacing":60,"width":150}};</script><script src="/js/theme.min.js" defer></script><script src="/lib/translate.min.js" defer></script><script>window.ATConfig={"hugoLangCodes":["zh-CN"],"hugoLangMap":{"zh-CN":"/zh-cn/2023-02-27-house-of-all-about-glibc-heap-exploitation/"}};</script><script src="/js/translate.fixit.min.js" defer></script></body>
</html>
